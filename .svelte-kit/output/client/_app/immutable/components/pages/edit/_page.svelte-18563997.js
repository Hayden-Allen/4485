import{S as J,i as ee,s as te,l as C,m as k,p as N,h as I,q as f,b as F,J as B,n as D,K as Ee,L as ue,M as le,H as E,a as H,x as G,c as K,y as X,N as Ae,z as j,O as Bn,P as zn,Q as me,f as P,t as V,A as q,o as qe,R as Qn,u as pe,v as fe,T as en,w as We,U as po,g as ye,d as ve,V as Ue,W as dt,X as Oe,e as ct,Y as rr,Z as sr,_ as ur,C as fo,D as go,E as mo,F as yo,$ as lr,a0 as $,a1 as _t,a2 as It}from"../../../chunks/index-e0186b66.js";import{m as vo,V as Nn}from"../../../chunks/matter-26291323.js";function ar(i){let e,t,n,o;return{c(){e=C("div"),this.h()},l(r){e=k(r,"DIV",{class:!0}),N(e).forEach(I),this.h()},h(){f(e,"class",t=`grow-0 shrink-0 ${i[3]?"w-full h-1 cursor-ns-resize":"w-1 h-full cursor-ew-resize"}`)},m(r,s){F(r,e,s),n||(o=[B(e,"contextmenu",Yn),B(e,"pointerdown",i[6]),B(e,"pointerup",i[7]),B(e,"pointermove",i[8])],n=!0)},p(r,[s]){s&8&&t!==(t=`grow-0 shrink-0 ${r[3]?"w-full h-1 cursor-ns-resize":"w-1 h-full cursor-ew-resize"}`)&&f(e,"class",t)},i:D,o:D,d(r){r&&I(e),n=!1,Ee(o)}}}function Yn(i){i.preventDefault(),i.stopPropagation()}function dr(i){return i.button===0?(Yn(i),i.target.setPointerCapture(i.pointerId),!0):!1}function cr(i){return i.button===0&&(Yn(i),i.target.releasePointerCapture(i.pointerId)),!1}function hr(i,e,t){let{split:n=void 0,minSplit:o=0,maxSplit:r=1,isVertical:s=!1}=e,u=!1;function a(c){const p=c.target.parentNode.getBoundingClientRect();return s?(c.clientY-p.y)/p.height:(c.clientX-p.x)/p.width}const l=c=>t(4,u=dr(c)),d=c=>t(4,u=cr(c)),h=c=>{t(0,n=Math.max(o,Math.min(u?a(c):n,r)))};return i.$$set=c=>{"split"in c&&t(0,n=c.split),"minSplit"in c&&t(1,o=c.minSplit),"maxSplit"in c&&t(2,r=c.maxSplit),"isVertical"in c&&t(3,s=c.isVertical)},[n,o,r,s,u,a,l,d,h]}class yn extends J{constructor(e){super(),ee(this,e,hr,ar,te,{split:0,minSplit:1,maxSplit:2,isVertical:3})}}var Wt,pr=new Uint8Array(16);function fr(){if(!Wt&&(Wt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Wt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Wt(pr)}const gr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function mr(i){return typeof i=="string"&&gr.test(i)}var ke=[];for(var vn=0;vn<256;++vn)ke.push((vn+256).toString(16).substr(1));function yr(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(ke[i[e+0]]+ke[i[e+1]]+ke[i[e+2]]+ke[i[e+3]]+"-"+ke[i[e+4]]+ke[i[e+5]]+"-"+ke[i[e+6]]+ke[i[e+7]]+"-"+ke[i[e+8]]+ke[i[e+9]]+"-"+ke[i[e+10]]+ke[i[e+11]]+ke[i[e+12]]+ke[i[e+13]]+ke[i[e+14]]+ke[i[e+15]]).toLowerCase();if(!mr(t))throw TypeError("Stringified UUID is invalid");return t}function Mt(i,e,t){i=i||{};var n=i.random||(i.rng||fr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var o=0;o<16;++o)e[t+o]=n[o];return e}return yr(n)}const vr="finalize",xr="consider";function Nt(i,e,t){i.dispatchEvent(new CustomEvent(vr,{detail:{items:e,info:t}}))}function ht(i,e,t){i.dispatchEvent(new CustomEvent(xr,{detail:{items:e,info:t}}))}const dn="draggedEntered",Ft="draggedLeft",cn="draggedOverIndex",Wn="draggedLeftDocument",tn={LEFT_FOR_ANOTHER:"leftForAnother",OUTSIDE_OF_ANY:"outsideOfAny"};function wr(i,e,t){i.dispatchEvent(new CustomEvent(dn,{detail:{indexObj:e,draggedEl:t}}))}function _r(i,e,t){i.dispatchEvent(new CustomEvent(Ft,{detail:{draggedEl:e,type:tn.LEFT_FOR_ANOTHER,theOtherDz:t}}))}function Ir(i,e){i.dispatchEvent(new CustomEvent(Ft,{detail:{draggedEl:e,type:tn.OUTSIDE_OF_ANY}}))}function br(i,e,t){i.dispatchEvent(new CustomEvent(cn,{detail:{indexObj:e,draggedEl:t}}))}function Er(i){window.dispatchEvent(new CustomEvent(Wn,{detail:{draggedEl:i}}))}const Ve={DRAG_STARTED:"dragStarted",DRAGGED_ENTERED:dn,DRAGGED_ENTERED_ANOTHER:"dragEnteredAnother",DRAGGED_OVER_INDEX:cn,DRAGGED_LEFT:Ft,DRAGGED_LEFT_ALL:"draggedLeftAll",DROPPED_INTO_ZONE:"droppedIntoZone",DROPPED_INTO_ANOTHER:"droppedIntoAnother",DROPPED_OUTSIDE_OF_ANY:"droppedOutsideOfAny",DRAG_STOPPED:"dragStopped"},Re={POINTER:"pointer",KEYBOARD:"keyboard"},Bt="isDndShadowItem",Un="data-is-dnd-shadow-item",Gn="id:dnd-shadow-placeholder-0000",Nr="dnd-action-dragged-el";let Se="id",Sn=0;function xo(){Sn++}function wo(){if(Sn===0)throw new Error("Bug! trying to decrement when there are no dropzones");Sn--}const Xn=typeof window>"u";function _o(i){let e;const t=i.getBoundingClientRect(),n=getComputedStyle(i),o=n.transform;if(o){let r,s,u,a;if(o.startsWith("matrix3d("))e=o.slice(9,-1).split(/, /),r=+e[0],s=+e[5],u=+e[12],a=+e[13];else if(o.startsWith("matrix("))e=o.slice(7,-1).split(/, /),r=+e[0],s=+e[3],u=+e[4],a=+e[5];else return t;const l=n.transformOrigin,d=t.x-u-(1-r)*parseFloat(l),h=t.y-a-(1-s)*parseFloat(l.slice(l.indexOf(" ")+1)),c=r?t.width/r:i.offsetWidth,p=s?t.height/s:i.offsetHeight;return{x:d,y:h,width:c,height:p,top:h,right:d+c,bottom:h+p,left:d}}else return t}function Io(i){const e=_o(i);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function jn(i){const e=i.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function bo(i){return{x:(i.left+i.right)/2,y:(i.top+i.bottom)/2}}function Sr(i,e){return Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))}function qn(i,e){return i.y<=e.bottom&&i.y>=e.top&&i.x>=e.left&&i.x<=e.right}function Rt(i){return bo(jn(i))}function ai(i,e){const t=Rt(i),n=Io(e);return qn(t,n)}function Cr(i,e){const t=Rt(i),n=Rt(e);return Sr(t,n)}function kr(i){const e=jn(i);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}function Dr(i,e){const t=jn(e);return qn(i,t)?{top:i.y-t.top,bottom:t.bottom-i.y,left:i.x-t.left,right:Math.min(t.right,document.documentElement.clientWidth)-i.x}:null}let yt;function Hn(){yt=new Map}Hn();function Pr(i){yt.delete(i)}function Tr(i){const e=Array.from(i.children).findIndex(t=>t.getAttribute(Un));if(e>=0)return yt.has(i)||yt.set(i,new Map),yt.get(i).set(e,Io(i.children[e])),e}function Vr(i,e){if(!ai(i,e))return null;const t=e.children;if(t.length===0)return{index:0,isProximityBased:!0};const n=Tr(e);for(let s=0;s<t.length;s++)if(ai(i,t[s])){const u=yt.has(e)&&yt.get(e).get(s);return u&&!qn(Rt(i),u)?{index:n,isProximityBased:!1}:{index:s,isProximityBased:!1}}let o=Number.MAX_VALUE,r;for(let s=0;s<t.length;s++){const u=Cr(i,t[s]);u<o&&(o=u,r=s)}return{index:r,isProximityBased:!0}}const Ot=25;function Eo(){let i;function e(){i={directionObj:void 0,stepPx:0}}e();function t(r){const{directionObj:s,stepPx:u}=i;s&&(r.scrollBy(s.x*u,s.y*u),window.requestAnimationFrame(()=>t(r)))}function n(r){return Ot-r}function o(r,s){if(!s)return!1;const u=Dr(r,s);if(u===null)return e(),!1;const a=!!i.directionObj;let[l,d]=[!1,!1];return s.scrollHeight>s.clientHeight&&(u.bottom<Ot?(l=!0,i.directionObj={x:0,y:1},i.stepPx=n(u.bottom)):u.top<Ot&&(l=!0,i.directionObj={x:0,y:-1},i.stepPx=n(u.top)),!a&&l)||s.scrollWidth>s.clientWidth&&(u.right<Ot?(d=!0,i.directionObj={x:1,y:0},i.stepPx=n(u.right)):u.left<Ot&&(d=!0,i.directionObj={x:-1,y:0},i.stepPx=n(u.left)),!a&&d)?(t(s),!0):(e(),!1)}return{scrollIfNeeded:o,resetScrolling:e}}function xn(i){return JSON.stringify(i,null,2)}function di(i){if(!i)throw new Error("cannot get depth of a falsy node");return No(i,0)}function No(i,e=0){return i.parentElement?No(i.parentElement,e+1):e-1}function Ar(i,e){if(Object.keys(i).length!==Object.keys(e).length)return!1;for(const t in i)if(!{}.hasOwnProperty.call(e,t)||e[t]!==i[t])return!1;return!0}function Or(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}const Rr=200,ci=10,{scrollIfNeeded:Lr,resetScrolling:Mr}=Eo();let Cn;function Fr(i,e,t=Rr){let n,o,r=!1,s;const u=Array.from(e).sort((l,d)=>di(d)-di(l));function a(){const l=Rt(i),d=Lr(l,n);if(!d&&s&&Math.abs(s.x-l.x)<ci&&Math.abs(s.y-l.y)<ci){Cn=window.setTimeout(a,t);return}if(kr(i)){Er(i);return}s=l;let h=!1;for(const c of u){d&&Pr(n);const p=Vr(i,c);if(p===null)continue;const{index:g}=p;h=!0,c!==n?(n&&_r(n,i,c),wr(c,p,i),n=c):g!==o&&(br(c,p,i),o=g);break}!h&&r&&n?(Ir(n,i),n=void 0,o=void 0,r=!1):r=!0,Cn=window.setTimeout(a,t)}a()}function Br(){clearTimeout(Cn),Mr(),Hn()}const zr=300;let nn;function on(i){const e=i.touches?i.touches[0]:i;nn={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:Qr,resetScrolling:Yr}=Eo();let So;function Co(){nn&&Qr(nn,document.documentElement)&&Hn(),So=window.setTimeout(Co,zr)}function Wr(){window.addEventListener("mousemove",on),window.addEventListener("touchmove",on),Co()}function Ur(){window.removeEventListener("mousemove",on),window.removeEventListener("touchmove",on),nn=void 0,window.clearTimeout(So),Yr()}function Gr(i){const e=i.cloneNode(!0),t=[],n=i.tagName==="SELECT",o=n?[i]:[...i.querySelectorAll("select")];for(const s of o)t.push(s.value);if(o.length<=0)return e;const r=n?[e]:[...e.querySelectorAll("select")];for(let s=0;s<r.length;s++){const u=r[s],a=t[s],l=u.querySelector(`option[value="${a}"`);l&&l.setAttribute("selected",!0)}return e}const Xr=.2;function ft(i){return`${i} ${Xr}s ease`}function jr(i,e){const t=i.getBoundingClientRect(),n=Gr(i);ko(i,n),n.id=Nr,n.style.position="fixed";let o=t.top,r=t.left;if(n.style.top=`${o}px`,n.style.left=`${r}px`,e){const s=bo(t);o-=s.y-e.y,r-=s.x-e.x,window.setTimeout(()=>{n.style.top=`${o}px`,n.style.left=`${r}px`},0)}return n.style.margin="0",n.style.boxSizing="border-box",n.style.height=`${t.height}px`,n.style.width=`${t.width}px`,n.style.transition=`${ft("top")}, ${ft("left")}, ${ft("background-color")}, ${ft("opacity")}, ${ft("color")} `,window.setTimeout(()=>n.style.transition+=`, ${ft("width")}, ${ft("height")}`,0),n.style.zIndex="9999",n.style.cursor="grabbing",n}function qr(i){i.style.cursor="grab"}function Hr(i,e,t,n,o){const r=e.getBoundingClientRect(),s=i.getBoundingClientRect(),u=r.width-s.width,a=r.height-s.height;if(u||a){const l={left:(t-s.left)/s.width,top:(n-s.top)/s.height};i.style.height=`${r.height}px`,i.style.width=`${r.width}px`,i.style.left=`${parseFloat(i.style.left)-l.left*u}px`,i.style.top=`${parseFloat(i.style.top)-l.top*a}px`}ko(e,i),o()}function ko(i,e){const t=window.getComputedStyle(i);Array.from(t).filter(n=>n.startsWith("background")||n.startsWith("padding")||n.startsWith("font")||n.startsWith("text")||n.startsWith("align")||n.startsWith("justify")||n.startsWith("display")||n.startsWith("flex")||n.startsWith("border")||n==="opacity"||n==="color"||n==="list-style-type").forEach(n=>e.style.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n)))}function Kr(i,e){i.draggable=!1,i.ondragstart=()=>!1,e?(i.style.userSelect="",i.style.WebkitUserSelect="",i.style.cursor=""):(i.style.userSelect="none",i.style.WebkitUserSelect="none",i.style.cursor="grab")}function Do(i){i.style.display="none",i.style.position="fixed",i.style.zIndex="-5"}function Zr(i){i.style.visibility="hidden",i.setAttribute(Un,"true")}function $r(i){i.style.visibility="",i.removeAttribute(Un)}function Ht(i,e=()=>{},t=()=>[]){i.forEach(n=>{const o=e(n);Object.keys(o).forEach(r=>{n.style[r]=o[r]}),t(n).forEach(r=>n.classList.add(r))})}function rn(i,e=()=>{},t=()=>[]){i.forEach(n=>{const o=e(n);Object.keys(o).forEach(r=>{n.style[r]=""}),t(n).forEach(r=>n.classList.contains(r)&&n.classList.remove(r))})}function Jr(i){const e=i.style.minHeight;i.style.minHeight=window.getComputedStyle(i).getPropertyValue("height");const t=i.style.minWidth;return i.style.minWidth=window.getComputedStyle(i).getPropertyValue("width"),function(){i.style.minHeight=e,i.style.minWidth=t}}const es="--any--",ts=100,hi=3,pi={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let it,Pe,Be,hn,be,pn,St,Fe,lt,Qe,mt=!1,Kn=!1,Zn,zt=!1,Kt=[];const je=new Map,Ie=new Map,wn=new WeakMap;function ns(i,e){je.has(e)||je.set(e,new Set),je.get(e).has(i)||(je.get(e).add(i),xo())}function fi(i,e){je.get(e).delete(i),wo(),je.get(e).size===0&&je.delete(e)}function is(){Wr();const i=je.get(hn);for(const t of i)t.addEventListener(dn,Po),t.addEventListener(Ft,To),t.addEventListener(cn,Vo);window.addEventListener(Wn,Ct);const e=Math.max(ts,...Array.from(i.keys()).map(t=>Ie.get(t).dropAnimationDurationMs));Fr(Pe,i,e*1.07)}function os(){Ur();const i=je.get(hn);for(const e of i)e.removeEventListener(dn,Po),e.removeEventListener(Ft,To),e.removeEventListener(cn,Vo);window.removeEventListener(Wn,Ct),Br()}function rs(i){return i.findIndex(e=>e[Se]===Gn)}function fn(i){return i.findIndex(e=>!!e[Bt]&&e[Se]!==Gn)}function Po(i){let{items:e,dropFromOthersDisabled:t}=Ie.get(i.currentTarget);if(t&&i.currentTarget!==be)return;if(zt=!1,e=e.filter(s=>s[Se]!==St[Se]),be!==i.currentTarget){const u=Ie.get(be).items.filter(a=>!a[Bt]);ht(be,u,{trigger:Ve.DRAGGED_ENTERED_ANOTHER,id:Be[Se],source:Re.POINTER})}else{const s=rs(e);s!==-1&&e.splice(s,1)}const{index:n,isProximityBased:o}=i.detail.indexObj,r=o&&n===i.currentTarget.children.length-1?n+1:n;Fe=i.currentTarget,e.splice(r,0,St),ht(i.currentTarget,e,{trigger:Ve.DRAGGED_ENTERED,id:Be[Se],source:Re.POINTER})}function To(i){if(!mt)return;const{items:e,dropFromOthersDisabled:t}=Ie.get(i.currentTarget);if(t&&i.currentTarget!==be&&i.currentTarget!==Fe)return;const n=fn(e),o=e.splice(n,1)[0];Fe=void 0;const{type:r,theOtherDz:s}=i.detail;if(r===tn.OUTSIDE_OF_ANY||r===tn.LEFT_FOR_ANOTHER&&s!==be&&Ie.get(s).dropFromOthersDisabled){zt=!0,Fe=be;const u=Ie.get(be).items;u.splice(pn,0,o),ht(be,u,{trigger:Ve.DRAGGED_LEFT_ALL,id:Be[Se],source:Re.POINTER})}ht(i.currentTarget,e,{trigger:Ve.DRAGGED_LEFT,id:Be[Se],source:Re.POINTER})}function Vo(i){const{items:e,dropFromOthersDisabled:t}=Ie.get(i.currentTarget);if(t&&i.currentTarget!==be)return;zt=!1;const{index:n}=i.detail.indexObj,o=fn(e);e.splice(o,1),e.splice(n,0,St),ht(i.currentTarget,e,{trigger:Ve.DRAGGED_OVER_INDEX,id:Be[Se],source:Re.POINTER})}function sn(i){i.preventDefault();const e=i.touches?i.touches[0]:i;Qe={x:e.clientX,y:e.clientY},Pe.style.transform=`translate3d(${Qe.x-lt.x}px, ${Qe.y-lt.y}px, 0)`}function Ct(){Kn=!0,window.removeEventListener("mousemove",sn),window.removeEventListener("touchmove",sn),window.removeEventListener("mouseup",Ct),window.removeEventListener("touchend",Ct),os(),qr(Pe),Fe||(Fe=be);let{items:i,type:e}=Ie.get(Fe);rn(je.get(e),o=>Ie.get(o).dropTargetStyle,o=>Ie.get(o).dropTargetClasses);let t=fn(i);t===-1&&(t=pn),i=i.map(o=>o[Bt]?Be:o);function n(){Zn(),Nt(Fe,i,{trigger:zt?Ve.DROPPED_OUTSIDE_OF_ANY:Ve.DROPPED_INTO_ZONE,id:Be[Se],source:Re.POINTER}),Fe!==be&&Nt(be,Ie.get(be).items,{trigger:Ve.DROPPED_INTO_ANOTHER,id:Be[Se],source:Re.POINTER}),$r(Fe.children[t]),ls()}ss(t,n)}function ss(i,e){const t=_o(Fe.children[i]),n={x:t.left-parseFloat(Pe.style.left),y:t.top-parseFloat(Pe.style.top)},{dropAnimationDurationMs:o}=Ie.get(Fe),r=`transform ${o}ms ease`;Pe.style.transition=Pe.style.transition?Pe.style.transition+","+r:r,Pe.style.transform=`translate3d(${n.x}px, ${n.y}px, 0)`,window.setTimeout(e,o)}function us(i,e){Kt.push({dz:i,destroy:e}),window.requestAnimationFrame(()=>{Do(i),document.body.appendChild(i)})}function ls(){Pe.remove(),it.remove(),Kt.length&&(Kt.forEach(({dz:i,destroy:e})=>{e(),i.remove()}),Kt=[]),Pe=void 0,it=void 0,Be=void 0,hn=void 0,be=void 0,pn=void 0,St=void 0,Fe=void 0,lt=void 0,Qe=void 0,mt=!1,Kn=!1,Zn=void 0,zt=!1}function as(i,e){let t=!1;const n={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:pi,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let o=new Map;function r(){window.addEventListener("mousemove",a,{passive:!1}),window.addEventListener("touchmove",a,{passive:!1,capture:!1}),window.addEventListener("mouseup",u,{passive:!1}),window.addEventListener("touchend",u,{passive:!1})}function s(){window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",a),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u)}function u(){s(),it=void 0,lt=void 0,Qe=void 0}function a(c){c.preventDefault();const p=c.touches?c.touches[0]:c;Qe={x:p.clientX,y:p.clientY},(Math.abs(Qe.x-lt.x)>=hi||Math.abs(Qe.y-lt.y)>=hi)&&(s(),d())}function l(c){if(c.target!==c.currentTarget&&(c.target.value!==void 0||c.target.isContentEditable)||c.button||mt)return;c.stopPropagation();const p=c.touches?c.touches[0]:c;lt={x:p.clientX,y:p.clientY},Qe={...lt},it=c.currentTarget,r()}function d(){mt=!0;const c=o.get(it);pn=c,be=it.parentElement;const p=be.getRootNode(),g=p.body||p,{items:y,type:w,centreDraggedOnCursor:v}=n;Be={...y[c]},hn=w,St={...Be,[Bt]:!0};const x={...St,[Se]:Gn};Pe=jr(it,v&&Qe);function m(){Pe.parentElement?window.requestAnimationFrame(m):(g.appendChild(Pe),Pe.focus(),is(),Do(it),g.appendChild(it))}window.requestAnimationFrame(m),Ht(Array.from(je.get(n.type)).filter(_=>_===be||!Ie.get(_).dropFromOthersDisabled),_=>Ie.get(_).dropTargetStyle,_=>Ie.get(_).dropTargetClasses),y.splice(c,1,x),Zn=Jr(be),ht(be,y,{trigger:Ve.DRAG_STARTED,id:Be[Se],source:Re.POINTER}),window.addEventListener("mousemove",sn,{passive:!1}),window.addEventListener("touchmove",sn,{passive:!1,capture:!1}),window.addEventListener("mouseup",Ct,{passive:!1}),window.addEventListener("touchend",Ct,{passive:!1})}function h({items:c=void 0,flipDurationMs:p=0,type:g=es,dragDisabled:y=!1,morphDisabled:w=!1,dropFromOthersDisabled:v=!1,dropTargetStyle:x=pi,dropTargetClasses:m=[],transformDraggedElement:_=()=>{},centreDraggedOnCursor:b=!1}){n.dropAnimationDurationMs=p,n.type&&g!==n.type&&fi(i,n.type),n.type=g,ns(i,g),n.items=[...c],n.dragDisabled=y,n.morphDisabled=w,n.transformDraggedElement=_,n.centreDraggedOnCursor=b,t&&mt&&!Kn&&(!Ar(x,n.dropTargetStyle)||!Or(m,n.dropTargetClasses))&&(rn([i],()=>n.dropTargetStyle,()=>m),Ht([i],()=>x,()=>m)),n.dropTargetStyle=x,n.dropTargetClasses=[...m];function S(T,L){return Ie.get(T)?Ie.get(T)[L]:n[L]}t&&mt&&n.dropFromOthersDisabled!==v&&(v?rn([i],T=>S(T,"dropTargetStyle"),T=>S(T,"dropTargetClasses")):Ht([i],T=>S(T,"dropTargetStyle"),T=>S(T,"dropTargetClasses"))),n.dropFromOthersDisabled=v,Ie.set(i,n);const A=fn(n.items);for(let T=0;T<i.children.length;T++){const L=i.children[T];if(Kr(L,y),T===A){w||Hr(Pe,L,Qe.x,Qe.y,()=>n.transformDraggedElement(Pe,Be,T)),Zr(L);continue}L.removeEventListener("mousedown",wn.get(L)),L.removeEventListener("touchstart",wn.get(L)),y||(L.addEventListener("mousedown",l),L.addEventListener("touchstart",l),wn.set(L,l)),o.set(L,T),t||(t=!0)}}return h(e),{update:c=>{h(c)},destroy:()=>{function c(){fi(i,Ie.get(i).type),Ie.delete(i)}mt?us(i,c):c()}}}const kn={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},Ao={[kn.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[kn.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"},ds="dnd-action-aria-alert";let _e;function Dn(){_e||(_e=document.createElement("div"),function(){_e.id=ds,_e.style.position="fixed",_e.style.bottom="0",_e.style.left="0",_e.style.zIndex="-5",_e.style.opacity="0",_e.style.height="0",_e.style.width="0",_e.setAttribute("role","alert")}(),document.body.prepend(_e),Object.entries(Ao).forEach(([i,e])=>document.body.prepend(ps(i,e))))}function cs(){return Xn?null:(document.readyState==="complete"?Dn():window.addEventListener("DOMContentLoaded",Dn),{...kn})}function hs(){Xn||!_e||(Object.keys(Ao).forEach(i=>{var e;return(e=document.getElementById(i))==null?void 0:e.remove()}),_e.remove(),_e=void 0)}function ps(i,e){const t=document.createElement("div");return t.id=i,t.innerHTML=`<p>${e}</p>`,t.style.display="none",t.style.position="fixed",t.style.zIndex="-5",t}function Et(i){if(Xn)return;_e||Dn(),_e.innerHTML="";const e=document.createTextNode(i);_e.appendChild(e),_e.style.display="none",_e.style.display="inline"}const fs="--any--",gi={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let Ye=!1,Pn,Te,vt="",gt,et,at="";const un=new WeakSet,mi=new WeakMap,yi=new WeakMap,Tn=new Map,De=new Map,Xe=new Map;let ln;function gs(i,e){Xe.size===0&&(ln=cs(),window.addEventListener("keydown",Oo),window.addEventListener("click",Ro)),Xe.has(e)||Xe.set(e,new Set),Xe.get(e).has(i)||(Xe.get(e).add(i),xo())}function vi(i,e){Te===i&&Lt(),Xe.get(e).delete(i),wo(),Xe.get(e).size===0&&Xe.delete(e),Xe.size===0&&(window.removeEventListener("keydown",Oo),window.removeEventListener("click",Ro),ln=void 0,hs())}function Oo(i){if(!!Ye)switch(i.key){case"Escape":{Lt();break}}}function Ro(){!Ye||un.has(document.activeElement)||Lt()}function ms(i){if(!Ye)return;const e=i.currentTarget;if(e===Te)return;vt=e.getAttribute("aria-label")||"";const{items:t}=De.get(Te),n=t.find(l=>l[Se]===et),o=t.indexOf(n),r=t.splice(o,1)[0],{items:s,autoAriaDisabled:u}=De.get(e);e.getBoundingClientRect().top<Te.getBoundingClientRect().top||e.getBoundingClientRect().left<Te.getBoundingClientRect().left?(s.push(r),u||Et(`Moved item ${at} to the end of the list ${vt}`)):(s.unshift(r),u||Et(`Moved item ${at} to the beginning of the list ${vt}`)),Nt(Te,t,{trigger:Ve.DROPPED_INTO_ANOTHER,id:et,source:Re.KEYBOARD}),Nt(e,s,{trigger:Ve.DROPPED_INTO_ZONE,id:et,source:Re.KEYBOARD}),Te=e}function Lo(){Tn.forEach(({update:i},e)=>i(De.get(e)))}function Lt(i=!0){De.get(Te).autoAriaDisabled||Et(`Stopped dragging item ${at}`),un.has(document.activeElement)&&document.activeElement.blur(),i&&ht(Te,De.get(Te).items,{trigger:Ve.DRAG_STOPPED,id:et,source:Re.KEYBOARD}),rn(Xe.get(Pn),e=>De.get(e).dropTargetStyle,e=>De.get(e).dropTargetClasses),gt=null,et=null,at="",Pn=null,Te=null,vt="",Ye=!1,Lo()}function ys(i,e){const t={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:gi,dropTargetClasses:[],autoAriaDisabled:!1};function n(d,h,c){d.length<=1||d.splice(c,1,d.splice(h,1,d[c])[0])}function o(d){switch(d.key){case"Enter":case" ":{if((d.target.disabled!==void 0||d.target.href||d.target.isContentEditable)&&!un.has(d.target))return;d.preventDefault(),d.stopPropagation(),Ye?Lt():r(d);break}case"ArrowDown":case"ArrowRight":{if(!Ye)return;d.preventDefault(),d.stopPropagation();const{items:h}=De.get(i),c=Array.from(i.children),p=c.indexOf(d.currentTarget);p<c.length-1&&(t.autoAriaDisabled||Et(`Moved item ${at} to position ${p+2} in the list ${vt}`),n(h,p,p+1),Nt(i,h,{trigger:Ve.DROPPED_INTO_ZONE,id:et,source:Re.KEYBOARD}));break}case"ArrowUp":case"ArrowLeft":{if(!Ye)return;d.preventDefault(),d.stopPropagation();const{items:h}=De.get(i),p=Array.from(i.children).indexOf(d.currentTarget);p>0&&(t.autoAriaDisabled||Et(`Moved item ${at} to position ${p} in the list ${vt}`),n(h,p,p-1),Nt(i,h,{trigger:Ve.DROPPED_INTO_ZONE,id:et,source:Re.KEYBOARD}));break}}}function r(d){u(d.currentTarget),Te=i,Pn=t.type,Ye=!0;const h=Array.from(Xe.get(t.type)).filter(c=>c===Te||!De.get(c).dropFromOthersDisabled);if(Ht(h,c=>De.get(c).dropTargetStyle,c=>De.get(c).dropTargetClasses),!t.autoAriaDisabled){let c=`Started dragging item ${at}. Use the arrow keys to move it within its list ${vt}`;h.length>1&&(c+=", or tab to another list in order to move the item into it"),Et(c)}ht(i,De.get(i).items,{trigger:Ve.DRAG_STARTED,id:et,source:Re.KEYBOARD}),Lo()}function s(d){!Ye||d.currentTarget!==gt&&(d.stopPropagation(),Lt(!1),r(d))}function u(d){const{items:h}=De.get(i),c=Array.from(i.children),p=c.indexOf(d);gt=d,gt.tabIndex=0,et=h[p][Se],at=c[p].getAttribute("aria-label")||""}function a({items:d=[],type:h=fs,dragDisabled:c=!1,zoneTabIndex:p=0,dropFromOthersDisabled:g=!1,dropTargetStyle:y=gi,dropTargetClasses:w=[],autoAriaDisabled:v=!1}){t.items=[...d],t.dragDisabled=c,t.dropFromOthersDisabled=g,t.zoneTabIndex=p,t.dropTargetStyle=y,t.dropTargetClasses=w,t.autoAriaDisabled=v,t.type&&h!==t.type&&vi(i,t.type),t.type=h,gs(i,h),v||(i.setAttribute("aria-disabled",c),i.setAttribute("role","list"),i.setAttribute("aria-describedby",c?ln.DND_ZONE_DRAG_DISABLED:ln.DND_ZONE_ACTIVE)),De.set(i,t),Ye?i.tabIndex=i===Te||gt.contains(i)||t.dropFromOthersDisabled||Te&&t.type!==De.get(Te).type?-1:0:i.tabIndex=t.zoneTabIndex,i.addEventListener("focus",ms);for(let x=0;x<i.children.length;x++){const m=i.children[x];un.add(m),m.tabIndex=Ye?-1:0,v||m.setAttribute("role","listitem"),m.removeEventListener("keydown",mi.get(m)),m.removeEventListener("click",yi.get(m)),c||(m.addEventListener("keydown",o),mi.set(m,o),m.addEventListener("click",s),yi.set(m,s)),Ye&&t.items[x][Se]===et&&(gt=m,gt.tabIndex=0,m.focus())}}a(e);const l={update:d=>{a(d)},destroy:()=>{vi(i,t.type),De.delete(i),Tn.delete(i)}};return Tn.set(i,l),l}function $n(i,e){xi(e);const t=as(i,e),n=ys(i,e);return{update:o=>{xi(o),t.update(o),n.update(o)},destroy:()=>{t.destroy(),n.destroy()}}}function xi(i){const{items:e,flipDurationMs:t,type:n,dragDisabled:o,morphDisabled:r,dropFromOthersDisabled:s,zoneTabIndex:u,dropTargetStyle:a,dropTargetClasses:l,transformDraggedElement:d,autoAriaDisabled:h,centreDraggedOnCursor:c,...p}=i;if(Object.keys(p).length>0&&console.warn("dndzone will ignore unknown options",p),!e)throw new Error("no 'items' key provided to dndzone");const g=e.find(y=>!{}.hasOwnProperty.call(y,Se));if(g)throw new Error(`missing '${Se}' property for item ${xn(g)}`);if(l&&!Array.isArray(l))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof l}, ${xn(l)}`);if(u&&!vs(u))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof u}, ${xn(u)}`)}function vs(i){return!isNaN(i)&&function(e){return(e|0)===e}(parseFloat(i))}var Mo={exports:{}};/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */(function(i,e){(function(){var t=function(n){var o=new t.Builder;return o.pipeline.add(t.trimmer,t.stopWordFilter,t.stemmer),o.searchPipeline.add(t.stemmer),n.call(o,o),o.build()};t.version="2.3.9";/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */t.utils={},t.utils.warn=function(n){return function(o){n.console&&console.warn&&console.warn(o)}}(this),t.utils.asString=function(n){return n==null?"":n.toString()},t.utils.clone=function(n){if(n==null)return n;for(var o=Object.create(null),r=Object.keys(n),s=0;s<r.length;s++){var u=r[s],a=n[u];if(Array.isArray(a)){o[u]=a.slice();continue}if(typeof a=="string"||typeof a=="number"||typeof a=="boolean"){o[u]=a;continue}throw new TypeError("clone is not deep and does not support nested objects")}return o},t.FieldRef=function(n,o,r){this.docRef=n,this.fieldName=o,this._stringValue=r},t.FieldRef.joiner="/",t.FieldRef.fromString=function(n){var o=n.indexOf(t.FieldRef.joiner);if(o===-1)throw"malformed field ref string";var r=n.slice(0,o),s=n.slice(o+1);return new t.FieldRef(s,r,n)},t.FieldRef.prototype.toString=function(){return this._stringValue==null&&(this._stringValue=this.fieldName+t.FieldRef.joiner+this.docRef),this._stringValue};/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */t.Set=function(n){if(this.elements=Object.create(null),n){this.length=n.length;for(var o=0;o<this.length;o++)this.elements[n[o]]=!0}else this.length=0},t.Set.complete={intersect:function(n){return n},union:function(){return this},contains:function(){return!0}},t.Set.empty={intersect:function(){return this},union:function(n){return n},contains:function(){return!1}},t.Set.prototype.contains=function(n){return!!this.elements[n]},t.Set.prototype.intersect=function(n){var o,r,s,u=[];if(n===t.Set.complete)return this;if(n===t.Set.empty)return n;this.length<n.length?(o=this,r=n):(o=n,r=this),s=Object.keys(o.elements);for(var a=0;a<s.length;a++){var l=s[a];l in r.elements&&u.push(l)}return new t.Set(u)},t.Set.prototype.union=function(n){return n===t.Set.complete?t.Set.complete:n===t.Set.empty?this:new t.Set(Object.keys(this.elements).concat(Object.keys(n.elements)))},t.idf=function(n,o){var r=0;for(var s in n)s!="_index"&&(r+=Object.keys(n[s]).length);var u=(o-r+.5)/(r+.5);return Math.log(1+Math.abs(u))},t.Token=function(n,o){this.str=n||"",this.metadata=o||{}},t.Token.prototype.toString=function(){return this.str},t.Token.prototype.update=function(n){return this.str=n(this.str,this.metadata),this},t.Token.prototype.clone=function(n){return n=n||function(o){return o},new t.Token(n(this.str,this.metadata),this.metadata)};/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */t.tokenizer=function(n,o){if(n==null||n==null)return[];if(Array.isArray(n))return n.map(function(p){return new t.Token(t.utils.asString(p).toLowerCase(),t.utils.clone(o))});for(var r=n.toString().toLowerCase(),s=r.length,u=[],a=0,l=0;a<=s;a++){var d=r.charAt(a),h=a-l;if(d.match(t.tokenizer.separator)||a==s){if(h>0){var c=t.utils.clone(o)||{};c.position=[l,h],c.index=u.length,u.push(new t.Token(r.slice(l,a),c))}l=a+1}}return u},t.tokenizer.separator=/[\s\-]+/;/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */t.Pipeline=function(){this._stack=[]},t.Pipeline.registeredFunctions=Object.create(null),t.Pipeline.registerFunction=function(n,o){o in this.registeredFunctions&&t.utils.warn("Overwriting existing registered function: "+o),n.label=o,t.Pipeline.registeredFunctions[n.label]=n},t.Pipeline.warnIfFunctionNotRegistered=function(n){var o=n.label&&n.label in this.registeredFunctions;o||t.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,n)},t.Pipeline.load=function(n){var o=new t.Pipeline;return n.forEach(function(r){var s=t.Pipeline.registeredFunctions[r];if(s)o.add(s);else throw new Error("Cannot load unregistered function: "+r)}),o},t.Pipeline.prototype.add=function(){var n=Array.prototype.slice.call(arguments);n.forEach(function(o){t.Pipeline.warnIfFunctionNotRegistered(o),this._stack.push(o)},this)},t.Pipeline.prototype.after=function(n,o){t.Pipeline.warnIfFunctionNotRegistered(o);var r=this._stack.indexOf(n);if(r==-1)throw new Error("Cannot find existingFn");r=r+1,this._stack.splice(r,0,o)},t.Pipeline.prototype.before=function(n,o){t.Pipeline.warnIfFunctionNotRegistered(o);var r=this._stack.indexOf(n);if(r==-1)throw new Error("Cannot find existingFn");this._stack.splice(r,0,o)},t.Pipeline.prototype.remove=function(n){var o=this._stack.indexOf(n);o!=-1&&this._stack.splice(o,1)},t.Pipeline.prototype.run=function(n){for(var o=this._stack.length,r=0;r<o;r++){for(var s=this._stack[r],u=[],a=0;a<n.length;a++){var l=s(n[a],a,n);if(!(l==null||l===""))if(Array.isArray(l))for(var d=0;d<l.length;d++)u.push(l[d]);else u.push(l)}n=u}return n},t.Pipeline.prototype.runString=function(n,o){var r=new t.Token(n,o);return this.run([r]).map(function(s){return s.toString()})},t.Pipeline.prototype.reset=function(){this._stack=[]},t.Pipeline.prototype.toJSON=function(){return this._stack.map(function(n){return t.Pipeline.warnIfFunctionNotRegistered(n),n.label})};/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */t.Vector=function(n){this._magnitude=0,this.elements=n||[]},t.Vector.prototype.positionForIndex=function(n){if(this.elements.length==0)return 0;for(var o=0,r=this.elements.length/2,s=r-o,u=Math.floor(s/2),a=this.elements[u*2];s>1&&(a<n&&(o=u),a>n&&(r=u),a!=n);)s=r-o,u=o+Math.floor(s/2),a=this.elements[u*2];if(a==n||a>n)return u*2;if(a<n)return(u+1)*2},t.Vector.prototype.insert=function(n,o){this.upsert(n,o,function(){throw"duplicate index"})},t.Vector.prototype.upsert=function(n,o,r){this._magnitude=0;var s=this.positionForIndex(n);this.elements[s]==n?this.elements[s+1]=r(this.elements[s+1],o):this.elements.splice(s,0,n,o)},t.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var n=0,o=this.elements.length,r=1;r<o;r+=2){var s=this.elements[r];n+=s*s}return this._magnitude=Math.sqrt(n)},t.Vector.prototype.dot=function(n){for(var o=0,r=this.elements,s=n.elements,u=r.length,a=s.length,l=0,d=0,h=0,c=0;h<u&&c<a;)l=r[h],d=s[c],l<d?h+=2:l>d?c+=2:l==d&&(o+=r[h+1]*s[c+1],h+=2,c+=2);return o},t.Vector.prototype.similarity=function(n){return this.dot(n)/this.magnitude()||0},t.Vector.prototype.toArray=function(){for(var n=new Array(this.elements.length/2),o=1,r=0;o<this.elements.length;o+=2,r++)n[r]=this.elements[o];return n},t.Vector.prototype.toJSON=function(){return this.elements};/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */t.stemmer=function(){var n={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},o={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},r="[^aeiou]",s="[aeiouy]",u=r+"[^aeiouy]*",a=s+"[aeiou]*",l="^("+u+")?"+a+u,d="^("+u+")?"+a+u+"("+a+")?$",h="^("+u+")?"+a+u+a+u,c="^("+u+")?"+s,p=new RegExp(l),g=new RegExp(h),y=new RegExp(d),w=new RegExp(c),v=/^(.+?)(ss|i)es$/,x=/^(.+?)([^s])s$/,m=/^(.+?)eed$/,_=/^(.+?)(ed|ing)$/,b=/.$/,S=/(at|bl|iz)$/,A=new RegExp("([^aeiouylsz])\\1$"),T=new RegExp("^"+u+s+"[^aeiouwxy]$"),L=/^(.+?[^aeiou])y$/,oe=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,ie=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,M=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,W=/^(.+?)(s|t)(ion)$/,Q=/^(.+?)e$/,re=/ll$/,Y=new RegExp("^"+u+s+"[^aeiouwxy]$"),ae=function(z){var R,ne,de,U,se,ze,Le;if(z.length<3)return z;if(de=z.substr(0,1),de=="y"&&(z=de.toUpperCase()+z.substr(1)),U=v,se=x,U.test(z)?z=z.replace(U,"$1$2"):se.test(z)&&(z=z.replace(se,"$1$2")),U=m,se=_,U.test(z)){var ce=U.exec(z);U=p,U.test(ce[1])&&(U=b,z=z.replace(U,""))}else if(se.test(z)){var ce=se.exec(z);R=ce[1],se=w,se.test(R)&&(z=R,se=S,ze=A,Le=T,se.test(z)?z=z+"e":ze.test(z)?(U=b,z=z.replace(U,"")):Le.test(z)&&(z=z+"e"))}if(U=L,U.test(z)){var ce=U.exec(z);R=ce[1],z=R+"i"}if(U=oe,U.test(z)){var ce=U.exec(z);R=ce[1],ne=ce[2],U=p,U.test(R)&&(z=R+n[ne])}if(U=ie,U.test(z)){var ce=U.exec(z);R=ce[1],ne=ce[2],U=p,U.test(R)&&(z=R+o[ne])}if(U=M,se=W,U.test(z)){var ce=U.exec(z);R=ce[1],U=g,U.test(R)&&(z=R)}else if(se.test(z)){var ce=se.exec(z);R=ce[1]+ce[2],se=g,se.test(R)&&(z=R)}if(U=Q,U.test(z)){var ce=U.exec(z);R=ce[1],U=g,se=y,ze=Y,(U.test(R)||se.test(R)&&!ze.test(R))&&(z=R)}return U=re,se=g,U.test(z)&&se.test(z)&&(U=b,z=z.replace(U,"")),de=="y"&&(z=de.toLowerCase()+z.substr(1)),z};return function(Ne){return Ne.update(ae)}}(),t.Pipeline.registerFunction(t.stemmer,"stemmer");/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */t.generateStopWordFilter=function(n){var o=n.reduce(function(r,s){return r[s]=s,r},{});return function(r){if(r&&o[r.toString()]!==r.toString())return r}},t.stopWordFilter=t.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),t.Pipeline.registerFunction(t.stopWordFilter,"stopWordFilter");/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */t.trimmer=function(n){return n.update(function(o){return o.replace(/^\W+/,"").replace(/\W+$/,"")})},t.Pipeline.registerFunction(t.trimmer,"trimmer");/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */t.TokenSet=function(){this.final=!1,this.edges={},this.id=t.TokenSet._nextId,t.TokenSet._nextId+=1},t.TokenSet._nextId=1,t.TokenSet.fromArray=function(n){for(var o=new t.TokenSet.Builder,r=0,s=n.length;r<s;r++)o.insert(n[r]);return o.finish(),o.root},t.TokenSet.fromClause=function(n){return"editDistance"in n?t.TokenSet.fromFuzzyString(n.term,n.editDistance):t.TokenSet.fromString(n.term)},t.TokenSet.fromFuzzyString=function(n,o){for(var r=new t.TokenSet,s=[{node:r,editsRemaining:o,str:n}];s.length;){var u=s.pop();if(u.str.length>0){var a=u.str.charAt(0),l;a in u.node.edges?l=u.node.edges[a]:(l=new t.TokenSet,u.node.edges[a]=l),u.str.length==1&&(l.final=!0),s.push({node:l,editsRemaining:u.editsRemaining,str:u.str.slice(1)})}if(u.editsRemaining!=0){if("*"in u.node.edges)var d=u.node.edges["*"];else{var d=new t.TokenSet;u.node.edges["*"]=d}if(u.str.length==0&&(d.final=!0),s.push({node:d,editsRemaining:u.editsRemaining-1,str:u.str}),u.str.length>1&&s.push({node:u.node,editsRemaining:u.editsRemaining-1,str:u.str.slice(1)}),u.str.length==1&&(u.node.final=!0),u.str.length>=1){if("*"in u.node.edges)var h=u.node.edges["*"];else{var h=new t.TokenSet;u.node.edges["*"]=h}u.str.length==1&&(h.final=!0),s.push({node:h,editsRemaining:u.editsRemaining-1,str:u.str.slice(1)})}if(u.str.length>1){var c=u.str.charAt(0),p=u.str.charAt(1),g;p in u.node.edges?g=u.node.edges[p]:(g=new t.TokenSet,u.node.edges[p]=g),u.str.length==1&&(g.final=!0),s.push({node:g,editsRemaining:u.editsRemaining-1,str:c+u.str.slice(2)})}}}return r},t.TokenSet.fromString=function(n){for(var o=new t.TokenSet,r=o,s=0,u=n.length;s<u;s++){var a=n[s],l=s==u-1;if(a=="*")o.edges[a]=o,o.final=l;else{var d=new t.TokenSet;d.final=l,o.edges[a]=d,o=d}}return r},t.TokenSet.prototype.toArray=function(){for(var n=[],o=[{prefix:"",node:this}];o.length;){var r=o.pop(),s=Object.keys(r.node.edges),u=s.length;r.node.final&&(r.prefix.charAt(0),n.push(r.prefix));for(var a=0;a<u;a++){var l=s[a];o.push({prefix:r.prefix.concat(l),node:r.node.edges[l]})}}return n},t.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var n=this.final?"1":"0",o=Object.keys(this.edges).sort(),r=o.length,s=0;s<r;s++){var u=o[s],a=this.edges[u];n=n+u+a.id}return n},t.TokenSet.prototype.intersect=function(n){for(var o=new t.TokenSet,r=void 0,s=[{qNode:n,output:o,node:this}];s.length;){r=s.pop();for(var u=Object.keys(r.qNode.edges),a=u.length,l=Object.keys(r.node.edges),d=l.length,h=0;h<a;h++)for(var c=u[h],p=0;p<d;p++){var g=l[p];if(g==c||c=="*"){var y=r.node.edges[g],w=r.qNode.edges[c],v=y.final&&w.final,x=void 0;g in r.output.edges?(x=r.output.edges[g],x.final=x.final||v):(x=new t.TokenSet,x.final=v,r.output.edges[g]=x),s.push({qNode:w,output:x,node:y})}}}return o},t.TokenSet.Builder=function(){this.previousWord="",this.root=new t.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},t.TokenSet.Builder.prototype.insert=function(n){var o,r=0;if(n<this.previousWord)throw new Error("Out of order word insertion");for(var s=0;s<n.length&&s<this.previousWord.length&&n[s]==this.previousWord[s];s++)r++;this.minimize(r),this.uncheckedNodes.length==0?o=this.root:o=this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var s=r;s<n.length;s++){var u=new t.TokenSet,a=n[s];o.edges[a]=u,this.uncheckedNodes.push({parent:o,char:a,child:u}),o=u}o.final=!0,this.previousWord=n},t.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},t.TokenSet.Builder.prototype.minimize=function(n){for(var o=this.uncheckedNodes.length-1;o>=n;o--){var r=this.uncheckedNodes[o],s=r.child.toString();s in this.minimizedNodes?r.parent.edges[r.char]=this.minimizedNodes[s]:(r.child._str=s,this.minimizedNodes[s]=r.child),this.uncheckedNodes.pop()}};/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */t.Index=function(n){this.invertedIndex=n.invertedIndex,this.fieldVectors=n.fieldVectors,this.tokenSet=n.tokenSet,this.fields=n.fields,this.pipeline=n.pipeline},t.Index.prototype.search=function(n){return this.query(function(o){var r=new t.QueryParser(n,o);r.parse()})},t.Index.prototype.query=function(n){for(var o=new t.Query(this.fields),r=Object.create(null),s=Object.create(null),u=Object.create(null),a=Object.create(null),l=Object.create(null),d=0;d<this.fields.length;d++)s[this.fields[d]]=new t.Vector;n.call(o,o);for(var d=0;d<o.clauses.length;d++){var h=o.clauses[d],c=null,p=t.Set.empty;h.usePipeline?c=this.pipeline.runString(h.term,{fields:h.fields}):c=[h.term];for(var g=0;g<c.length;g++){var y=c[g];h.term=y;var w=t.TokenSet.fromClause(h),v=this.tokenSet.intersect(w).toArray();if(v.length===0&&h.presence===t.Query.presence.REQUIRED){for(var x=0;x<h.fields.length;x++){var m=h.fields[x];a[m]=t.Set.empty}break}for(var _=0;_<v.length;_++)for(var b=v[_],S=this.invertedIndex[b],A=S._index,x=0;x<h.fields.length;x++){var m=h.fields[x],T=S[m],L=Object.keys(T),oe=b+"/"+m,ie=new t.Set(L);if(h.presence==t.Query.presence.REQUIRED&&(p=p.union(ie),a[m]===void 0&&(a[m]=t.Set.complete)),h.presence==t.Query.presence.PROHIBITED){l[m]===void 0&&(l[m]=t.Set.empty),l[m]=l[m].union(ie);continue}if(s[m].upsert(A,h.boost,function(He,Yt){return He+Yt}),!u[oe]){for(var M=0;M<L.length;M++){var W=L[M],Q=new t.FieldRef(W,m),re=T[W],Y;(Y=r[Q])===void 0?r[Q]=new t.MatchData(b,m,re):Y.add(b,m,re)}u[oe]=!0}}}if(h.presence===t.Query.presence.REQUIRED)for(var x=0;x<h.fields.length;x++){var m=h.fields[x];a[m]=a[m].intersect(p)}}for(var ae=t.Set.complete,Ne=t.Set.empty,d=0;d<this.fields.length;d++){var m=this.fields[d];a[m]&&(ae=ae.intersect(a[m])),l[m]&&(Ne=Ne.union(l[m]))}var z=Object.keys(r),R=[],ne=Object.create(null);if(o.isNegated()){z=Object.keys(this.fieldVectors);for(var d=0;d<z.length;d++){var Q=z[d],de=t.FieldRef.fromString(Q);r[Q]=new t.MatchData}}for(var d=0;d<z.length;d++){var de=t.FieldRef.fromString(z[d]),U=de.docRef;if(!!ae.contains(U)&&!Ne.contains(U)){var se=this.fieldVectors[de],ze=s[de.fieldName].similarity(se),Le;if((Le=ne[U])!==void 0)Le.score+=ze,Le.matchData.combine(r[de]);else{var ce={ref:U,score:ze,matchData:r[de]};ne[U]=ce,R.push(ce)}}}return R.sort(function(Ge,ot){return ot.score-Ge.score})},t.Index.prototype.toJSON=function(){var n=Object.keys(this.invertedIndex).sort().map(function(r){return[r,this.invertedIndex[r]]},this),o=Object.keys(this.fieldVectors).map(function(r){return[r,this.fieldVectors[r].toJSON()]},this);return{version:t.version,fields:this.fields,fieldVectors:o,invertedIndex:n,pipeline:this.pipeline.toJSON()}},t.Index.load=function(n){var o={},r={},s=n.fieldVectors,u=Object.create(null),a=n.invertedIndex,l=new t.TokenSet.Builder,d=t.Pipeline.load(n.pipeline);n.version!=t.version&&t.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+t.version+"' does not match serialized index '"+n.version+"'");for(var h=0;h<s.length;h++){var c=s[h],p=c[0],g=c[1];r[p]=new t.Vector(g)}for(var h=0;h<a.length;h++){var c=a[h],y=c[0],w=c[1];l.insert(y),u[y]=w}return l.finish(),o.fields=n.fields,o.fieldVectors=r,o.invertedIndex=u,o.tokenSet=l.root,o.pipeline=d,new t.Index(o)};/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */t.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=t.tokenizer,this.pipeline=new t.Pipeline,this.searchPipeline=new t.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},t.Builder.prototype.ref=function(n){this._ref=n},t.Builder.prototype.field=function(n,o){if(/\//.test(n))throw new RangeError("Field '"+n+"' contains illegal character '/'");this._fields[n]=o||{}},t.Builder.prototype.b=function(n){n<0?this._b=0:n>1?this._b=1:this._b=n},t.Builder.prototype.k1=function(n){this._k1=n},t.Builder.prototype.add=function(n,o){var r=n[this._ref],s=Object.keys(this._fields);this._documents[r]=o||{},this.documentCount+=1;for(var u=0;u<s.length;u++){var a=s[u],l=this._fields[a].extractor,d=l?l(n):n[a],h=this.tokenizer(d,{fields:[a]}),c=this.pipeline.run(h),p=new t.FieldRef(r,a),g=Object.create(null);this.fieldTermFrequencies[p]=g,this.fieldLengths[p]=0,this.fieldLengths[p]+=c.length;for(var y=0;y<c.length;y++){var w=c[y];if(g[w]==null&&(g[w]=0),g[w]+=1,this.invertedIndex[w]==null){var v=Object.create(null);v._index=this.termIndex,this.termIndex+=1;for(var x=0;x<s.length;x++)v[s[x]]=Object.create(null);this.invertedIndex[w]=v}this.invertedIndex[w][a][r]==null&&(this.invertedIndex[w][a][r]=Object.create(null));for(var m=0;m<this.metadataWhitelist.length;m++){var _=this.metadataWhitelist[m],b=w.metadata[_];this.invertedIndex[w][a][r][_]==null&&(this.invertedIndex[w][a][r][_]=[]),this.invertedIndex[w][a][r][_].push(b)}}}},t.Builder.prototype.calculateAverageFieldLengths=function(){for(var n=Object.keys(this.fieldLengths),o=n.length,r={},s={},u=0;u<o;u++){var a=t.FieldRef.fromString(n[u]),l=a.fieldName;s[l]||(s[l]=0),s[l]+=1,r[l]||(r[l]=0),r[l]+=this.fieldLengths[a]}for(var d=Object.keys(this._fields),u=0;u<d.length;u++){var h=d[u];r[h]=r[h]/s[h]}this.averageFieldLength=r},t.Builder.prototype.createFieldVectors=function(){for(var n={},o=Object.keys(this.fieldTermFrequencies),r=o.length,s=Object.create(null),u=0;u<r;u++){for(var a=t.FieldRef.fromString(o[u]),l=a.fieldName,d=this.fieldLengths[a],h=new t.Vector,c=this.fieldTermFrequencies[a],p=Object.keys(c),g=p.length,y=this._fields[l].boost||1,w=this._documents[a.docRef].boost||1,v=0;v<g;v++){var x=p[v],m=c[x],_=this.invertedIndex[x]._index,b,S,A;s[x]===void 0?(b=t.idf(this.invertedIndex[x],this.documentCount),s[x]=b):b=s[x],S=b*((this._k1+1)*m)/(this._k1*(1-this._b+this._b*(d/this.averageFieldLength[l]))+m),S*=y,S*=w,A=Math.round(S*1e3)/1e3,h.insert(_,A)}n[a]=h}this.fieldVectors=n},t.Builder.prototype.createTokenSet=function(){this.tokenSet=t.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},t.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new t.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},t.Builder.prototype.use=function(n){var o=Array.prototype.slice.call(arguments,1);o.unshift(this),n.apply(this,o)},t.MatchData=function(n,o,r){for(var s=Object.create(null),u=Object.keys(r||{}),a=0;a<u.length;a++){var l=u[a];s[l]=r[l].slice()}this.metadata=Object.create(null),n!==void 0&&(this.metadata[n]=Object.create(null),this.metadata[n][o]=s)},t.MatchData.prototype.combine=function(n){for(var o=Object.keys(n.metadata),r=0;r<o.length;r++){var s=o[r],u=Object.keys(n.metadata[s]);this.metadata[s]==null&&(this.metadata[s]=Object.create(null));for(var a=0;a<u.length;a++){var l=u[a],d=Object.keys(n.metadata[s][l]);this.metadata[s][l]==null&&(this.metadata[s][l]=Object.create(null));for(var h=0;h<d.length;h++){var c=d[h];this.metadata[s][l][c]==null?this.metadata[s][l][c]=n.metadata[s][l][c]:this.metadata[s][l][c]=this.metadata[s][l][c].concat(n.metadata[s][l][c])}}}},t.MatchData.prototype.add=function(n,o,r){if(!(n in this.metadata)){this.metadata[n]=Object.create(null),this.metadata[n][o]=r;return}if(!(o in this.metadata[n])){this.metadata[n][o]=r;return}for(var s=Object.keys(r),u=0;u<s.length;u++){var a=s[u];a in this.metadata[n][o]?this.metadata[n][o][a]=this.metadata[n][o][a].concat(r[a]):this.metadata[n][o][a]=r[a]}},t.Query=function(n){this.clauses=[],this.allFields=n},t.Query.wildcard=new String("*"),t.Query.wildcard.NONE=0,t.Query.wildcard.LEADING=1,t.Query.wildcard.TRAILING=2,t.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},t.Query.prototype.clause=function(n){return"fields"in n||(n.fields=this.allFields),"boost"in n||(n.boost=1),"usePipeline"in n||(n.usePipeline=!0),"wildcard"in n||(n.wildcard=t.Query.wildcard.NONE),n.wildcard&t.Query.wildcard.LEADING&&n.term.charAt(0)!=t.Query.wildcard&&(n.term="*"+n.term),n.wildcard&t.Query.wildcard.TRAILING&&n.term.slice(-1)!=t.Query.wildcard&&(n.term=""+n.term+"*"),"presence"in n||(n.presence=t.Query.presence.OPTIONAL),this.clauses.push(n),this},t.Query.prototype.isNegated=function(){for(var n=0;n<this.clauses.length;n++)if(this.clauses[n].presence!=t.Query.presence.PROHIBITED)return!1;return!0},t.Query.prototype.term=function(n,o){if(Array.isArray(n))return n.forEach(function(s){this.term(s,t.utils.clone(o))},this),this;var r=o||{};return r.term=n.toString(),this.clause(r),this},t.QueryParseError=function(n,o,r){this.name="QueryParseError",this.message=n,this.start=o,this.end=r},t.QueryParseError.prototype=new Error,t.QueryLexer=function(n){this.lexemes=[],this.str=n,this.length=n.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},t.QueryLexer.prototype.run=function(){for(var n=t.QueryLexer.lexText;n;)n=n(this)},t.QueryLexer.prototype.sliceString=function(){for(var n=[],o=this.start,r=this.pos,s=0;s<this.escapeCharPositions.length;s++)r=this.escapeCharPositions[s],n.push(this.str.slice(o,r)),o=r+1;return n.push(this.str.slice(o,this.pos)),this.escapeCharPositions.length=0,n.join("")},t.QueryLexer.prototype.emit=function(n){this.lexemes.push({type:n,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},t.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},t.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return t.QueryLexer.EOS;var n=this.str.charAt(this.pos);return this.pos+=1,n},t.QueryLexer.prototype.width=function(){return this.pos-this.start},t.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},t.QueryLexer.prototype.backup=function(){this.pos-=1},t.QueryLexer.prototype.acceptDigitRun=function(){var n,o;do n=this.next(),o=n.charCodeAt(0);while(o>47&&o<58);n!=t.QueryLexer.EOS&&this.backup()},t.QueryLexer.prototype.more=function(){return this.pos<this.length},t.QueryLexer.EOS="EOS",t.QueryLexer.FIELD="FIELD",t.QueryLexer.TERM="TERM",t.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",t.QueryLexer.BOOST="BOOST",t.QueryLexer.PRESENCE="PRESENCE",t.QueryLexer.lexField=function(n){return n.backup(),n.emit(t.QueryLexer.FIELD),n.ignore(),t.QueryLexer.lexText},t.QueryLexer.lexTerm=function(n){if(n.width()>1&&(n.backup(),n.emit(t.QueryLexer.TERM)),n.ignore(),n.more())return t.QueryLexer.lexText},t.QueryLexer.lexEditDistance=function(n){return n.ignore(),n.acceptDigitRun(),n.emit(t.QueryLexer.EDIT_DISTANCE),t.QueryLexer.lexText},t.QueryLexer.lexBoost=function(n){return n.ignore(),n.acceptDigitRun(),n.emit(t.QueryLexer.BOOST),t.QueryLexer.lexText},t.QueryLexer.lexEOS=function(n){n.width()>0&&n.emit(t.QueryLexer.TERM)},t.QueryLexer.termSeparator=t.tokenizer.separator,t.QueryLexer.lexText=function(n){for(;;){var o=n.next();if(o==t.QueryLexer.EOS)return t.QueryLexer.lexEOS;if(o.charCodeAt(0)==92){n.escapeCharacter();continue}if(o==":")return t.QueryLexer.lexField;if(o=="~")return n.backup(),n.width()>0&&n.emit(t.QueryLexer.TERM),t.QueryLexer.lexEditDistance;if(o=="^")return n.backup(),n.width()>0&&n.emit(t.QueryLexer.TERM),t.QueryLexer.lexBoost;if(o=="+"&&n.width()===1||o=="-"&&n.width()===1)return n.emit(t.QueryLexer.PRESENCE),t.QueryLexer.lexText;if(o.match(t.QueryLexer.termSeparator))return t.QueryLexer.lexTerm}},t.QueryParser=function(n,o){this.lexer=new t.QueryLexer(n),this.query=o,this.currentClause={},this.lexemeIdx=0},t.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var n=t.QueryParser.parseClause;n;)n=n(this);return this.query},t.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},t.QueryParser.prototype.consumeLexeme=function(){var n=this.peekLexeme();return this.lexemeIdx+=1,n},t.QueryParser.prototype.nextClause=function(){var n=this.currentClause;this.query.clause(n),this.currentClause={}},t.QueryParser.parseClause=function(n){var o=n.peekLexeme();if(o!=null)switch(o.type){case t.QueryLexer.PRESENCE:return t.QueryParser.parsePresence;case t.QueryLexer.FIELD:return t.QueryParser.parseField;case t.QueryLexer.TERM:return t.QueryParser.parseTerm;default:var r="expected either a field or a term, found "+o.type;throw o.str.length>=1&&(r+=" with value '"+o.str+"'"),new t.QueryParseError(r,o.start,o.end)}},t.QueryParser.parsePresence=function(n){var o=n.consumeLexeme();if(o!=null){switch(o.str){case"-":n.currentClause.presence=t.Query.presence.PROHIBITED;break;case"+":n.currentClause.presence=t.Query.presence.REQUIRED;break;default:var r="unrecognised presence operator'"+o.str+"'";throw new t.QueryParseError(r,o.start,o.end)}var s=n.peekLexeme();if(s==null){var r="expecting term or field, found nothing";throw new t.QueryParseError(r,o.start,o.end)}switch(s.type){case t.QueryLexer.FIELD:return t.QueryParser.parseField;case t.QueryLexer.TERM:return t.QueryParser.parseTerm;default:var r="expecting term or field, found '"+s.type+"'";throw new t.QueryParseError(r,s.start,s.end)}}},t.QueryParser.parseField=function(n){var o=n.consumeLexeme();if(o!=null){if(n.query.allFields.indexOf(o.str)==-1){var r=n.query.allFields.map(function(a){return"'"+a+"'"}).join(", "),s="unrecognised field '"+o.str+"', possible fields: "+r;throw new t.QueryParseError(s,o.start,o.end)}n.currentClause.fields=[o.str];var u=n.peekLexeme();if(u==null){var s="expecting term, found nothing";throw new t.QueryParseError(s,o.start,o.end)}switch(u.type){case t.QueryLexer.TERM:return t.QueryParser.parseTerm;default:var s="expecting term, found '"+u.type+"'";throw new t.QueryParseError(s,u.start,u.end)}}},t.QueryParser.parseTerm=function(n){var o=n.consumeLexeme();if(o!=null){n.currentClause.term=o.str.toLowerCase(),o.str.indexOf("*")!=-1&&(n.currentClause.usePipeline=!1);var r=n.peekLexeme();if(r==null){n.nextClause();return}switch(r.type){case t.QueryLexer.TERM:return n.nextClause(),t.QueryParser.parseTerm;case t.QueryLexer.FIELD:return n.nextClause(),t.QueryParser.parseField;case t.QueryLexer.EDIT_DISTANCE:return t.QueryParser.parseEditDistance;case t.QueryLexer.BOOST:return t.QueryParser.parseBoost;case t.QueryLexer.PRESENCE:return n.nextClause(),t.QueryParser.parsePresence;default:var s="Unexpected lexeme type '"+r.type+"'";throw new t.QueryParseError(s,r.start,r.end)}}},t.QueryParser.parseEditDistance=function(n){var o=n.consumeLexeme();if(o!=null){var r=parseInt(o.str,10);if(isNaN(r)){var s="edit distance must be numeric";throw new t.QueryParseError(s,o.start,o.end)}n.currentClause.editDistance=r;var u=n.peekLexeme();if(u==null){n.nextClause();return}switch(u.type){case t.QueryLexer.TERM:return n.nextClause(),t.QueryParser.parseTerm;case t.QueryLexer.FIELD:return n.nextClause(),t.QueryParser.parseField;case t.QueryLexer.EDIT_DISTANCE:return t.QueryParser.parseEditDistance;case t.QueryLexer.BOOST:return t.QueryParser.parseBoost;case t.QueryLexer.PRESENCE:return n.nextClause(),t.QueryParser.parsePresence;default:var s="Unexpected lexeme type '"+u.type+"'";throw new t.QueryParseError(s,u.start,u.end)}}},t.QueryParser.parseBoost=function(n){var o=n.consumeLexeme();if(o!=null){var r=parseInt(o.str,10);if(isNaN(r)){var s="boost must be numeric";throw new t.QueryParseError(s,o.start,o.end)}n.currentClause.boost=r;var u=n.peekLexeme();if(u==null){n.nextClause();return}switch(u.type){case t.QueryLexer.TERM:return n.nextClause(),t.QueryParser.parseTerm;case t.QueryLexer.FIELD:return n.nextClause(),t.QueryParser.parseField;case t.QueryLexer.EDIT_DISTANCE:return t.QueryParser.parseEditDistance;case t.QueryLexer.BOOST:return t.QueryParser.parseBoost;case t.QueryLexer.PRESENCE:return n.nextClause(),t.QueryParser.parsePresence;default:var s="Unexpected lexeme type '"+u.type+"'";throw new t.QueryParseError(s,u.start,u.end)}}},function(n,o){i.exports=o()}(this,function(){return t})})()})(Mo);const Fo=Mo.exports;class gn{constructor(){(this.constructor.name==="Object"||this.constructor===gn)&&console.error("Loggable is an abstract class")}logMessageName(){}logMessageNameNoId(){}getLogName(){return this.logMessageName()}logMessageFormat(e){return`${this.getLogName()}: ${e}`}logInfo(e){console.log(this.logMessageFormat(e))}logWarning(e){console.warn(this.logMessageFormat(e)),console.trace()}logError(e){console.error(this.logMessageFormat(e)),console.trace()}}class Bo extends gn{constructor(e){super(),this.name=e,this.components=new Map}addComponent(e){this.components.set(e.id,e)}removeComponent(e){this.components.delete(e.id)}update(e){this.preUpdate(e),this.components.forEach(t=>this.innerUpdate(e,t)),this.postUpdate(e)}logMessageName(){return`[${this.name}]`}logMessageNameNoId(){return this.logMessageName()}preUpdate(e){}innerUpdate(e,t){this.logError("System.innerUpdate must be overriden by each subclass of System")}postUpdate(e){}}class xs extends Bo{constructor(){super("SceneManager")}innerUpdate(e,t){const n=e/1e3;t.controlledComponents.forEach(o=>o.runScripts("OnTick",{camera:t.camera})),t.layers.forEach(o=>o.update(n))}}class he{constructor(e,t){this.x=e,this.y=t}equals(e){return Math.abs(this.x-e.x)<=O.epsilon&&Math.abs(this.y-e.y)<=O.epsilon}plus(e){return new he(this.x+e.x,this.y+e.y)}minus(e){return new he(this.x-e.x,this.y-e.y)}scale(e){return new he(this.x*e,this.y*e)}plusEqual(e){this.x+=e.x,this.y+=e.y}minusEqual(e){this.x-=e.x,this.y-=e.y}scaleEqual(e){this.x*=e,this.y*=e}negative(){return new he(-this.x,-this.y)}perpendicular(){return new he(-this.y,this.x)}lengthSquared(){return this.x*this.x+this.y*this.y}magnitude(){return Math.sqrt(this.lengthSquared())}norm(){const e=this.magnitude();return e==0?new he(0,0):this.scale(1/e)}normalize(){return this.scaleEqual(1/this.magnitude()),this}dot(e){return this.x*e.x+this.y*e.y}}const{Engine:wi,Bodies:ws,Body:Wd,Composite:_i,Events:_s,Runner:Ud}=vo;class Is{constructor(e,t){this.game=e,this.engine=wi.create(),this.engine.gravity.scale*=t,_s.on(this.engine,"collisionStart",n=>{n.pairs.forEach(o=>{const r=new he(o.collision.normal.x,-o.collision.normal.y),s=r.scale(-1);o.bodyA._owner.states&&o.bodyA._owner.runScripts("OnCollide",{camera:e.currentScene.camera,data:[s,o.bodyB._owner]}),o.bodyB._owner.states&&o.bodyB._owner.runScripts("OnCollide",{camera:e.currentScene.camera,data:[r,o.bodyA._owner]})})})}update(e,t){wi.update(this.engine,e,t)}createRect(e,t,n={}){n.inertia=1/0;let o=ws.rectangle(e.x,e.y,t.x,t.y,n);return _i.add(this.engine.world,o),o}deleteRect(e){_i.remove(this.engine.world,e)}}class Qt extends gn{constructor(e){super(),this.debugName=e,this.id=Mt()}isSameComponent(e){return this.id===e.id}logMessageName(){return`{${this.debugName}@${this.id}}`}logMessageNameNoId(){return`{${this.debugName}}`}}let xt=typeof Float32Array<"u"?Float32Array:Array;function bt(){let i=new xt(16);return xt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}function bs(i,e){let t=e[0],n=e[1],o=e[2],r=e[3],s=e[4],u=e[5],a=e[6],l=e[7],d=e[8],h=e[9],c=e[10],p=e[11],g=e[12],y=e[13],w=e[14],v=e[15],x=t*u-n*s,m=t*a-o*s,_=t*l-r*s,b=n*a-o*u,S=n*l-r*u,A=o*l-r*a,T=d*y-h*g,L=d*w-c*g,oe=d*v-p*g,ie=h*w-c*y,M=h*v-p*y,W=c*v-p*w,Q=x*W-m*M+_*ie+b*oe-S*L+A*T;return Q?(Q=1/Q,i[0]=(u*W-a*M+l*ie)*Q,i[1]=(o*M-n*W-r*ie)*Q,i[2]=(y*A-w*S+v*b)*Q,i[3]=(c*S-h*A-p*b)*Q,i[4]=(a*oe-s*W-l*L)*Q,i[5]=(t*W-o*oe+r*L)*Q,i[6]=(w*_-g*A-v*m)*Q,i[7]=(d*A-c*_+p*m)*Q,i[8]=(s*M-u*oe+l*T)*Q,i[9]=(n*oe-t*M-r*T)*Q,i[10]=(g*S-y*_+v*x)*Q,i[11]=(h*_-d*S-p*x)*Q,i[12]=(u*L-s*ie-a*T)*Q,i[13]=(t*ie-n*L+o*T)*Q,i[14]=(y*m-g*b-w*x)*Q,i[15]=(d*b-h*m+c*x)*Q,i):null}function Es(i,e,t){let n=e[0],o=e[1],r=e[2],s=e[3],u=e[4],a=e[5],l=e[6],d=e[7],h=e[8],c=e[9],p=e[10],g=e[11],y=e[12],w=e[13],v=e[14],x=e[15],m=t[0],_=t[1],b=t[2],S=t[3];return i[0]=m*n+_*u+b*h+S*y,i[1]=m*o+_*a+b*c+S*w,i[2]=m*r+_*l+b*p+S*v,i[3]=m*s+_*d+b*g+S*x,m=t[4],_=t[5],b=t[6],S=t[7],i[4]=m*n+_*u+b*h+S*y,i[5]=m*o+_*a+b*c+S*w,i[6]=m*r+_*l+b*p+S*v,i[7]=m*s+_*d+b*g+S*x,m=t[8],_=t[9],b=t[10],S=t[11],i[8]=m*n+_*u+b*h+S*y,i[9]=m*o+_*a+b*c+S*w,i[10]=m*r+_*l+b*p+S*v,i[11]=m*s+_*d+b*g+S*x,m=t[12],_=t[13],b=t[14],S=t[15],i[12]=m*n+_*u+b*h+S*y,i[13]=m*o+_*a+b*c+S*w,i[14]=m*r+_*l+b*p+S*v,i[15]=m*s+_*d+b*g+S*x,i}function Ns(i,e,t){let n=t[0],o=t[1],r=t[2],s,u,a,l,d,h,c,p,g,y,w,v;return e===i?(i[12]=e[0]*n+e[4]*o+e[8]*r+e[12],i[13]=e[1]*n+e[5]*o+e[9]*r+e[13],i[14]=e[2]*n+e[6]*o+e[10]*r+e[14],i[15]=e[3]*n+e[7]*o+e[11]*r+e[15]):(s=e[0],u=e[1],a=e[2],l=e[3],d=e[4],h=e[5],c=e[6],p=e[7],g=e[8],y=e[9],w=e[10],v=e[11],i[0]=s,i[1]=u,i[2]=a,i[3]=l,i[4]=d,i[5]=h,i[6]=c,i[7]=p,i[8]=g,i[9]=y,i[10]=w,i[11]=v,i[12]=s*n+d*o+g*r+e[12],i[13]=u*n+h*o+y*r+e[13],i[14]=a*n+c*o+w*r+e[14],i[15]=l*n+p*o+v*r+e[15]),i}function Ss(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}function Cs(i,e,t,n,o,r,s){const u=1/(e-t),a=1/(n-o),l=1/(r-s);return i[0]=-2*u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*l,i[11]=0,i[12]=(e+t)*u,i[13]=(o+n)*a,i[14]=(s+r)*l,i[15]=1,i}const ks=Cs,zo=Es;class Ds{constructor(e,t,n,o,r,{scale:s=1}={}){this.vertexArray=void 0,this.vertexBuffer=void 0,this.indexBuffer=void 0,this.init(e,n,o,r),this.elementCount=r.length,this.transform=bt(),this.scale=s,this.setTransform(t)}setTransform(e){Ss(this.transform,[e.x,e.y,0]),this.setScale(this.scale)}setScale(e){this.scale=e,this.transform[0]=this.transform[5]=this.scale}init(e,t,n,o){this.vertexArray=e.createVertexArray(),e.bindVertexArray(this.vertexArray),this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW);const r=t.getAttribLocation("i_pos");e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,4*4,0);const s=t.getAttribLocation("i_tex");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,4*4,2*4),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),e.STATIC_DRAW)}bind(e,t,n){e.bindVertexArray(this.vertexArray),n.bind(e,0),t.uniform1i(e,"u_texture",0),t.uniform1i(e,"u_frame",n.frame)}draw(e,t,n){this.bind(e,t,n),e.drawElements(e.TRIANGLES,this.elementCount,e.UNSIGNED_SHORT,0)}}let Ut=new Map;class Zt{constructor(e,t,n){this.resizeCanvas=document.createElement("canvas"),this.resizeCtx=this.resizeCanvas.getContext("2d"),this.texture=e.createTexture(),this.frame=0,this.frameCount=n.length,this.frameTime=t,this.lastSwitch=0,e.bindTexture(e.TEXTURE_2D_ARRAY,this.texture),this.createEmptyTexture(e,1,1,1);let o=[],r=()=>{let a=0,l=0;o.forEach(d=>{a=Math.max(a,d.width),l=Math.max(l,d.height)}),e.bindTexture(e.TEXTURE_2D_ARRAY,this.texture),this.createEmptyTexture(e,a,l,n.length),o.forEach((d,h)=>{this.resizeCanvas.width=a,this.resizeCanvas.height=l,this.resizeCtx.clearRect(0,0,a,l),this.resizeCtx.drawImage(d,0,0,a,l),e.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,h,this.resizeCanvas.width,this.resizeCanvas.height,1,e.RGBA,e.UNSIGNED_BYTE,this.resizeCanvas)}),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.LINEAR)},s=0,u=(a,l)=>{s++,s===n.length&&r(),Ut.has(a)||Ut.set(a,l)};n.forEach(a=>{if(Ut.has(a)){const l=Ut.get(a);o.push(l),u()}else{const l=new Image;l.crossOrigin="anonymous",l.onload=()=>u(a,l),l.src=a,o.push(l)}}),this.urls=n}createEmptyTexture(e,t,n,o){e.texImage3D(e.TEXTURE_2D_ARRAY,0,e.RGBA,t,n,o,0,e.RGBA,e.UNSIGNED_BYTE,void 0)}bind(e,t){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D_ARRAY,this.texture),!O.context.paused&&this.frameCount>1&&O.time.now-this.lastSwitch>=this.frameTime&&(this.frame=(this.frame+1)%this.frameCount,this.lastSwitch=O.time.now)}}const{Body:Vn}=vo,Ps=[-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1],Ts=[0,1,2,0,2,3];class Vs{constructor({vertices:e=Ps,indices:t=Ts,isStatic:n=!0,scale:o=1}={}){this.vertices=e,this.indices=t,this.isStatic=n,this.scale=o}}class Qo extends Qt{constructor(e,t,n,o={}){super("SceneEntity"),this.ops=new Vs(o);const r=this.ops.vertices,s=this.ops.indices;this.renderable=new Ds(t.gl,n,t.shaderProgram,r,s,{scale:this.ops.scale}),this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0;for(var u=0;u<r.length;u+=4)this.minX=Math.min(this.minX,r[u]),this.maxX=Math.max(this.maxX,r[u]),this.minY=Math.min(this.minY,r[u+1]),this.maxY=Math.max(this.maxY,r[u+1]);this.pos=n,this.game=e,this.createPhysicsProxy(),this.scene=void 0,this.sceneZ=void 0}bindToScene(e,t){this.scene=e,this.sceneZ=t}createPhysicsProxy(){this.dim=new he(this.maxX-this.minX,this.maxY-this.minY).scale(this.ops.scale),this.physicsProxy=this.game.physicsEngine.createRect(this.pos.plus(this.dim.scale(.5)),this.dim,{isStatic:this.ops.isStatic,friction:0}),this.physicsProxy._owner=this}setScale(e){e!==this.ops.scale&&(this.ops.scale=e,this.renderable.setScale(e),this.game.physicsEngine.deleteRect(this.physicsProxy),this.createPhysicsProxy())}destroy(){this.game.physicsEngine.deleteRect(this.physicsProxy)}setMass(e){Vn.setMass(this.physicsProxy,e)}getCurrentTexture(){}}class As extends Qo{constructor(e,t,n,o,r,s={}){super(e,t,n,s),this.texture=new Zt(t.gl,o,r)}getCurrentTexture(){return this.texture}}class Yo extends Qo{constructor(e,t,n,o={}){super(e,t,n,{isStatic:!1,...o});const r=o.vel||new he(0,0);Vn.setVelocity(this.physicsProxy,{x:r.x,y:r.y})}move(){const{position:e}=this.physicsProxy;this.pos.x=e.x,this.pos.y=e.y,this.renderable.setTransform(this.pos)}applyForce(e){Vn.applyForce(this.physicsProxy,this.physicsProxy.position,e)}setVelocity(e){this.setVelocityX(e.x),this.setVelocityY(e.y)}setVelocityX(e){this.physicsProxy.force.x,this.physicsProxy.force.x=(e-this.physicsProxy.velocity.x)*this.physicsProxy.mass/(O.time.delta*O.time.delta)}setVelocityY(e){this.physicsProxy.force.y=e*this.physicsProxy.mass/(O.time.delta*O.time.delta)}}class Os extends Yo{constructor(e,t,n,o,r,s={}){super(e,t,n,s),this.states=o,this.currentState=this.states.get(r),this.animationIndex=4}runScripts(e,t){this.currentState.run(e,{...t,entity:this})}setState(e){this.currentState.name!==e&&(this.currentState=this.states.get(e),this.currentState.reset())}getCurrentTexture(){return this.currentState.textures[this.animationIndex]}setAnimationIndex(e){if(e<0||e>8){this.logError(`Invalid animation index ${e}`);return}this.animationIndex=e}}class Rs{constructor(e){this.physicsEngine=new Is(this,-5),this.currentScene=void 0,this.sceneManager=new xs,e.addSystem(this.sceneManager)}setCurrentScene(e){this.currentScene=e,this.sceneManager.addComponent(e)}addStaticSceneEntity(e,t,n,o,r,s={}){this.currentScene.addStaticEntity(new As(this,t,n,o,r,s),e)}addDynamicSceneEntity(e,t,n,o={}){this.currentScene.addDynamicEntity(new Yo(this,t,n,o),e)}addControlledSceneEntity(e,t,n,o,r,s={}){this.currentScene.addControlledEntity(new Os(this,t,n,o,r,s),e)}removeStaticSceneEntity(e){this.currentScene.removeStaticEntity(e)}removeDynamicSceneEntity(e){this.currentScene.removeDynamicEntity(e)}removeControlledSceneEntity(e){this.currentScene.removeControlledEntity(e,e.sceneZ)}draw(e){this.drawFromPerspective(e,this.currentScene.camera)}drawFromPerspective(e,t){this.currentScene.layers.forEach(n=>n.draw(e,t))}}class Ls{constructor(){this.systems=new Map,this.windows=[],this.paused=!1,this.game=new Rs(this),window.addEventListener("resize",()=>this.propagateResizeEvent()),window.addEventListener("keydown",e=>{e.ctrlKey&&e.key.toLowerCase()==="s"&&(e.preventDefault(),e.stopPropagation())})}propagateResizeEvent(){this.windows.forEach(e=>e.propagateResizeEvent())}run(){requestAnimationFrame(this.run.bind(this));const{deltaTime:e,deltaCorrection:t}=O.beginFrame();e>100||(O.varyingController.update(e),this.paused||(this.systems.forEach(n=>n.update(e)),this.game.physicsEngine.update(e,t)),this.windows.forEach(n=>n.update(e)))}addSystem(e){this.systems.has(e.name)&&console.warn(`Overwriting system '${e.name}'`),this.systems.set(e.name,e)}removeWindow(e){const t=this.windows.indexOf(e);t!==-1&&this.windows.splice(t,1)}}class Ms extends Bo{constructor(){super("VaryingController")}innerUpdate(e,t){const n=e/1e3;t.value+=t.step*(t.end-t.start)*n,t.value>t.end&&this.clamp(t,t.end),t.value<t.start&&this.clamp(t,t.start)}clamp(e,t){e.reset?e.value=e.start:(e.value=t,e.step*=-1,e.repeatCount||this.removeComponent(e),e.repeatCount!=-1&&e.repeatCount--)}}var O={context:void 0,varyingController:void 0,fps:60,mouseX:0,mouseY:0,epsilon:1e-4,canvas:{targetWidth:1920,targetHeight:1080},time:{last:0,now:0,delta:0,lastDelta:0},init:()=>{O.context=new Ls,O.varyingController=new Ms,O.context.addSystem(O.varyingController),window.oncontextmenu=i=>{i.preventDefault(),i.stopPropagation()},window.onmousemove=i=>{O.mouseX=i.clientX,O.mouseY=i.clientY}},padZeroes:(i,e)=>{for(;i.length<e;)i="0"+i;return i},updateTime:()=>(O.time.now=performance.now(),O.time.lastDelta=O.time.delta,O.time.delta=O.time.now-O.time.last,O.time.last=O.time.now,O.time.delta),beginFrame:()=>{const i=O.updateTime();return{deltaTime:i,deltaCorrection:i/O.time.lastDelta}},clamp:(i,e,t)=>Math.min(t,Math.max(i,e)),rectIntersect:(i,e,t,n,o,r)=>e>=n&&e<=n+r&&i>=t&&i<=t+o,colorMix:(i,e,t)=>{const n=parseInt(i.substring(1),16),o=parseInt(e.substring(1),16),r=n>>16,s=o>>16,u=n>>8&255,a=o>>8&255,l=n&255,d=o&255,h=Math.floor(t*r+(1-t)*s),c=Math.floor(t*u+(1-t)*a),p=Math.floor(t*l+(1-t)*d),g=O.padZeroes(h.toString(16),2),y=O.padZeroes(c.toString(16),2),w=O.padZeroes(p.toString(16),2);return`#${g}${y}${w}`},lineLength:(i,e,t,n)=>{const o=i-t,r=e-n;return Math.sqrt(o*o+r*r)},keyToDisplayStr:i=>i===" "?"Space":i,alphabetSort:i=>i.sort((e,t)=>e.name.toLowerCase()>t.name.toLowerCase()?1:-1)};class Gt{constructor(e,t,n){this.name=e,this.frameTime=t,this.urls=n}}const An=[new Gt("Blank",0,["/MissingTexture.svg"]),...O.alphabetSort([new Gt("Link",0,["https://art.pixilart.com/840bcbc293e372f.png"]),new Gt("Item",0,["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"]),new Gt("Link & Item",500,["https://art.pixilart.com/840bcbc293e372f.png","https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"])])],Fs=Fo(function(){this.field("name"),this.ref("id"),An.forEach((i,e)=>{this.add({id:e,name:i.name})})});function Bs(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20"),f(e,"fill","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Jn extends J{constructor(e){super(),ee(this,e,null,Bs,te,{})}}function Ii(i,e,t){const n=i.slice();return n[11]=e[t],n}function bi(i,e){let t,n,o,r,s,u,a=e[11].candidate.name+"",l,d;return{key:i,first:null,c(){t=C("div"),n=C("div"),o=C("img"),s=H(),u=C("div"),l=pe(a),d=H(),this.h()},l(h){t=k(h,"DIV",{class:!0});var c=N(t);n=k(c,"DIV",{class:!0});var p=N(n);o=k(p,"IMG",{class:!0,src:!0,alt:!0}),p.forEach(I),s=K(c),u=k(c,"DIV",{class:!0});var g=N(u);l=fe(g,a),g.forEach(I),d=K(c),c.forEach(I),this.h()},h(){f(o,"class","max-w-full max-h-full"),en(o.src,r=e[11].candidate.urls[e[11]._frame])||f(o,"src",r),f(o,"alt",""),f(n,"class","w-16 h-16 grow-0 shrink-0 overflow-hidden flex flex-row items-center justify-center bg-neutral-800 border border-solid border-neutral-700"),f(u,"class","w-full overflow-hidden text-ellipsis whitespace-nowrap text-center mt-2"),f(t,"class","flex flex-col items-center justify-center grow-0 shrink-0 px-4 py-2 hover:bg-neutral-800 focus:bg-neutral-700 transition-all rounded-md"),this.first=t},m(h,c){F(h,t,c),E(t,n),E(n,o),E(t,s),E(t,u),E(u,l),E(t,d)},p(h,c){e=h,c&2&&!en(o.src,r=e[11].candidate.urls[e[11]._frame])&&f(o,"src",r),c&2&&a!==(a=e[11].candidate.name+"")&&We(l,a)},d(h){h&&I(t)}}}function zs(i){let e,t,n,o,r,s,u,a,l,d=[],h=new Map,c,p,g,y;u=new Jn({});let w=i[1];const v=x=>x[11].id;for(let x=0;x<w.length;x+=1){let m=Ii(i,w,x),_=v(m);h.set(_,d[x]=bi(_,m))}return{c(){e=C("div"),t=C("div"),n=C("input"),o=H(),r=C("div"),s=C("div"),G(u.$$.fragment),a=H(),l=C("div");for(let x=0;x<d.length;x+=1)d[x].c();this.h()},l(x){e=k(x,"DIV",{class:!0});var m=N(e);t=k(m,"DIV",{class:!0});var _=N(t);n=k(_,"INPUT",{placeholder:!0,class:!0}),o=K(_),r=k(_,"DIV",{class:!0});var b=N(r);s=k(b,"DIV",{class:!0});var S=N(s);X(u.$$.fragment,S),S.forEach(I),b.forEach(I),_.forEach(I),a=K(m),l=k(m,"DIV",{class:!0});var A=N(l);for(let T=0;T<d.length;T+=1)d[T].l(A);A.forEach(I),m.forEach(I),this.h()},h(){f(n,"placeholder","Search..."),f(n,"class","grow-1 shrink-1 p-2 pl-8 w-full min-w-0 border-0 outline-none bg-neutral-900"),f(s,"class","w-5 h-5"),f(r,"class","absolute w-8 h-10 flex items-center justify-center text-neutral-500 pointer-events-none"),f(t,"class","grow-0 shrink-0 flex flex-row border-b border-solid border-neutral-700 h-10"),f(l,"class","grow-1 shrink-1 grid grid-flow-col auto-cols-max auto-rows-max p-4 gap-4 w-full h-full overflow-x-hidden overflow-y-auto"),f(e,"class","grow-1 shrink-1 w-full h-full overflow-hidden flex flex-col")},m(x,m){F(x,e,m),E(e,t),E(t,n),Ae(n,i[0]),E(t,o),E(t,r),E(r,s),j(u,s,null),E(e,a),E(e,l);for(let _=0;_<d.length;_+=1)d[_].m(l,null);p=!0,g||(y=[B(n,"input",i[6]),Bn(c=$n.call(null,l,{type:"Animation",dropFromOthersDisabled:!0,morphDisabled:!0,dropTargetStyle:"",items:i[1]})),B(l,"consider",i[2]),B(l,"finalize",i[3])],g=!0)},p(x,[m]){m&1&&n.value!==x[0]&&Ae(n,x[0]),m&2&&(w=x[1],d=zn(d,m,v,1,x,w,h,l,po,bi,null,Ii)),c&&me(c.update)&&m&2&&c.update.call(null,{type:"Animation",dropFromOthersDisabled:!0,morphDisabled:!0,dropTargetStyle:"",items:x[1]})},i(x){p||(P(u.$$.fragment,x),p=!0)},o(x){V(u.$$.fragment,x),p=!1},d(x){x&&I(e),q(u);for(let m=0;m<d.length;m+=1)d[m].d();g=!1,Ee(y)}}}function Qs(i,e,t){let n="",o=[],r=[],s,u=!1;function a(g){const{trigger:y,id:w}=g.detail.info;if(y===Ve.DRAG_STARTED){const v=r.findIndex(m=>m.id===w),x=`${w}_copy_${Math.round(Math.random()*1e5)}`;g.detail.items=g.detail.items.filter(m=>!m[Bt]),g.detail.items.splice(v,0,{...r[v],id:x}),t(1,r=g.detail.items),u=!0}else u?t(1,r=[...r]):t(1,r=g.detail.items)}function l(g){u?(t(1,r=[...r]),u=!1):t(1,r=g.detail.items)}function d(g){t(1,r=g.map(y=>({id:Mt(),candidate:y,_timer:Date.now(),_frame:0})))}let h;function c(){h&&(h=window.requestAnimationFrame(c));const g=Date.now();let y=!1;for(const w of r)w.candidate.frameTime>0&&g-w._timer>w.candidate.frameTime&&(w._frame=(w._frame+1)%w.candidate.urls.length,w._timer=g,y=!0);y&&t(1,r)}qe(()=>{typeof window<"u"&&(h=window.requestAnimationFrame(c))}),Qn(()=>{typeof window<"u"&&(window.cancelAnimationFrame(h),h=void 0)});function p(){n=this.value,t(0,n)}return i.$$.update=()=>{if(i.$$.dirty&49){const g=n.trim();if(g.length>=3){t(4,o=[]);for(const y of Fs.search(g))o.push(An[parseInt(y.ref)]);o.indexOf(s)===-1&&(o.length>0?t(5,s=o[0]):t(5,s=null))}else t(4,o=[...An]),s===null&&t(5,s=o[0]);d(o)}},[n,r,a,l,o,s,p]}class Ys extends J{constructor(e){super(),ee(this,e,Qs,zs,te,{})}}function Ei(i,e,t){const n=i.slice();return n[4]=e[t],n}function Ni(i){let e,t=i[4]+"",n,o,r,s,u;function a(){return i[3](i[4])}return{c(){e=C("button"),n=pe(t),o=H(),this.h()},l(l){e=k(l,"BUTTON",{class:!0});var d=N(e);n=fe(d,t),o=K(d),d.forEach(I),this.h()},h(){f(e,"class",r=`grow-0 shrink-0 flex flex-row items-center p-2 cursor-pointer overflow-hidden whitespace-nowrap text-ellipsis focus:bg-neutral-700 transition-all outline-0 text-left h-12 border-r border-solid border-neutral-700 ${i[4]===i[0]?"bg-neutral-700":"hover:bg-neutral-800"}`)},m(l,d){F(l,e,d),E(e,n),E(e,o),s||(u=B(e,"click",a),s=!0)},p(l,d){i=l,d&1&&r!==(r=`grow-0 shrink-0 flex flex-row items-center p-2 cursor-pointer overflow-hidden whitespace-nowrap text-ellipsis focus:bg-neutral-700 transition-all outline-0 text-left h-12 border-r border-solid border-neutral-700 ${i[4]===i[0]?"bg-neutral-700":"hover:bg-neutral-800"}`)&&f(e,"class",r)},d(l){l&&I(e),s=!1,u()}}}function Ws(i){return{c:D,l:D,m:D,i:D,o:D,d:D}}function Us(i){let e,t;return e=new Ys({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Gs(i){return{c:D,l:D,m:D,i:D,o:D,d:D}}function Xs(i){let e,t,n,o,r,s,u,a=i[1],l=[];for(let p=0;p<a.length;p+=1)l[p]=Ni(Ei(i,a,p));const d=[Gs,Us,Ws],h=[];function c(p,g){return p[0]==="Prefabs"?0:p[0]==="Animations"?1:p[0]==="Sounds"?2:-1}return~(r=c(i))&&(s=h[r]=d[r](i)),{c(){e=C("div"),t=C("div");for(let p=0;p<l.length;p+=1)l[p].c();n=H(),o=C("div"),s&&s.c(),this.h()},l(p){e=k(p,"DIV",{class:!0});var g=N(e);t=k(g,"DIV",{class:!0});var y=N(t);for(let v=0;v<l.length;v+=1)l[v].l(y);y.forEach(I),n=K(g),o=k(g,"DIV",{class:!0});var w=N(o);s&&s.l(w),w.forEach(I),g.forEach(I),this.h()},h(){f(t,"class","grow-0 shrink-0 flex flex-row w-full border-b border-solid border-neutral-700 overflow-x-hidden overflow-y-auto"),f(o,"class","grow-1 shrink-1 w-full h-full overflow-hidden"),f(e,"class","grow-1 shrink-1 flex flex-col w-full h-full overflow-hidden")},m(p,g){F(p,e,g),E(e,t);for(let y=0;y<l.length;y+=1)l[y].m(t,null);E(e,n),E(e,o),~r&&h[r].m(o,null),u=!0},p(p,[g]){if(g&7){a=p[1];let w;for(w=0;w<a.length;w+=1){const v=Ei(p,a,w);l[w]?l[w].p(v,g):(l[w]=Ni(v),l[w].c(),l[w].m(t,null))}for(;w<l.length;w+=1)l[w].d(1);l.length=a.length}let y=r;r=c(p),r!==y&&(s&&(ye(),V(h[y],1,1,()=>{h[y]=null}),ve()),~r?(s=h[r],s||(s=h[r]=d[r](p),s.c()),P(s,1),s.m(o,null)):s=null)},i(p){u||(P(s),u=!0)},o(p){V(s),u=!1},d(p){p&&I(e),Ue(l,p),~r&&h[r].d()}}}function js(i,e,t){let n=["Prefabs","Animations","Sounds"],o="Animations";function r(u){t(0,o=u)}return[o,n,r,u=>r(u)]}class qs extends J{constructor(e){super(),ee(this,e,js,Xs,te,{})}}const Hs={name:"BlankScript",nodes:[],edges:[]},Ks={name:"TopDownMove",nodes:[{type:"OnTick",internalValues:[]},{type:"Subtract",internalValues:[]},{type:"Subtract",internalValues:[]},{type:"Vec2",internalValues:[]},{type:"Normalize",internalValues:[]},{type:"Mux2",internalValues:[]},{type:"ScaleVec2",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"SetEntityVelocity",internalValues:[]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRun","Shift"]},{type:"ExportInt",internalValues:["speedWalk",5]},{type:"ExportInt",internalValues:["speedRun",10]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRight","D"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyLeft","A"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyDown","S"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyUp","W"]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:9},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:13},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:15},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:17},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:19}]},{in:[{outputIndex:2,inputIndex:0,outputNode:13,inputNode:1},{outputIndex:2,inputIndex:1,outputNode:15,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:3}]},{in:[{outputIndex:2,inputIndex:1,outputNode:17,inputNode:2},{outputIndex:2,inputIndex:0,outputNode:19,inputNode:2}],out:[{outputIndex:0,inputIndex:1,outputNode:2,inputNode:3}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:3},{outputIndex:0,inputIndex:1,outputNode:2,inputNode:3}],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:4}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:4}],out:[{outputIndex:0,inputIndex:0,outputNode:4,inputNode:6}]},{in:[{outputIndex:2,inputIndex:0,outputNode:9,inputNode:5},{outputIndex:0,inputIndex:1,outputNode:11,inputNode:5},{outputIndex:0,inputIndex:2,outputNode:12,inputNode:5}],out:[{outputIndex:0,inputIndex:1,outputNode:5,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:4,inputNode:6},{outputIndex:0,inputIndex:1,outputNode:5,inputNode:6}],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}],out:[]},{in:[{outputIndex:0,inputIndex:0,outputNode:10,inputNode:9},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:9}],out:[{outputIndex:2,inputIndex:0,outputNode:9,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:10,inputNode:9}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:11,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:2,outputNode:12,inputNode:5}]},{in:[{outputIndex:0,inputIndex:0,outputNode:14,inputNode:13},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:13}],out:[{outputIndex:2,inputIndex:0,outputNode:13,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:14,inputNode:13}]},{in:[{outputIndex:0,inputIndex:0,outputNode:16,inputNode:15},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:15}],out:[{outputIndex:2,inputIndex:1,outputNode:15,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:16,inputNode:15}]},{in:[{outputIndex:0,inputIndex:0,outputNode:18,inputNode:17},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:17}],out:[{outputIndex:2,inputIndex:1,outputNode:17,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:18,inputNode:17}]},{in:[{outputIndex:0,inputIndex:0,outputNode:20,inputNode:19},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:19}],out:[{outputIndex:2,inputIndex:0,outputNode:19,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:20,inputNode:19}]}]},Zs={name:"PlatformerMove",nodes:[{type:"OnTick",internalValues:[]},{type:"Subtract",internalValues:[]},{type:"Mux2",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRun","Shift"]},{type:"ExportInt",internalValues:["speedWalk",5]},{type:"ExportInt",internalValues:["speedRun",10]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRight","D"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyLeft","A"]},{type:"SetEntityVelocityX",internalValues:[]},{type:"Multiply",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:8},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:10}]},{in:[{outputIndex:2,inputIndex:0,outputNode:8,inputNode:1},{outputIndex:2,inputIndex:1,outputNode:10,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:13}]},{in:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:2},{outputIndex:0,inputIndex:2,outputNode:7,inputNode:2}],out:[{outputIndex:0,inputIndex:1,outputNode:2,inputNode:13}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:12}]},{in:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:4}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:2,outputNode:7,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:9,inputNode:8},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:8}],out:[{outputIndex:2,inputIndex:0,outputNode:8,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:9,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:11,inputNode:10},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:10}],out:[{outputIndex:2,inputIndex:1,outputNode:10,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:11,inputNode:10}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:12},{outputIndex:0,inputIndex:1,outputNode:13,inputNode:12}],out:[]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:13},{outputIndex:0,inputIndex:1,outputNode:2,inputNode:13}],out:[{outputIndex:0,inputIndex:1,outputNode:13,inputNode:12}]}]},$s={name:"PlatformerMove2",nodes:[{type:"OnTick",internalValues:[]},{type:"Subtract",internalValues:[]},{type:"Mux2",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRun","Shift"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyRight","D"]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["keyLeft","A"]},{type:"Multiply",internalValues:[]},{type:"ApplyEntityForce",internalValues:[]},{type:"Vec2",internalValues:[]},{type:"ConstInt",internalValues:[0]},{type:"ExportFloat",internalValues:["speedWalk",.1]},{type:"ExportFloat",internalValues:["speedRun",.2]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:6},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:8}]},{in:[{outputIndex:2,inputIndex:0,outputNode:6,inputNode:1},{outputIndex:2,inputIndex:1,outputNode:8,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:10}]},{in:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2},{outputIndex:0,inputIndex:1,outputNode:14,inputNode:2},{outputIndex:0,inputIndex:2,outputNode:15,inputNode:2}],out:[{outputIndex:0,inputIndex:1,outputNode:2,inputNode:10}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:11}]},{in:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:4}]},{in:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:6},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:6}],out:[{outputIndex:2,inputIndex:0,outputNode:6,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:9,inputNode:8},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:8}],out:[{outputIndex:2,inputIndex:1,outputNode:8,inputNode:1}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:9,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:10},{outputIndex:0,inputIndex:1,outputNode:2,inputNode:10}],out:[{outputIndex:0,inputIndex:0,outputNode:10,inputNode:12}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:11},{outputIndex:0,inputIndex:1,outputNode:12,inputNode:11}],out:[]},{in:[{outputIndex:0,inputIndex:0,outputNode:10,inputNode:12},{outputIndex:0,inputIndex:1,outputNode:13,inputNode:12}],out:[{outputIndex:0,inputIndex:1,outputNode:12,inputNode:11}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:13,inputNode:12}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:14,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:2,outputNode:15,inputNode:2}]}]},Js={name:"PlatformerJump",nodes:[{type:"Vec2",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ApplyEntityForce",internalValues:[]},{type:"ConstInt",internalValues:[0]},{type:"ExportFloat",internalValues:["jumpHeight",1]},{type:"OnSwitch",internalValues:[]},{type:"ConstVec2",internalValues:[0,1]},{type:"OnCollide",internalValues:[]},{type:"Vec2Equals",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportState",internalValues:["landState","default"]},{type:"SetEntityState",internalValues:[]}],edges:[{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:0},{outputIndex:0,inputIndex:1,outputNode:4,inputNode:0},{outputIndex:-1,inputIndex:-1,outputNode:5,inputNode:0}],out:[{outputIndex:0,inputIndex:1,outputNode:0,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2},{outputIndex:0,inputIndex:1,outputNode:0,inputNode:2}],out:[]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:0}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:0}]},{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:5,inputNode:0}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}],out:[{outputIndex:0,inputIndex:-1,outputNode:8,inputNode:11}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:9,inputNode:11}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:10,inputNode:11}]},{in:[{outputIndex:0,inputIndex:-1,outputNode:8,inputNode:11},{outputIndex:0,inputIndex:0,outputNode:9,inputNode:11},{outputIndex:0,inputIndex:1,outputNode:10,inputNode:11}],out:[]}]},eu={name:"ChangeStateOnKey",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"VarKeyPressed",internalValues:[]},{type:"ExportKey",internalValues:["key","A"]},{type:"ExportState",internalValues:["state","default"]},{type:"SetEntityState",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:2},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:2}],out:[{outputIndex:0,inputIndex:-1,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:5}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5},{outputIndex:0,inputIndex:-1,outputNode:2,inputNode:5},{outputIndex:0,inputIndex:1,outputNode:4,inputNode:5}],out:[]}]},tu={name:"MaxSpeedX",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"SetEntityVelocityX",internalValues:[]},{type:"ExportFloat",internalValues:["maxSpeed",5]},{type:"Vec2Components",internalValues:[]},{type:"Clamp",internalValues:[]},{type:"Negative",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:5},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:6}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:4}]},{in:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:4},{outputIndex:0,inputIndex:0,outputNode:3,inputNode:4}],out:[]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:5}],out:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:8},{outputIndex:0,inputIndex:2,outputNode:5,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:6}],out:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:8,inputNode:7},{outputIndex:0,inputIndex:2,outputNode:5,inputNode:7}],out:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:4}]},{in:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:8}],out:[{outputIndex:0,inputIndex:1,outputNode:8,inputNode:7}]}]},nu={name:"MaxSpeedY",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportFloat",internalValues:["maxSpeed",5]},{type:"Vec2Components",internalValues:[]},{type:"Clamp",internalValues:[]},{type:"Negative",internalValues:[]},{type:"SetEntityVelocityY",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:8}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:0,inputIndex:0,outputNode:4,inputNode:7},{outputIndex:0,inputIndex:2,outputNode:4,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}],out:[{outputIndex:1,inputIndex:0,outputNode:5,inputNode:6}]},{in:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6},{outputIndex:0,inputIndex:2,outputNode:4,inputNode:6},{outputIndex:1,inputIndex:0,outputNode:5,inputNode:6}],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:4,inputNode:7}],out:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:8},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:8}],out:[]}]},iu={name:"MinVelocityX",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportFloat",internalValues:["minVelocity",-5]},{type:"Vec2Components",internalValues:[]},{type:"Max",internalValues:[]},{type:"SetEntityVelocityX",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:7}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}],out:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:6}]},{in:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:6},{outputIndex:0,inputIndex:0,outputNode:5,inputNode:6}],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:7}],out:[]}]},ou={name:"MaxVelocityX",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportFloat",internalValues:["maxVelocity",5]},{type:"Vec2Components",internalValues:[]},{type:"Min",internalValues:[]},{type:"SetEntityVelocityX",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:7}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:6}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}],out:[{outputIndex:0,inputIndex:0,outputNode:5,inputNode:6}]},{in:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:6},{outputIndex:0,inputIndex:0,outputNode:5,inputNode:6}],out:[{outputIndex:0,inputIndex:1,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:6,inputNode:7}],out:[]}]},ru={name:"MinVelocityY",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportFloat",internalValues:["minVelocity",-5]},{type:"Vec2Components",internalValues:[]},{type:"SetEntityVelocityY",internalValues:[]},{type:"Max",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:6}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}],out:[{outputIndex:1,inputIndex:0,outputNode:5,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:6},{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6}],out:[]},{in:[{outputIndex:1,inputIndex:0,outputNode:5,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:4,inputNode:7}],out:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6}]}]},su={name:"MaxVelocityY",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"ExportFloat",internalValues:["maxVelocity",5]},{type:"Vec2Components",internalValues:[]},{type:"SetEntityVelocityY",internalValues:[]},{type:"Min",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:6}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:4}],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:5}],out:[{outputIndex:1,inputIndex:0,outputNode:5,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:3,inputNode:6},{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6}],out:[]},{in:[{outputIndex:1,inputIndex:0,outputNode:5,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:4,inputNode:7}],out:[{outputIndex:0,inputIndex:1,outputNode:7,inputNode:6}]}]},uu={name:"HitWall",nodes:[{type:"OnCollide",internalValues:[]},{type:"Vec2Components",internalValues:[]},{type:"NOT",internalValues:[]},{type:"AND",internalValues:[]},{type:"__debug",internalValues:["hit"]},{type:"EqualsConst",internalValues:[0]},{type:"EqualsConst",internalValues:[0]}],edges:[{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}]},{in:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}],out:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:6},{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5}]},{in:[{outputIndex:2,inputIndex:0,outputNode:5,inputNode:2}],out:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3}]},{in:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3},{outputIndex:2,inputIndex:1,outputNode:6,inputNode:3}],out:[{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:4}]},{in:[{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:4}],out:[]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5}],out:[{outputIndex:2,inputIndex:0,outputNode:5,inputNode:2}]},{in:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:6}],out:[{outputIndex:2,inputIndex:1,outputNode:6,inputNode:3}]}]},lu={name:"BounceWall",nodes:[{type:"OnCollide",internalValues:[]},{type:"Vec2Components",internalValues:[]},{type:"NOT",internalValues:[]},{type:"AND",internalValues:[]},{type:"EqualsConst",internalValues:[0]},{type:"EqualsConst",internalValues:[0]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityVelocity",internalValues:[]},{type:"Vec2Components",internalValues:[]},{type:"Negative",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"SetEntityVelocityX",internalValues:[]}],edges:[{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}]},{in:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}],out:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:5},{outputIndex:0,inputIndex:0,outputNode:1,inputNode:4}]},{in:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}],out:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3}]},{in:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3},{outputIndex:2,inputIndex:1,outputNode:5,inputNode:3}],out:[{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:4}],out:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}]},{in:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:5}],out:[{outputIndex:2,inputIndex:1,outputNode:5,inputNode:3}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7},{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:7}],out:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8}]},{in:[{outputIndex:0,inputIndex:0,outputNode:7,inputNode:8}],out:[{outputIndex:0,inputIndex:0,outputNode:8,inputNode:9}]},{in:[{outputIndex:0,inputIndex:0,outputNode:8,inputNode:9}],out:[{outputIndex:0,inputIndex:1,outputNode:9,inputNode:11}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:10,inputNode:11}]},{in:[{outputIndex:0,inputIndex:1,outputNode:9,inputNode:11},{outputIndex:0,inputIndex:0,outputNode:10,inputNode:11}],out:[]}]},au={name:"GoombaMove",nodes:[{type:"OnTick",internalValues:[]},{type:"ExportFloat",internalValues:["velocityX",3]},{type:"GetControlledEntity",internalValues:[]},{type:"SetEntityVelocityX",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:1}],out:[{outputIndex:0,inputIndex:1,outputNode:1,inputNode:3}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:3}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:3},{outputIndex:0,inputIndex:1,outputNode:1,inputNode:3}],out:[]}]},du={name:"ChangeStateOnHitWall",nodes:[{type:"OnCollide",internalValues:[]},{type:"Vec2Components",internalValues:[]},{type:"NOT",internalValues:[]},{type:"AND",internalValues:[]},{type:"EqualsConst",internalValues:[0]},{type:"EqualsConst",internalValues:[0]},{type:"GetControlledEntity",internalValues:[]},{type:"SetEntityState",internalValues:[]},{type:"ExportState",internalValues:["state","moveLeft"]}],edges:[{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}]},{in:[{outputIndex:0,inputIndex:0,outputNode:0,inputNode:1}],out:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:5},{outputIndex:0,inputIndex:0,outputNode:1,inputNode:4}]},{in:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}],out:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3}]},{in:[{outputIndex:2,inputIndex:0,outputNode:2,inputNode:3},{outputIndex:2,inputIndex:1,outputNode:5,inputNode:3}],out:[{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:4}],out:[{outputIndex:2,inputIndex:0,outputNode:4,inputNode:2}]},{in:[{outputIndex:1,inputIndex:0,outputNode:1,inputNode:5}],out:[{outputIndex:2,inputIndex:1,outputNode:5,inputNode:3}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:7},{outputIndex:0,inputIndex:-1,outputNode:3,inputNode:7},{outputIndex:0,inputIndex:1,outputNode:8,inputNode:7}],out:[]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:8,inputNode:7}]}]},cu={name:"CameraFollow",nodes:[{type:"OnTick",internalValues:[]},{type:"GetControlledEntity",internalValues:[]},{type:"GetEntityPosition",internalValues:[]},{type:"SetCameraPosition",internalValues:[]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:2}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:2},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:3}]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:3}],out:[]}]},hu={name:"OnMouseScrollY",nodes:[{type:"OnTick",internalValues:[]},{type:"MouseScroll",internalValues:[]},{type:"ConstVec2",internalValues:[0,1]},{type:"Vec2Equals",internalValues:[]},{type:"ConstVec2",internalValues:[0,-1]},{type:"Vec2Equals",internalValues:[]},{type:"OR",internalValues:[]},{type:"__debug",internalValues:["debug"]}],edges:[{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:3},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:3},{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:2,inputNode:3}]},{in:[{outputIndex:0,inputIndex:0,outputNode:1,inputNode:3},{outputIndex:0,inputIndex:1,outputNode:2,inputNode:3},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:3}],out:[{outputIndex:2,inputIndex:0,outputNode:3,inputNode:6}]},{in:[],out:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:5}]},{in:[{outputIndex:0,inputIndex:1,outputNode:4,inputNode:5},{outputIndex:0,inputIndex:0,outputNode:1,inputNode:5},{outputIndex:-1,inputIndex:-1,outputNode:0,inputNode:5}],out:[{outputIndex:2,inputIndex:1,outputNode:5,inputNode:6}]},{in:[{outputIndex:2,inputIndex:0,outputNode:3,inputNode:6},{outputIndex:2,inputIndex:1,outputNode:5,inputNode:6}],out:[{outputIndex:0,inputIndex:-1,outputNode:6,inputNode:7}]},{in:[{outputIndex:0,inputIndex:-1,outputNode:6,inputNode:7}],out:[]}]},pu={name:"SetAnimationFromVelocityX",nodes:[{type:"IsZero",internalValues:[]},{type:"OnRender",internalValues:[]},{type:"LessConst",internalValues:[0]},{type:"SetControlledEntityAnimationConst",internalValues:[4]},{type:"SetControlledEntityAnimationConst",internalValues:[3]},{type:"SetControlledEntityAnimationConst",internalValues:[5]},{type:"GetControlledEntityVelocityX",internalValues:[]}],edges:[{in:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:0}],out:[{outputIndex:1,inputIndex:-1,outputNode:0,inputNode:2},{outputIndex:0,inputIndex:-1,outputNode:0,inputNode:3}]},{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:1,inputNode:6}]},{in:[{outputIndex:1,inputIndex:-1,outputNode:0,inputNode:2},{outputIndex:0,inputIndex:0,outputNode:6,inputNode:2}],out:[{outputIndex:1,inputIndex:-1,outputNode:2,inputNode:5},{outputIndex:0,inputIndex:-1,outputNode:2,inputNode:4}]},{in:[{outputIndex:0,inputIndex:-1,outputNode:0,inputNode:3}],out:[]},{in:[{outputIndex:0,inputIndex:-1,outputNode:2,inputNode:4}],out:[]},{in:[{outputIndex:1,inputIndex:-1,outputNode:2,inputNode:5}],out:[]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:1,inputNode:6}],out:[{outputIndex:0,inputIndex:0,outputNode:6,inputNode:0},{outputIndex:0,inputIndex:0,outputNode:6,inputNode:2}]}]},fu={name:"SetAnimationFromVelocityX2",nodes:[{type:"IsZero",internalValues:[]},{type:"OnRender",internalValues:[]},{type:"ControlledVelX",internalValues:[]},{type:"SetControlledAnimation#",internalValues:[4]},{type:"SetControlledAnimation#",internalValues:[3]},{type:"SetControlledAnimation#",internalValues:[5]},{type:"Less#",internalValues:[0]}],edges:[{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:0}],out:[{outputIndex:0,inputIndex:-1,outputNode:0,inputNode:3},{outputIndex:1,inputIndex:-1,outputNode:0,inputNode:6}]},{in:[],out:[{outputIndex:-1,inputIndex:-1,outputNode:1,inputNode:2}]},{in:[{outputIndex:-1,inputIndex:-1,outputNode:1,inputNode:2}],out:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:0},{outputIndex:0,inputIndex:0,outputNode:2,inputNode:6}]},{in:[{outputIndex:0,inputIndex:-1,outputNode:0,inputNode:3}],out:[]},{in:[{outputIndex:0,inputIndex:-1,outputNode:6,inputNode:4}],out:[]},{in:[{outputIndex:1,inputIndex:-1,outputNode:6,inputNode:5}],out:[]},{in:[{outputIndex:0,inputIndex:0,outputNode:2,inputNode:6},{outputIndex:1,inputIndex:-1,outputNode:0,inputNode:6}],out:[{outputIndex:0,inputIndex:-1,outputNode:6,inputNode:4},{outputIndex:1,inputIndex:-1,outputNode:6,inputNode:5}]}]};class we{constructor(e,t){this.name=t.name,this.description=e,this.script=t}}const Si=new we("Create a custom script from scratch",Hs),On=O.alphabetSort([new we("Changes to a new state when a key is pressed",eu),new we("Jumps",Js),new we("Moves your character with AD",Zs),new we("Moves your character with AD",$s),new we("Moves your character with WASD",Ks),new we("Sets maximum x-axis speed",tu),new we("Sets maximum y-axis speed",nu),new we("Sets maximum left x-axis velocity",iu),new we("Sets maximum right x-axis velocity",ou),new we("Sets maximum downward y-axis velocity",ru),new we("Sets maximum upward y-axis velocity",su),new we("Does something when a wall is hit",uu),new we("Bounces when a wall is hit",lu),new we("Moves like a goomba",au),new we("Changes to given state when a wall is hit",du),new we("Makes the camera follow this entity",cu),new we("Runs when the mouse wheel is scrolled up or down",hu),new we("Sets animation based on x velocity",pu),new we("Sets animation based on x velocity",fu)]),gu=Fo(function(){this.field("name"),this.field("description"),this.ref("id"),On.forEach((i,e)=>{this.add({id:e,name:i.name,description:i.description})})});function mu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0});var o=N(e);t=le(o,"path",{d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"d","M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20"),f(e,"fill","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class yu extends J{constructor(e){super(),ee(this,e,null,mu,te,{})}}function Ci(i,e,t){const n=i.slice();return n[12]=e[t],n[14]=t,n}function ki(i){let e,t,n,o,r,s;n=new yu({});function u(){return i[9](i[12])}return{c(){e=C("button"),t=C("div"),G(n.$$.fragment),this.h()},l(a){e=k(a,"BUTTON",{class:!0});var l=N(e);t=k(l,"DIV",{class:!0});var d=N(t);X(n.$$.fragment,d),d.forEach(I),l.forEach(I),this.h()},h(){f(t,"class","w-5 h-5"),f(e,"class","flex grow-0 shrink-0 p-1 items-center justify-center rounded-md bg-emerald-700 hover:bg-emerald-600 transition-all")},m(a,l){F(a,e,l),E(e,t),j(n,t,null),o=!0,r||(s=B(e,"click",u),r=!0)},p(a,l){i=a},i(a){o||(P(n.$$.fragment,a),o=!0)},o(a){V(n.$$.fragment,a),o=!1},d(a){a&&I(e),q(n),r=!1,s()}}}function Di(i){let e,t,n=i[12].name+"",o,r,s,u,a,l,d,h=i[4]===i[12]&&ki(i);function c(){return i[10](i[12])}function p(){return i[11](i[12])}return{c(){e=C("button"),t=C("div"),o=pe(n),r=H(),h&&h.c(),s=H(),this.h()},l(g){e=k(g,"BUTTON",{class:!0});var y=N(e);t=k(y,"DIV",{class:!0});var w=N(t);o=fe(w,n),w.forEach(I),r=K(y),h&&h.l(y),s=K(y),y.forEach(I),this.h()},h(){f(t,"class","grow-1 shrink-1 w-full overflow-hidden whitespace-nowrap text-ellipsis"),f(e,"class",u=`grow-0 shrink-0 flex flex-row items-center justify-center p-2 cursor-pointer focus:bg-neutral-700 transition-all outline-0 text-left h-12 ${i[12]===i[3]?"bg-neutral-700":"hover:bg-neutral-800"} ${i[14]<i[2].length-1?"border-b border-solid border-neutral-700":""}`)},m(g,y){F(g,e,y),E(e,t),E(t,o),E(e,r),h&&h.m(e,null),E(e,s),a=!0,l||(d=[B(e,"mouseenter",c),B(e,"mouseleave",i[7]),B(e,"click",p)],l=!0)},p(g,y){i=g,(!a||y&4)&&n!==(n=i[12].name+"")&&We(o,n),i[4]===i[12]?h?(h.p(i,y),y&20&&P(h,1)):(h=ki(i),h.c(),P(h,1),h.m(e,s)):h&&(ye(),V(h,1,1,()=>{h=null}),ve()),(!a||y&12&&u!==(u=`grow-0 shrink-0 flex flex-row items-center justify-center p-2 cursor-pointer focus:bg-neutral-700 transition-all outline-0 text-left h-12 ${i[12]===i[3]?"bg-neutral-700":"hover:bg-neutral-800"} ${i[14]<i[2].length-1?"border-b border-solid border-neutral-700":""}`))&&f(e,"class",u)},i(g){a||(P(h),a=!0)},o(g){V(h),a=!1},d(g){g&&I(e),h&&h.d(),l=!1,Ee(d)}}}function Pi(i){let e,t=i[3].name+"",n,o,r,s=i[3].description+"",u;return{c(){e=C("div"),n=pe(t),o=H(),r=C("div"),u=pe(s),this.h()},l(a){e=k(a,"DIV",{class:!0});var l=N(e);n=fe(l,t),l.forEach(I),o=K(a),r=k(a,"DIV",{class:!0});var d=N(r);u=fe(d,s),d.forEach(I),this.h()},h(){f(e,"class","grow-1 shrink-1 w-full font-bold text-2xl overflow-hidden whitespace-nowrap text-ellipsis"),f(r,"class","grow-1 shrink-1 w-full h-full overflow-hidden text-ellipsis mt-4")},m(a,l){F(a,e,l),E(e,n),F(a,o,l),F(a,r,l),E(r,u)},p(a,l){l&8&&t!==(t=a[3].name+"")&&We(n,t),l&8&&s!==(s=a[3].description+"")&&We(u,s)},d(a){a&&I(e),a&&I(o),a&&I(r)}}}function vu(i){let e,t,n,o,r,s,u,a,l,d,h,c,p,g,y;u=new Jn({});let w=i[2],v=[];for(let _=0;_<w.length;_+=1)v[_]=Di(Ci(i,w,_));const x=_=>V(v[_],1,1,()=>{v[_]=null});let m=i[3]&&Pi(i);return{c(){e=C("div"),t=C("div"),n=C("input"),o=H(),r=C("div"),s=C("div"),G(u.$$.fragment),a=H(),l=C("div"),d=C("div");for(let _=0;_<v.length;_+=1)v[_].c();h=H(),c=C("div"),m&&m.c(),this.h()},l(_){e=k(_,"DIV",{class:!0});var b=N(e);t=k(b,"DIV",{class:!0});var S=N(t);n=k(S,"INPUT",{placeholder:!0,class:!0}),o=K(S),r=k(S,"DIV",{class:!0});var A=N(r);s=k(A,"DIV",{class:!0});var T=N(s);X(u.$$.fragment,T),T.forEach(I),A.forEach(I),S.forEach(I),a=K(b),l=k(b,"DIV",{class:!0});var L=N(l);d=k(L,"DIV",{class:!0});var oe=N(d);for(let M=0;M<v.length;M+=1)v[M].l(oe);oe.forEach(I),h=K(L),c=k(L,"DIV",{class:!0});var ie=N(c);m&&m.l(ie),ie.forEach(I),L.forEach(I),b.forEach(I),this.h()},h(){f(n,"placeholder","Search..."),f(n,"class","grow-1 shrink-1 p-2 pl-8 w-full min-w-0 border-0 outline-none bg-neutral-900"),f(s,"class","w-5 h-5"),f(r,"class","absolute w-8 h-10 flex items-center justify-center text-neutral-500 pointer-events-none"),f(t,"class","grow-0 shrink-0 flex flex-row border-b border-solid border-neutral-700 h-10"),f(d,"class","grow-0 shrink-0 flex flex-col w-full max-w-[256px] h-full border-r border-solid border-neutral-700 overflow-x-hidden overflow-y-auto"),f(c,"class","grow-1 shrink-1 flex flex-col w-full h-full p-4 overflow-hidden"),f(l,"class","grow-1 shrink-1 flex flex-row w-full h-full overflow-hidden"),f(e,"class","flex flex-col w-full h-full overflow-hidden")},m(_,b){F(_,e,b),E(e,t),E(t,n),Ae(n,i[1]),E(t,o),E(t,r),E(r,s),j(u,s,null),E(e,a),E(e,l),E(l,d);for(let S=0;S<v.length;S+=1)v[S].m(d,null);E(l,h),E(l,c),m&&m.m(c,null),p=!0,g||(y=B(n,"input",i[8]),g=!0)},p(_,[b]){if(b&2&&n.value!==_[1]&&Ae(n,_[1]),b&253){w=_[2];let S;for(S=0;S<w.length;S+=1){const A=Ci(_,w,S);v[S]?(v[S].p(A,b),P(v[S],1)):(v[S]=Di(A),v[S].c(),P(v[S],1),v[S].m(d,null))}for(ye(),S=w.length;S<v.length;S+=1)x(S);ve()}_[3]?m?m.p(_,b):(m=Pi(_),m.c(),m.m(c,null)):m&&(m.d(1),m=null)},i(_){if(!p){P(u.$$.fragment,_);for(let b=0;b<w.length;b+=1)P(v[b]);p=!0}},o(_){V(u.$$.fragment,_),v=v.filter(Boolean);for(let b=0;b<v.length;b+=1)V(v[b]);p=!1},d(_){_&&I(e),q(u),Ue(v,_),m&&m.d(),g=!1,y()}}}function xu(i,e,t){let{onUseScript:n=void 0}=e,o="",r=null,s=null,u=null;function a(y){t(3,s=y)}function l(y){t(4,u=y)}function d(){t(4,u=null)}function h(){o=this.value,t(1,o)}const c=y=>n(y),p=y=>l(y),g=y=>a(y);return i.$$set=y=>{"onUseScript"in y&&t(0,n=y.onUseScript)},i.$$.update=()=>{if(i.$$.dirty&14){const y=o.trim();if(y.length>=3){t(2,r=[Si]);for(const w of gu.search(y))r.push(On[parseInt(w.ref)]);r.indexOf(s)===-1&&(r.length>0?t(3,s=r[0]):t(3,s=null))}else t(2,r=[Si,...On]),s===null&&t(3,s=r[0])}},[n,o,r,s,u,a,l,d,h,c,p,g]}class wu extends J{constructor(e){super(),ee(this,e,xu,vu,te,{onUseScript:0})}}class Wo{constructor(e,t){this.lineWidth=e,this.colors=t,this.hovered=!1,this.selected=!1}select(){this.selected=!0}deselect(){this.hovered=!1,this.selected=!1}draw(e){}}const _u=[2,4],Iu={entity:{shadow:"#0007",node:"#262626",title:"#262626",outline:["#737373","#d4d4d4"]},event:{shadow:"#0007",node:"#262626",title:"#262626",outline:["#737373","#d4d4d4"]},input:{shadow:"#0007",node:"#262626",title:"#262626",outline:["#737373","#d4d4d4"]},logic:{shadow:"#0007",node:"#262626",title:"#262626",outline:["#737373","#d4d4d4"]},math:{shadow:"#0007",node:"#262626",title:"#262626",outline:["#737373","#d4d4d4"]}},Ce="-apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, helvetica, Cantarell, Ubuntu, roboto, noto, arial, sans-serif",Xt=32,Me=32,$t=12,Ze=$t*2,$e=10,bu=48,Eu=16;class Nu extends Wo{constructor(e,t){super(_u,Iu[t.category]),this.node=t,this.x=0,this.y=0,this.nameHeight=0,this.w=0,this.h=0,this.portHeight=0,this.maxPortCount=0,this.hoveredPort=-1,this.maxInputWidth=0,this.maxInternalWidth=0,this.maxOutputWidth=0,this.init(e)}computeNodeWidth(e){let t=e.textMetrics(this.node.debugName,Ce,Xt);const{inputPorts:n,outputPorts:o,internalPorts:r}=this.node.data;this.maxInputWidth=0,this.maxInternalWidth=0,this.maxOutputWidth=0;for(var s=0;s<Math.max(n.length,o.length,r.length);s++)s<n.length&&(this.maxInputWidth=Math.max(this.maxInputWidth,e.textMetrics(n[s].name,Ce,Me).width+Ze)),s<o.length&&(this.maxOutputWidth=Math.max(this.maxOutputWidth,e.textMetrics(o[s].name,Ce,Me).width+Ze)),s<r.length&&(this.maxInternalWidth=Math.max(this.maxInternalWidth,e.textMetrics(`${r[s].name}: ${this.getInternalValueDisplayStr(s)}`,Ce,Me).width+Ze));this.w=Math.max(this.maxInputWidth+this.maxInternalWidth+this.maxOutputWidth,Math.ceil(t.width))+bu}init(e){let t=e.textMetrics("XXX",Ce,Xt);this.nameHeight=(t.actualBoundingBoxDescent+t.actualBoundingBoxAscent)*2,this.computeNodeWidth(e),t=e.textMetrics("XXX",Ce,Me),this.portHeight=(t.actualBoundingBoxDescent+t.actualBoundingBoxAscent)*2,this.maxPortCount=Math.max(this.node.data.outputPorts.length,this.node.inputTypes.length,this.node.internalValues.length),this.maxPortCount?this.h=this.nameHeight+this.portHeight*this.maxPortCount+Eu:this.h=this.nameHeight}draw(e,t,n){const o=this.x,r=this.y,s=~~(this.selected||this.hovered);t.drawRect(o,r,this.w,this.h,this.colors.node),t.drawRect(o,r,this.w,this.nameHeight,this.colors.title);const u=this.lineWidth[s]/Math.min(n,1);this.maxPortCount&&t.drawLine(o,r+this.nameHeight,o+this.w,r+this.nameHeight,"#737373",this.lineWidth[0]/2),t.strokeTransparentRect(o,r,this.w,this.h,this.colors.outline[s],u/2,s?e.outlineAlpha.getValue():1),t.drawCenteredText(this.node.debugName,o+this.w/2,r+this.nameHeight/2,Ce,Xt,"#f9fafb"),this.node.data.inputPorts.forEach((a,l)=>{const d=this.getPortBaseY()+l*this.portHeight+$e;t.drawArc(o-2,d,$t,-Math.PI/2,Math.PI/2,xe[a.typename].dot),t.drawVerticalCenteredText(a.name,o+Ze,d,Ce,Me,xe[a.typename].name)}),this.node.data.outputPorts.forEach((a,l)=>{const d=this.getPortBaseY()+l*this.portHeight+$e;t.drawArc(o+this.w+2,d,$t,Math.PI/2,-Math.PI/2,xe[a.typename].dot);const h=t.textMetrics(a.name,Ce,Me).width;t.drawVerticalCenteredText(a.name,o+this.w-h-Ze,d,Ce,Me,xe[a.typename].name)}),this.node.data.internalPorts.forEach((a,l)=>{const d=this.getInternalValueDisplayStr(l),h=this.getPortBaseY()+l*this.portHeight+$e,c=o+Ze+this.maxInputWidth,p=t.textMetrics(`${a.name}: ${d}`,Ce,Me).width;if(t.drawRect(c-$e/2,h-this.portHeight/2,p+$e,this.portHeight,"#171717"),t.strokeTransparentRect(c-$e/2,h-this.portHeight/2,p+$e,this.portHeight,this.colors.outline[s],u/2,s?e.outlineAlpha.getValue():1),t.drawVerticalCenteredText(`${a.name}: ${d}`,c,h,Ce,Me,xe[a.typename].name),l===this.hoveredPort){const g=c+t.textMetrics(`${a.name}: `,Ce,Me).width,y=t.textMetrics(d,Ce,Me).width,w=h+this.portHeight/4;t.drawLine(g,w,g+y,w,xe[a.typename].name,1)}})}getInternalValueDisplayStr(e){return this.node.data.internalPorts[e].editorTypename==="key"?O.keyToDisplayStr(this.node.internalValues[e]):this.node.internalValues[e]}getPortBaseY(){return this.y+this.nameHeight+this.portHeight/2}getInternalPortCoords(e,t){const n=this.x+Ze+t.textMetrics(`${this.node.data.internalPorts[e].name}: `,Ce,Me).width,o=this.getPortBaseY()+this.portHeight*e+$e-this.portHeight/2;return{x:n,y:o}}getInPortCoords(e){let t=0;return e===-1?t=this.y+this.nameHeight/2:t=this.getPortBaseY()+this.portHeight*e+$e,{x:this.x,y:t}}getOutPortCoords(e){let t=0;return e===-1?t=this.y+this.nameHeight/2:t=this.getPortBaseY()+this.portHeight*e+$e,{x:this.x+this.w,y:t}}checkPortIntersection(e,t,n){const o=e.textMetrics(this.node.debugName,Ce,Xt).width;if(O.rectIntersect(t,n,this.x+this.w/2-o/2,this.y,o,this.nameHeight))return{undefined:void 0,in:!1,internal:!1,index:-1,proxy:this,node:this.node,color:"#facc15"};const r=this.node.data;let s=this.checkPortIntersectionOn(e,t,n,r.inputPorts,()=>this.x,u=>u.name,!0,!1);return s||(s=this.checkPortIntersectionOn(e,t,n,r.outputPorts,u=>this.x+this.w-u-Ze,u=>u.name,!1,!1),s)||(s=this.checkPortIntersectionOn(e,t,n,r.internalPorts,()=>this.x+Ze+this.maxInputWidth,(u,a)=>`${u.name}: ${this.getInternalValueDisplayStr(a)}`,!1,!0)),s}checkPortIntersectionOn(e,t,n,o,r,s,u,a){const l=this.getPortBaseY();for(let d=0;d<o.length;d++){const h=o[d],c=l+d*this.portHeight,p=e.textMetrics(s(h,d),Ce,Me).width,g=r(p);if(O.rectIntersect(t,n,g,c,p+Ze,2*$t))return{port:h,in:u,internal:a,index:d,proxy:this,node:this.node,color:xe[h.typename].edge}}}}const Su={activationEdge:"#facc15",activationEdgeBlob:"#fef08a",hovered:"#d4d4d4"},Cu=[2,5],_n=[5,10];class Uo extends Wo{constructor(e,t,n,o){super(Cu,Su),this.startProxy=e,this.startPort=t,this.endProxy=n,this.endPort=o}getPortColors(e){let t=this.colors.activationEdge,n=this.colors.activationEdge,o,r;this.startPort!==-1&&(o=this.startProxy.node.data.outputPorts[this.startPort].typename,t=xe[o].edge),this.endPort!==-1&&(r=this.endProxy.node.data.inputPorts[this.endPort].typename,n=xe[r].edge);let s=O.colorMix(r?xe[r].name:this.colors.activationEdgeBlob,o?xe[o].name:this.colors.activationEdgeBlob,e);return{startColor:t,endColor:n,blobColor:s}}draw(e,t){const n=this.getStartCoords(),o=this.getEndCoords(),r=this.hovered||this.selected,[s,u]=t.scaleCoords(n.x,n.y),[a,l]=t.scaleCoords(o.x,o.y),d=5/O.lineLength(s,u,a,l),h=e.edgeBlob.getValue(),c=Math.min(h+d,1),p=(h+c)/2,g=Math.max(0,h-d),y=Math.min(1,c+d),w=p*o.x+(1-p)*n.x,v=p*o.y+(1-p)*n.y,{startColor:x,endColor:m,blobColor:_}=this.getPortColors(h);let b=t.ctx.createLinearGradient(s,u,a,l);const S=O.colorMix(m,x,h),A=O.colorMix(m,x,c);if(b.addColorStop(0,x),b.addColorStop(g,S),b.addColorStop(p,_),b.addColorStop(y,A),b.addColorStop(1,m),r){const T=e.outlineAlpha.getValue(),L=this.lineWidth[~~r];t.drawTransparentLine(n.x,n.y,o.x,o.y,this.colors.hovered,L*2,T),t.setCompositeOperation("destination-out"),t.drawTransparentArc(w,v,_n[1]+L,0,2*Math.PI,this.colors.hovered,1),t.resetCompositeOperation(),t.drawTransparentArc(w,v,_n[1]+L,0,2*Math.PI,this.colors.hovered,T)}t.drawLine(n.x,n.y,o.x,o.y,b,this.lineWidth[~~r]),t.drawArc(w,v,_n[~~r],0,2*Math.PI,_)}getStartCoords(){return this.startProxy.getOutPortCoords(this.startPort)}getEndCoords(){return this.endProxy.getInPortCoords(this.endPort)}}class an{constructor(e,t,n,{step:o,fn:r,reset:s}={}){this.id=Mt(),this.value=e,this.start=e,this.end=t,this.repeatCount=n,this.step=o||1,this.fn=r||(u=>u),this.reset=s!==void 0?s:!1,O.varyingController.addComponent(this)}getValue(){return this.fn(this.value,this)}}const ku=100,jt=50,xe={int:{name:"#f59e0b",dot:"#d97706",edge:"#b45309",editor:{background:"#713f12",foreground:"#fefce8",placeholder:"#fef08a"}},float:{name:"#f59e0b",dot:"#d97706",edge:"#b45309",editor:{background:"#713f12",foreground:"#fefce8",placeholder:"#fef08a"}},number:{name:"#f59e0b",dot:"#d97706",edge:"#b45309",editor:{background:"#713f12",foreground:"#fefce8",placeholder:"#fef08a"}},object:{name:"#22c55e",dot:"#16a34a",edge:"#15803d"},bool:{name:"#0ea5e9",dot:"#0284c7",edge:"#0369a1",editor:{background:"#1e3a8a",foreground:"#f0f9ff",placeholder:"#bae6fd"}},string:{name:"#f43f5e",dot:"#e11d48",edge:"#be123c",editor:{background:"#7f1d1d",foreground:"#fef2f2",placeholder:"#fecaca"}},array:{name:"#e5e7eb",dot:"#d1d5db",edge:"#9ca3af"},any:{name:"#e5e7eb",dot:"#d1d5db",edge:"#9ca3af"}},st=100,ut=100;class Du{constructor(e,t){this.graph=t,this.columns=[],this.proxies=new Map,this.edgeProxies=new Map,this.drawStack=[],this.window=e,this.outlineAlpha=new an(.5,1,-1,{step:.5,fn:n=>n*n*(3-2*n)}),this.outlineColor="#fff",this.edgeBlob=new an(0,1,-1,{step:.25,reset:!0})}recompile(){this.graph.forceCompile(),this.generateProxies()}generateProxies(){this.drawStack=[],this.graph.nodes.forEach(t=>{let n;this.proxies.has(t.id)?n=this.proxies.get(t.id):(n=new Nu(this.window,t),this.proxies.set(t.id,n)),this.drawStack.push(n)}),this.graph.nodes.forEach(t=>{this.graph.edges.get(t.id).out.forEach(n=>{let o;this.edgeProxies.has(n.id)?o=this.edgeProxies.get(n.id):(o=new Uo(this.proxies.get(n.outputNode.id),n.outputIndex,this.proxies.get(n.inputNode.id),n.inputIndex),this.edgeProxies.set(n.id,o))})});const e=new Set;this.proxies.forEach((t,n)=>{if(!this.graph.nodes.has(n))this.proxies.delete(n);else{const o=this.graph.edges.get(n);o.in.forEach(r=>e.add(r.id)),o.out.forEach(r=>e.add(r.id))}}),this.edgeProxies.forEach((t,n)=>{e.has(n)||this.edgeProxies.delete(n)})}drawGrid(e){for(let t=-st/2;t<=st/2;t++)e.drawLine(-st/2*ut,t*ut,st/2*ut,t*ut,"#333");for(let t=-st/2;t<=st/2;t++)e.drawLine(t*ut,-st/2*ut,t*ut,st/2*ut,"#333")}draw(e,t){if(this.drawGrid(e),!this.graph||this.graph.isEmpty())return;this.edgeProxies.forEach(r=>r.draw(this,e));let n=-1;for(var o=0;o<this.drawStack.length-1;o++)this.drawStack[o].selected&&(n=o);if(n!==-1){const[r]=this.drawStack.splice(n,1);this.drawStack.push(r)}this.drawStack.forEach(r=>r.draw(this,e,t))}arrange(){if(!this.graph||this.graph.isEmpty())return;let e=[];{const n=this.graph.compile();this.generateProxies();let o=new Map;n.forEach(s=>{const u=this.graph.getEdges(s).in;let a=0;if(u.length){let l=0;u.forEach(d=>{o.has(d.outputNode.id)||console.log(`Missing ${d.outputNode.debugName}`),l=Math.max(l,o.get(d.outputNode.id))}),a=l+1}e[a]||(e[a]=new Map),e[a].set(s.id,s),o.set(s.id,a)}),n.forEach(s=>{const u=o.get(s.id);if(u!=0)return;const a=this.graph.getEdges(s).out;let l=e.length;a.forEach(h=>{l=Math.min(l,o.get(h.inputNode.id))});const d=l-1;d!=u&&(e[u].delete(s.id),e[d].set(s.id,s),o.set(s.id,d))});let r=[0];for(let s=0;s<e.length;s++){let u=0;e[s].forEach(a=>{u=Math.max(u,this.proxies.get(a.id).w)}),r[s+1]=r[s]+u+ku}this.proxies.forEach(s=>{const u=o.get(s.node.id);s.x=r[u]})}{let n=0;e.forEach(l=>{let d=0;l.forEach(h=>{d+=this.proxies.get(h.id).h}),d+=jt*(l.size-1),n=Math.max(n,d)});const o=e[e.length-1],r=n/(o.size+1);let s=0;o.forEach(l=>{let d=this.proxies.get(l.id);d.y=r*(s+1)-d.h/2,s++});let u=[],a=new Map;for(let l=e.length-2;l>=0;l--){e[l].forEach(c=>{let p=[];this.graph.getEdges(c).out.forEach(y=>{p.push(y.inputNode)}),a.set(c.id,p)});let d=[];e[l].forEach(c=>{let p=0,g=a.get(c.id);g.length&&(g.forEach(y=>{p+=this.proxies.get(y.id).y,p+=this.graph.getEdges(y).in.find(v=>v.outputNode.id===c.id).inputIndex}),p/=g.length),d.push({y:p,node:c})}),d=d.sort((c,p)=>c.y-p.y),u[l]=d;let h=0;d.forEach((c,p)=>{let g=this.proxies.get(c.node.id);p===0?g.y=n/(e[l].size+1)-g.h/2:g.y=Math.max(h+jt,c.y-g.h/2),h=g.y+g.h})}for(let l=1;l<e.length-1;l++){const d=u[l];if(d.length===1)this.proxies.get(d[0].node.id).y=this.computeAverageParentY(e,l,d[0]);else for(var t=d.length-1;t>0;t--){let h=this.proxies.get(d[t].node.id);const c=this.proxies.get(d[t-1].node.id),p=this.computeAverageParentY(e,l,d[t]);p>=c.y+c.h+jt&&(t<d.length-1?this.proxies.get(d[t+1].node.id).y>=p+h.h+jt&&(h.y=p):h.y=p)}}}}computeAverageParentY(e,t,n){let o=[];if(e[t-1].forEach(s=>{this.graph.getEdges(s).out.forEach(a=>{a.inputNode.id===n.node.id&&o.push(s)})}),!o.length)return n.y;let r=0;return o.forEach(s=>r+=this.proxies.get(s.id).y),r/o.length}}function Pu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M12 4.5v15m7.5-7.5h-15"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Tu extends J{constructor(e){super(),ee(this,e,null,Pu,te,{})}}function Vu(i){let e,t,n;return{c(){e=C("input"),this.h()},l(o){e=k(o,"INPUT",{class:!0}),this.h()},h(){f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit")},m(o,r){F(o,e,r),Ae(e,i[0]),t||(n=[B(e,"change",i[3]),B(e,"keydown",i[6]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)}),B(e,"input",i[7])],t=!0)},p(o,[r]){i=o,r&1&&e.value!==i[0]&&Ae(e,i[0])},i:D,o:D,d(o){o&&I(e),t=!1,Ee(n)}}}function Au(i,e,t){let{initialValue:n=void 0}=e,{currentValue:o=void 0}=e,{onApply:r=void 0}=e,{onFocus:s=void 0,onBlur:u=void 0}=e;function a(){return!isNaN(parseFloat(o))}function l(){a()?(r(o),t(4,n=o)):t(0,o=n)}const d=c=>{c.key==="Enter"&&l()};function h(){o=this.value,t(0,o)}return i.$$set=c=>{"initialValue"in c&&t(4,n=c.initialValue),"currentValue"in c&&t(0,o=c.currentValue),"onApply"in c&&t(5,r=c.onApply),"onFocus"in c&&t(1,s=c.onFocus),"onBlur"in c&&t(2,u=c.onBlur)},i.$$.update=()=>{if(i.$$.dirty&1&&o!==""){const c=parseFloat(o);isNaN(c)||t(0,o=c)}},[o,s,u,l,n,r,d,h]}class Go extends J{constructor(e){super(),ee(this,e,Au,Vu,te,{initialValue:4,currentValue:0,onApply:5,onFocus:1,onBlur:2})}}function Ou(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Ru extends J{constructor(e){super(),ee(this,e,null,Ou,te,{})}}function Lu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Mu extends J{constructor(e){super(),ee(this,e,null,Lu,te,{})}}function Fu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Bu extends J{constructor(e){super(),ee(this,e,null,Fu,te,{})}}function zu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Qu extends J{constructor(e){super(),ee(this,e,null,zu,te,{})}}function Yu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M19.5 19.5l-15-15m0 0v11.25m0-11.25h11.25"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Wu extends J{constructor(e){super(),ee(this,e,null,Yu,te,{})}}function Uu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Gu extends J{constructor(e){super(),ee(this,e,null,Uu,te,{})}}function Xu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M19.5 4.5l-15 15m0 0h11.25m-11.25 0V8.25"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class ju extends J{constructor(e){super(),ee(this,e,null,Xu,te,{})}}function qu(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M4.5 4.5l15 15m0 0V8.25m0 11.25H8.25"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","4"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Hu extends J{constructor(e){super(),ee(this,e,null,qu,te,{})}}function Ti(i,e,t){const n=i.slice();return n[13]=e[t],n}function Ku(i){let e,t;return e=new Hu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Zu(i){let e,t;return e=new Qu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function $u(i){let e,t;return e=new ju({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Ju(i){let e,t;return e=new Mu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function el(i){return{c:D,l:D,m:D,i:D,o:D,d:D}}function tl(i){let e,t;return e=new Ru({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function nl(i){let e,t;return e=new Gu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function il(i){let e,t;return e=new Bu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function ol(i){let e,t;return e=new Wu({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Vi(i,e){let t;return{key:i,first:null,c(){t=C("div"),this.h()},l(n){t=k(n,"DIV",{class:!0}),N(t).forEach(I),this.h()},h(){f(t,"class","hidden"),this.first=t},m(n,o){F(n,t,o)},p(n,o){},d(n){n&&I(t)}}}function rl(i){let e,t,n,o,r,s,u,a,l,d,h,c=[],p=new Map,g,y,w,v;const x=[ol,il,nl,tl,el,Ju,$u,Zu,Ku],m=[];function _(A,T){return A[1]===0?0:A[1]===1?1:A[1]===2?2:A[1]===3?3:A[1]===4?4:A[1]===5?5:A[1]===6?6:A[1]===7?7:A[1]===8?8:-1}~(u=_(i))&&(a=m[u]=x[u](i));let b=i[2];const S=A=>A[13].id;for(let A=0;A<b.length;A+=1){let T=Ti(i,b,A),L=S(T);p.set(L,c[A]=Vi(L))}return{c(){e=C("div"),t=C("img"),o=H(),r=C("div"),s=C("div"),a&&a.c(),d=H(),h=C("div");for(let A=0;A<c.length;A+=1)c[A].c();this.h()},l(A){e=k(A,"DIV",{class:!0});var T=N(e);t=k(T,"IMG",{class:!0,src:!0,alt:!0}),o=K(T),r=k(T,"DIV",{class:!0});var L=N(r);s=k(L,"DIV",{class:!0});var oe=N(s);a&&a.l(oe),oe.forEach(I),L.forEach(I),d=K(T),h=k(T,"DIV",{class:!0});var ie=N(h);for(let M=0;M<c.length;M+=1)c[M].l(ie);ie.forEach(I),T.forEach(I),this.h()},h(){f(t,"class","max-w-full max-h-full"),en(t.src,n=i[0].urls[i[4]])||f(t,"src",n),f(t,"alt",""),f(s,"class","w-6 h-6 text-neutral-100"),f(r,"class",l=`absolute top-0 left-0 w-full h-full flex flex-row items-center justify-center ${i[3]?"opacity-100":"opacity-0"} transition-all bg-black/50`),f(h,"class","absolute top-0 left-0 w-full h-full"),f(e,"class","w-16 h-16 bg-neutral-800 border border-solid border-neutral-700 overflow-hidden flex flex-row items-center justify-center relative")},m(A,T){F(A,e,T),E(e,t),E(e,o),E(e,r),E(r,s),~u&&m[u].m(s,null),E(e,d),E(e,h);for(let L=0;L<c.length;L+=1)c[L].m(h,null);y=!0,w||(v=[Bn(g=$n.call(null,h,{type:"Animation",dragDisabled:!0,morphDisabled:!0,dropTargetStyle:"",items:i[2]})),B(h,"consider",i[5]),B(h,"finalize",i[6]),B(e,"mouseenter",i[8]),B(e,"mouseleave",i[9])],w=!0)},p(A,[T]){(!y||T&17&&!en(t.src,n=A[0].urls[A[4]]))&&f(t,"src",n);let L=u;u=_(A),u!==L&&(a&&(ye(),V(m[L],1,1,()=>{m[L]=null}),ve()),~u?(a=m[u],a||(a=m[u]=x[u](A),a.c()),P(a,1),a.m(s,null)):a=null),(!y||T&8&&l!==(l=`absolute top-0 left-0 w-full h-full flex flex-row items-center justify-center ${A[3]?"opacity-100":"opacity-0"} transition-all bg-black/50`))&&f(r,"class",l),T&4&&(b=A[2],c=zn(c,T,S,1,A,b,p,h,po,Vi,null,Ti)),g&&me(g.update)&&T&4&&g.update.call(null,{type:"Animation",dragDisabled:!0,morphDisabled:!0,dropTargetStyle:"",items:A[2]})},i(A){y||(P(a),y=!0)},o(A){V(a),y=!1},d(A){A&&I(e),~u&&m[u].d();for(let T=0;T<c.length;T+=1)c[T].d();w=!1,Ee(v)}}}function sl(i,e,t){let{texture:n=void 0}=e,{textureIdx:o=void 0}=e,{onSetTextureProps:r=void 0}=e,s=[],u=!1;function a(p){t(2,s=p.detail.items)}function l(p){p.detail.items.length>0&&p.detail.items[0].candidate&&r(p.detail.items[0].candidate),t(2,s=[])}let d=0;const h=()=>t(3,u=!0),c=()=>t(3,u=!1);return i.$$set=p=>{"texture"in p&&t(0,n=p.texture),"textureIdx"in p&&t(1,o=p.textureIdx),"onSetTextureProps"in p&&t(7,r=p.onSetTextureProps)},i.$$.update=()=>{i.$$.dirty&1},[n,o,s,u,d,a,l,r,h,c]}class ul extends J{constructor(e){super(),ee(this,e,sl,rl,te,{texture:0,textureIdx:1,onSetTextureProps:7})}}function ll(i){const e=i-1;return e*e*e+1}function al(i,{from:e,to:t},n={}){const o=getComputedStyle(i),r=o.transform==="none"?"":o.transform,[s,u]=o.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*s/t.width-(t.left+s),l=e.top+e.height*u/t.height-(t.top+u),{delay:d=0,duration:h=p=>Math.sqrt(p)*120,easing:c=ll}=n;return{delay:d,duration:me(h)?h(Math.sqrt(a*a+l*l)):h,easing:c,css:(p,g)=>{const y=g*a,w=g*l,v=p+g*e.width/t.width,x=p+g*e.height/t.height;return`transform: ${r} translate(${y}px, ${w}px) scale(${v}, ${x});`}}}function dl(i){let e,t,n;return{c(){e=C("input"),this.h()},l(o){e=k(o,"INPUT",{class:!0}),this.h()},h(){f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit")},m(o,r){F(o,e,r),Ae(e,i[0]),t||(n=[B(e,"change",i[3]),B(e,"keydown",i[6]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)}),B(e,"input",i[7])],t=!0)},p(o,[r]){i=o,r&1&&e.value!==i[0]&&Ae(e,i[0])},i:D,o:D,d(o){o&&I(e),t=!1,Ee(n)}}}function cl(i,e,t){let{initialValue:n=void 0}=e,{currentValue:o=void 0}=e,{onApply:r=void 0}=e,{onFocus:s=void 0,onBlur:u=void 0}=e;function a(){return!isNaN(parseInt(o))}function l(){a()?(r(o),t(4,n=o)):t(0,o=n)}const d=c=>{c.key==="Enter"&&l()};function h(){o=this.value,t(0,o)}return i.$$set=c=>{"initialValue"in c&&t(4,n=c.initialValue),"currentValue"in c&&t(0,o=c.currentValue),"onApply"in c&&t(5,r=c.onApply),"onFocus"in c&&t(1,s=c.onFocus),"onBlur"in c&&t(2,u=c.onBlur)},i.$$.update=()=>{if(i.$$.dirty&1&&o!==""){const c=parseInt(o);isNaN(c)||t(0,o=c)}},[o,s,u,l,n,r,d,h]}class hl extends J{constructor(e){super(),ee(this,e,cl,dl,te,{initialValue:4,currentValue:0,onApply:5,onFocus:1,onBlur:2})}}function pl(i){let e,t,n,o;return{c(){e=C("input"),this.h()},l(r){e=k(r,"INPUT",{placeholder:!0,class:!0}),this.h()},h(){e.value="",f(e,"placeholder",t=O.keyToDisplayStr(i[0])),f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1a4l55f")},m(r,s){F(r,e,s),n||(o=[B(e,"keydown",i[3]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)})],n=!0)},p(r,[s]){i=r,s&1&&t!==(t=O.keyToDisplayStr(i[0]))&&f(e,"placeholder",t)},i:D,o:D,d(r){r&&I(e),n=!1,Ee(o)}}}function fl(i,e,t){let{currentValue:n=void 0}=e,{onApply:o=void 0}=e,{onFocus:r=void 0,onBlur:s=void 0}=e;function u(){return n.length>0}function a(){u()&&o(n)}function l(d){d.preventDefault(),d.stopPropagation(),t(0,n=d.key.length===1?d.key.toUpperCase():d.key),a()}return i.$$set=d=>{"currentValue"in d&&t(0,n=d.currentValue),"onApply"in d&&t(4,o=d.onApply),"onFocus"in d&&t(1,r=d.onFocus),"onBlur"in d&&t(2,s=d.onBlur)},[n,r,s,l,o]}class gl extends J{constructor(e){super(),ee(this,e,fl,pl,te,{currentValue:0,onApply:4,onFocus:1,onBlur:2})}}function Ai(i,e,t){const n=i.slice();return n[14]=e[t],n}function Oi(i){let e,t=i[14].name+"",n,o;return{c(){e=C("option"),n=pe(t),this.h()},l(r){e=k(r,"OPTION",{class:!0});var s=N(e);n=fe(s,t),s.forEach(I),this.h()},h(){f(e,"class","bg-neutral-900 svelte-1a4l55f"),e.__value=o=i[14].name,e.value=e.__value},m(r,s){F(r,e,s),E(e,n)},p(r,s){s&8&&t!==(t=r[14].name+"")&&We(n,t),s&8&&o!==(o=r[14].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&I(e)}}}function ml(i){let e,t,n,o=i[3],r=[];for(let s=0;s<o.length;s+=1)r[s]=Oi(Ai(i,o,s));return{c(){e=C("select");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=k(s,"SELECT",{class:!0});var u=N(e);for(let a=0;a<r.length;a+=1)r[a].l(u);u.forEach(I),this.h()},h(){f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1a4l55f")},m(s,u){F(s,e,u);for(let a=0;a<r.length;a+=1)r[a].m(e,null);dt(e,i[0]),i[8](e),t||(n=[B(e,"change",i[9]),B(e,"keydown",i[10]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)})],t=!0)},p(s,[u]){if(i=s,u&8){o=i[3];let a;for(a=0;a<o.length;a+=1){const l=Ai(i,o,a);r[a]?r[a].p(l,u):(r[a]=Oi(l),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=o.length}u&1&&dt(e,i[0])},i:D,o:D,d(s){s&&I(e),Ue(r,s),i[8](null),t=!1,Ee(n)}}}function yl(i,e,t){let{currentValue:n=void 0}=e,{onApply:o=void 0}=e,{onFocus:r=void 0,onBlur:s=void 0}=e,{states:u=null}=e,a=null,l=[];function d(){t(3,l=[]);for(const[v,x]of u)l.push({name:v,state:x});O.alphabetSort(l)}function h(v){return u.has(v)}function c(){return h(n)}function p(){c()&&o(n)}function g(v){Oe[v?"unshift":"push"](()=>{a=v,t(4,a),t(3,l)})}const y=v=>{t(0,n=v.target.value),p()},w=v=>{v.key==="Enter"&&(t(0,n=v.target.value),p())};return i.$$set=v=>{"currentValue"in v&&t(0,n=v.currentValue),"onApply"in v&&t(6,o=v.onApply),"onFocus"in v&&t(1,r=v.onFocus),"onBlur"in v&&t(2,s=v.onBlur),"states"in v&&t(7,u=v.states)},i.$$.update=()=>{i.$$.dirty&137&&(d(),h(n)||(l.length>0?t(0,n=l[0].name):t(0,n=""),p()))},[n,r,s,l,a,p,o,u,g,y,w]}class vl extends J{constructor(e){super(),ee(this,e,yl,ml,te,{currentValue:0,onApply:6,onFocus:1,onBlur:2,states:7})}}function xl(i){let e,t,n,o,r,s,u,a;return{c(){e=C("select"),t=C("option"),n=pe("True"),o=C("option"),r=pe("False"),this.h()},l(l){e=k(l,"SELECT",{class:!0});var d=N(e);t=k(d,"OPTION",{class:!0});var h=N(t);n=fe(h,"True"),h.forEach(I),o=k(d,"OPTION",{class:!0});var c=N(o);r=fe(c,"False"),c.forEach(I),d.forEach(I),this.h()},h(){f(t,"class","bg-neutral-900 svelte-1a4l55f"),t.__value="true",t.value=t.__value,f(o,"class","bg-neutral-900 svelte-1a4l55f"),o.__value="false",o.value=o.__value,f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1a4l55f")},m(l,d){F(l,e,d),E(e,t),E(t,n),E(e,o),E(o,r),dt(e,i[0]?"true":"false"),u||(a=[B(e,"change",i[5]),B(e,"keydown",i[6]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)})],u=!0)},p(l,[d]){i=l,d&1&&s!==(s=i[0]?"true":"false")&&dt(e,i[0]?"true":"false")},i:D,o:D,d(l){l&&I(e),u=!1,Ee(a)}}}function wl(i,e,t){let{currentValue:n=void 0}=e,{onApply:o=void 0}=e,{onFocus:r=void 0,onBlur:s=void 0}=e;function u(){o(n)}const a=d=>{t(0,n=d.target.value==="true"),u()},l=d=>{d.key==="Enter"&&(t(0,n=d.target.value==="true"),u())};return i.$$set=d=>{"currentValue"in d&&t(0,n=d.currentValue),"onApply"in d&&t(4,o=d.onApply),"onFocus"in d&&t(1,r=d.onFocus),"onBlur"in d&&t(2,s=d.onBlur)},[n,r,s,u,o,a,l]}class _l extends J{constructor(e){super(),ee(this,e,wl,xl,te,{currentValue:0,onApply:4,onFocus:1,onBlur:2})}}function Il(i){let e,t,n;return{c(){e=C("input"),this.h()},l(o){e=k(o,"INPUT",{class:!0}),this.h()},h(){e.value=i[0],f(e,"class","p-2 w-full h-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1a4l55f")},m(o,r){F(o,e,r),t||(n=[B(e,"change",i[5]),B(e,"keydown",i[6]),B(e,"focus",function(){me(i[1])&&i[1].apply(this,arguments)}),B(e,"blur",function(){me(i[2])&&i[2].apply(this,arguments)})],t=!0)},p(o,[r]){i=o,r&1&&e.value!==i[0]&&(e.value=i[0])},i:D,o:D,d(o){o&&I(e),t=!1,Ee(n)}}}function bl(i,e,t){let{currentValue:n=void 0}=e,{onApply:o=void 0}=e,{onFocus:r=void 0,onBlur:s=void 0}=e;function u(){o(n)}const a=d=>{t(0,n=d.target.value),u()},l=d=>{d.key==="Enter"&&(t(0,n=d.target.value),u())};return i.$$set=d=>{"currentValue"in d&&t(0,n=d.currentValue),"onApply"in d&&t(4,o=d.onApply),"onFocus"in d&&t(1,r=d.onFocus),"onBlur"in d&&t(2,s=d.onBlur)},[n,r,s,u,o,a,l]}class El extends J{constructor(e){super(),ee(this,e,bl,Il,te,{currentValue:0,onApply:4,onFocus:1,onBlur:2})}}function Nl(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20"),f(e,"fill","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class ei extends J{constructor(e){super(),ee(this,e,null,Nl,te,{})}}function Sl(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0});var o=N(e);t=le(o,"path",{d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"d","M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20"),f(e,"fill","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Xo extends J{constructor(e){super(),ee(this,e,null,Sl,te,{})}}function Cl(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.52.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20"),f(e,"fill","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class jo extends J{constructor(e){super(),ee(this,e,null,Cl,te,{})}}function Ri(i,e,t){const n=i.slice();return n[29]=e[t],n}function kl(i){let e;return{c(){e=C("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),N(e).forEach(I),this.h()},h(){f(e,"class","grow-0 shrink-0 w-5 h-5 mr-2")},m(t,n){F(t,e,n)},p:D,i:D,o:D,d(t){t&&I(e)}}}function Dl(i){let e,t,n,o,r,s;return t=new ei({}),{c(){e=C("button"),G(t.$$.fragment),this.h()},l(u){e=k(u,"BUTTON",{class:!0});var a=N(e);X(t.$$.fragment,a),a.forEach(I),this.h()},h(){f(e,"class",n=`grow-0 shrink-0 w-5 h-5 mr-2 hover:bg-neutral-500 hover:text-neutral-100 rounded-full transition-all duration-75 ${i[5]?"":"rotate-90"}`)},m(u,a){F(u,e,a),j(t,e,null),o=!0,r||(s=B(e,"click",function(){me(i[6])&&i[6].apply(this,arguments)}),r=!0)},p(u,a){i=u,(!o||a[0]&32&&n!==(n=`grow-0 shrink-0 w-5 h-5 mr-2 hover:bg-neutral-500 hover:text-neutral-100 rounded-full transition-all duration-75 ${i[5]?"":"rotate-90"}`))&&f(e,"class",n)},i(u){o||(P(t.$$.fragment,u),o=!0)},o(u){V(t.$$.fragment,u),o=!1},d(u){u&&I(e),q(t),r=!1,s()}}}function Li(i){let e,t,n=i[7],o=[];for(let s=0;s<n.length;s+=1)o[s]=Mi(Ri(i,n,s));const r=s=>V(o[s],1,1,()=>{o[s]=null});return{c(){e=C("div");for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){e=k(s,"DIV",{class:!0});var u=N(e);for(let a=0;a<o.length;a+=1)o[a].l(u);u.forEach(I),this.h()},h(){f(e,"class","flex flex-col grow-0 shrink-0 w-full overflow-hidden")},m(s,u){F(s,e,u);for(let a=0;a<o.length;a+=1)o[a].m(e,null);t=!0},p(s,u){if(u[0]&401){n=s[7];let a;for(a=0;a<n.length;a+=1){const l=Ri(s,n,a);o[a]?(o[a].p(l,u),P(o[a],1)):(o[a]=Mi(l),o[a].c(),P(o[a],1),o[a].m(e,null))}for(ye(),a=n.length;a<o.length;a+=1)r(a);ve()}},i(s){if(!t){for(let u=0;u<n.length;u+=1)P(o[u]);t=!0}},o(s){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)V(o[u]);t=!1},d(s){s&&I(e),Ue(o,s)}}}function Pl(i){let e,t;function n(...r){return i[26](i[29],...r)}function o(){return i[27](i[29])}return e=new _l({props:{initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[28]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[28]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Tl(i){let e,t;function n(...r){return i[23](i[29],...r)}function o(){return i[24](i[29])}return e=new El({props:{initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[25]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[25]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Vl(i){let e,t;function n(...r){return i[20](i[29],...r)}function o(){return i[21](i[29])}return e=new vl({props:{states:i[0],initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[22]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&1&&(u.states=i[0]),s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[22]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Al(i){let e,t;function n(...r){return i[17](i[29],...r)}function o(){return i[18](i[29])}return e=new gl({props:{initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[19]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[19]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Ol(i){let e,t;function n(...r){return i[14](i[29],...r)}function o(){return i[15](i[29])}return e=new Go({props:{initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[16]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[16]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Rl(i){let e,t;function n(...r){return i[11](i[29],...r)}function o(){return i[12](i[29])}return e=new hl({props:{initialValue:i[29].value,currentValue:i[29].value,onApply:n,onFocus:o,onBlur:i[13]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s[0]&128&&(u.initialValue=i[29].value),s[0]&128&&(u.currentValue=i[29].value),s[0]&128&&(u.onApply=n),s[0]&384&&(u.onFocus=o),s[0]&256&&(u.onBlur=i[13]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Mi(i){let e,t,n=i[29].name+"",o,r,s,u,a,l,d,h,c,p,g;const y=[Rl,Ol,Al,Vl,Tl,Pl],w=[];function v(x,m){return x[29].editorType==="int"?0:x[29].editorType==="float"?1:x[29].editorType==="key"?2:x[29].editorType==="state"?3:x[29].editorType==="string"?4:x[29].editorType==="bool"?5:-1}return~(l=v(i))&&(d=w[l]=y[l](i)),{c(){e=C("div"),t=C("div"),o=pe(n),u=H(),a=C("div"),d&&d.c(),h=H(),this.h()},l(x){e=k(x,"DIV",{class:!0,style:!0});var m=N(e);t=k(m,"DIV",{class:!0,style:!0});var _=N(t);o=fe(_,n),_.forEach(I),u=K(m),a=k(m,"DIV",{class:!0});var b=N(a);d&&d.l(b),b.forEach(I),h=K(m),m.forEach(I),this.h()},h(){f(t,"class",r=`grow-0 shrink-0 p-2 text-ellipsis whitespace-nowrap overflow-hidden w-48 transition-all ${i[29]===i[8]?"font-bold":""}`),f(t,"style",s=`color: ${xe[i[29].valueType].name}`),f(a,"class","grow-1 shrink-1 w-full overflow-hidden"),f(e,"class",c=`pl-16 flex flex-row grow-0 shrink-0 ${i[4]?"border-b":"not-last:border-b"} border-solid border-neutral-700 transition-all`),f(e,"style",p=i[29]===i[8]?`background-color: ${xe[i[29].valueType].editor.background}3F;`:"")},m(x,m){F(x,e,m),E(e,t),E(t,o),E(e,u),E(e,a),~l&&w[l].m(a,null),E(e,h),g=!0},p(x,m){(!g||m[0]&128)&&n!==(n=x[29].name+"")&&We(o,n),(!g||m[0]&384&&r!==(r=`grow-0 shrink-0 p-2 text-ellipsis whitespace-nowrap overflow-hidden w-48 transition-all ${x[29]===x[8]?"font-bold":""}`))&&f(t,"class",r),(!g||m[0]&128&&s!==(s=`color: ${xe[x[29].valueType].name}`))&&f(t,"style",s);let _=l;l=v(x),l===_?~l&&w[l].p(x,m):(d&&(ye(),V(w[_],1,1,()=>{w[_]=null}),ve()),~l?(d=w[l],d?d.p(x,m):(d=w[l]=y[l](x),d.c()),P(d,1),d.m(a,null)):d=null),(!g||m[0]&16&&c!==(c=`pl-16 flex flex-row grow-0 shrink-0 ${x[4]?"border-b":"not-last:border-b"} border-solid border-neutral-700 transition-all`))&&f(e,"class",c),(!g||m[0]&384&&p!==(p=x[29]===x[8]?`background-color: ${xe[x[29].valueType].editor.background}3F;`:""))&&f(e,"style",p)},i(x){g||(P(d),g=!0)},o(x){V(d),g=!1},d(x){x&&I(e),~l&&w[l].d()}}}function Ll(i){let e,t,n,o,r,s,u,a,l,d,h=i[1].debugName+"",c,p,g,y,w,v,x,m,_,b,S,A,T;const L=[Dl,kl],oe=[];function ie(W,Q){return W[7].length>0?0:1}o=ie(i),r=oe[o]=L[o](i),w=new Xo({}),_=new jo({});let M=!i[5]&&Li(i);return{c(){e=C("div"),t=C("div"),n=C("div"),r.c(),s=H(),u=C("div"),a=pe("Script:"),l=H(),d=C("div"),c=pe(h),p=H(),g=C("button"),y=C("div"),G(w.$$.fragment),v=H(),x=C("button"),m=C("div"),G(_.$$.fragment),b=H(),M&&M.c(),this.h()},l(W){e=k(W,"DIV",{class:!0});var Q=N(e);t=k(Q,"DIV",{class:!0});var re=N(t);n=k(re,"DIV",{class:!0});var Y=N(n);r.l(Y),s=K(Y),u=k(Y,"DIV",{class:!0});var ae=N(u);a=fe(ae,"Script:"),ae.forEach(I),l=K(Y),d=k(Y,"DIV",{class:!0});var Ne=N(d);c=fe(Ne,h),Ne.forEach(I),Y.forEach(I),p=K(re),g=k(re,"BUTTON",{class:!0});var z=N(g);y=k(z,"DIV",{class:!0});var R=N(y);X(w.$$.fragment,R),R.forEach(I),z.forEach(I),v=K(re),x=k(re,"BUTTON",{class:!0});var ne=N(x);m=k(ne,"DIV",{class:!0});var de=N(m);X(_.$$.fragment,de),de.forEach(I),ne.forEach(I),re.forEach(I),b=K(Q),M&&M.l(Q),Q.forEach(I),this.h()},h(){f(u,"class","grow-0 shrink-0 overflow-hidden font-normal mr-1"),f(d,"class","grow-1 shrink-1 overflow-hidden text-ellipsis whitespace-nowrap"),f(n,"class","flex flex-row w-full grow-1 shrink-1 p-2 overflow-hidden font-bold"),f(y,"class","w-5 h-5"),f(g,"class","grow-0 shrink-0 p-2 hover:bg-neutral-500 hover:text-neutral-100 h-full"),f(m,"class","w-5 h-5"),f(x,"class","grow-0 shrink-0 p-2 hover:bg-neutral-500 hover:text-neutral-100 h-full"),f(t,"class","pl-8 bg-neutral-800 flex flex-row grow-0 shrink-0 w-full overflow-x-hidden text-left"),f(e,"class","flex flex-col grow-0 shrink-0 w-full overflow-x-hidden")},m(W,Q){F(W,e,Q),E(e,t),E(t,n),oe[o].m(n,null),E(n,s),E(n,u),E(u,a),E(n,l),E(n,d),E(d,c),E(t,p),E(t,g),E(g,y),j(w,y,null),E(t,v),E(t,x),E(x,m),j(_,m,null),E(e,b),M&&M.m(e,null),S=!0,A||(T=[B(g,"click",i[9]),B(x,"click",i[10])],A=!0)},p(W,Q){let re=o;o=ie(W),o===re?oe[o].p(W,Q):(ye(),V(oe[re],1,1,()=>{oe[re]=null}),ve(),r=oe[o],r?r.p(W,Q):(r=oe[o]=L[o](W),r.c()),P(r,1),r.m(n,s)),(!S||Q[0]&2)&&h!==(h=W[1].debugName+"")&&We(c,h),W[5]?M&&(ye(),V(M,1,1,()=>{M=null}),ve()):M?(M.p(W,Q),Q[0]&32&&P(M,1)):(M=Li(W),M.c(),P(M,1),M.m(e,null))},i(W){S||(P(r),P(w.$$.fragment,W),P(_.$$.fragment,W),P(M),S=!0)},o(W){V(r),V(w.$$.fragment,W),V(_.$$.fragment,W),V(M),S=!1},d(W){W&&I(e),oe[o].d(),q(w),q(_),M&&M.d(),A=!1,Ee(T)}}}function Ml(i,e,t){let{states:n=void 0}=e,{script:o=void 0}=e,{onEditScript:r=void 0}=e,{onDelete:s=void 0}=e,{isLast:u=!1}=e,{collapsed:a=!1}=e,{onToggleCollapsed:l=void 0}=e,d=[],h;const c=Y=>{Y.stopPropagation(),r()},p=Y=>{Y.stopPropagation(),s()},g=(Y,ae)=>Y.setValue(ae),y=Y=>t(8,h=Y),w=()=>t(8,h=void 0),v=(Y,ae)=>Y.setValue(ae),x=Y=>t(8,h=Y),m=()=>t(8,h=void 0),_=(Y,ae)=>Y.setValue(ae),b=Y=>t(8,h=Y),S=()=>t(8,h=void 0),A=(Y,ae)=>Y.setValue(ae),T=Y=>t(8,h=Y),L=()=>t(8,h=void 0),oe=(Y,ae)=>Y.setValue(ae),ie=Y=>t(8,h=Y),M=()=>t(8,h=void 0),W=(Y,ae)=>Y.setValue(ae),Q=Y=>t(8,h=Y),re=()=>t(8,h=void 0);return i.$$set=Y=>{"states"in Y&&t(0,n=Y.states),"script"in Y&&t(1,o=Y.script),"onEditScript"in Y&&t(2,r=Y.onEditScript),"onDelete"in Y&&t(3,s=Y.onDelete),"isLast"in Y&&t(4,u=Y.isLast),"collapsed"in Y&&t(5,a=Y.collapsed),"onToggleCollapsed"in Y&&t(6,l=Y.onToggleCollapsed)},i.$$.update=()=>{i.$$.dirty[0]&130&&(o?(t(7,d=[...o.exportNodes]),O.alphabetSort(d)):t(7,d=[]))},[n,o,r,s,u,a,l,d,h,c,p,g,y,w,v,x,m,_,b,S,A,T,L,oe,ie,M,W,Q,re]}class Fl extends J{constructor(e){super(),ee(this,e,Ml,Ll,te,{states:0,script:1,onEditScript:2,onDelete:3,isLast:4,collapsed:5,onToggleCollapsed:6},null,[-1,-1])}}function Fi(i,e,t){const n=i.slice();return n[18]=e[t],n[19]=e,n[20]=t,n}function Bl(i){let e,t,n,o,r,s;return{c(){e=C("div"),t=C("div"),n=C("div"),o=pe("Add or drag a script"),this.h()},l(u){e=k(u,"DIV",{class:!0});var a=N(e);t=k(a,"DIV",{class:!0});var l=N(t);n=k(l,"DIV",{});var d=N(n);o=fe(d,"Add or drag a script"),d.forEach(I),l.forEach(I),a.forEach(I),this.h()},h(){f(t,"class",r=`grow-0 shrink-0 w-full h-full flex flex-col items-center justify-center overflow-hidden text-xl font-bold border-2 border-dashed rounded-lg transition-all ${i[7]?"border-neutral-500 text-neutral-500":"border-neutral-600 text-neutral-600"}`),f(e,"class",s=`grow-0 shrink-0 w-full h-full overflow-hidden p-4 ${i[0]?"bg-[#1a1a1a]":"bg-neutral-900"}`)},m(u,a){F(u,e,a),E(e,t),E(t,n),E(n,o)},p(u,a){a&128&&r!==(r=`grow-0 shrink-0 w-full h-full flex flex-col items-center justify-center overflow-hidden text-xl font-bold border-2 border-dashed rounded-lg transition-all ${u[7]?"border-neutral-500 text-neutral-500":"border-neutral-600 text-neutral-600"}`)&&f(t,"class",r),a&1&&s!==(s=`grow-0 shrink-0 w-full h-full overflow-hidden p-4 ${u[0]?"bg-[#1a1a1a]":"bg-neutral-900"}`)&&f(e,"class",s)},i:D,o:D,d(u){u&&I(e)}}}function zl(i){let e=[],t=new Map,n,o,r=i[6];const s=u=>u[18].id;for(let u=0;u<r.length;u+=1){let a=Fi(i,r,u),l=s(a);t.set(l,e[u]=Bi(l,a))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();n=ct()},l(u){for(let a=0;a<e.length;a+=1)e[a].l(u);n=ct()},m(u,a){for(let l=0;l<e.length;l+=1)e[l].m(u,a);F(u,n,a),o=!0},p(u,a){if(a&95){r=u[6],ye();for(let l=0;l<e.length;l+=1)e[l].r();e=zn(e,a,s,1,u,r,t,n.parentNode,rr,Bi,n,Fi);for(let l=0;l<e.length;l+=1)e[l].a();ve()}},i(u){if(!o){for(let a=0;a<r.length;a+=1)P(e[a]);o=!0}},o(u){for(let a=0;a<e.length;a+=1)V(e[a]);o=!1},d(u){for(let a=0;a<e.length;a+=1)e[a].d(u);u&&I(n)}}}function Bi(i,e){let t,n,o,r,s,u=D,a;function l(){return e[12](e[18])}function d(){return e[13](e[18])}function h(){return e[14](e[18],e[19],e[20])}return n=new Fl({props:{states:e[1],script:e[18].script,onEditScript:l,onDelete:d,isLast:e[4]&&e[20]===e[6].length-1,collapsed:e[18].script.collapsed,onToggleCollapsed:h}}),{key:i,first:null,c(){t=C("div"),G(n.$$.fragment),o=H(),this.h()},l(c){t=k(c,"DIV",{class:!0});var p=N(t);X(n.$$.fragment,p),o=K(p),p.forEach(I),this.h()},h(){f(t,"class",r=`grow-0 shrink-0 w-full overflow-x-hidden ${e[0]?"bg-[#1a1a1a]":"bg-neutral-900"}`),this.first=t},m(c,p){F(c,t,p),j(n,t,null),E(t,o),a=!0},p(c,p){e=c;const g={};p&2&&(g.states=e[1]),p&64&&(g.script=e[18].script),p&68&&(g.onEditScript=l),p&72&&(g.onDelete=d),p&80&&(g.isLast=e[4]&&e[20]===e[6].length-1),p&64&&(g.collapsed=e[18].script.collapsed),p&64&&(g.onToggleCollapsed=h),n.$set(g),(!a||p&1&&r!==(r=`grow-0 shrink-0 w-full overflow-x-hidden ${e[0]?"bg-[#1a1a1a]":"bg-neutral-900"}`))&&f(t,"class",r)},r(){s=t.getBoundingClientRect()},f(){sr(t),u()},a(){u(),u=ur(t,s,al,{duration:100})},i(c){a||(P(n.$$.fragment,c),a=!0)},o(c){V(n.$$.fragment,c),a=!1},d(c){c&&I(t),q(n)}}}function Ql(i){let e,t,n,o,r,s,u,a;const l=[zl,Bl],d=[];function h(c,p){return c[6].length>0?0:c[5]?1:-1}return~(t=h(i))&&(n=d[t]=l[t](i)),{c(){e=C("div"),n&&n.c(),this.h()},l(c){e=k(c,"DIV",{class:!0});var p=N(e);n&&n.l(p),p.forEach(I),this.h()},h(){f(e,"class",o=`flex flex-col w-full h-full overflow-x-hidden overflow-y-auto ${i[5]?"min-h-[192px]":""}`)},m(c,p){F(c,e,p),~t&&d[t].m(e,null),s=!0,u||(a=[Bn(r=$n.call(null,e,{type:"Script",dragDisabled:i[6].length===0,morphDisabled:!0,dropTargetStyle:"",items:i[6],flipDurationMs:100})),B(e,"consider",i[8]),B(e,"finalize",i[9]),B(e,"mouseenter",i[15]),B(e,"mouseleave",i[16])],u=!0)},p(c,[p]){let g=t;t=h(c),t===g?~t&&d[t].p(c,p):(n&&(ye(),V(d[g],1,1,()=>{d[g]=null}),ve()),~t?(n=d[t],n?n.p(c,p):(n=d[t]=l[t](c),n.c()),P(n,1),n.m(e,null)):n=null),(!s||p&32&&o!==(o=`flex flex-col w-full h-full overflow-x-hidden overflow-y-auto ${c[5]?"min-h-[192px]":""}`))&&f(e,"class",o),r&&me(r.update)&&p&64&&r.update.call(null,{type:"Script",dragDisabled:c[6].length===0,morphDisabled:!0,dropTargetStyle:"",items:c[6],flipDurationMs:100})},i(c){s||(P(n),s=!0)},o(c){V(n),s=!1},d(c){c&&I(e),~t&&d[t].d(),u=!1,Ee(a)}}}function Yl(i,e,t){let{parentStateSelected:n=!1}=e,{states:o=void 0}=e,{scripts:r=void 0}=e,{onRearrangeScripts:s=void 0}=e,{onEditScript:u=void 0}=e,{onDeleteScript:a=void 0}=e,{isLast:l=!1}=e,d=!1,h,c=!1;function p(b){t(6,h=b.detail.items)}function g(b){s(b.detail.items.map(S=>S.script))}function y(){t(6,h=[]);for(const b of r)h.push({id:Mt(),script:b});t(5,d=h.length===0)}const w=b=>u(b.script),v=b=>a(b.script),x=(b,S,A)=>t(6,S[A].script.collapsed=!b.script.collapsed,h),m=()=>t(7,c=!0),_=()=>t(7,c=!1);return i.$$set=b=>{"parentStateSelected"in b&&t(0,n=b.parentStateSelected),"states"in b&&t(1,o=b.states),"scripts"in b&&t(10,r=b.scripts),"onRearrangeScripts"in b&&t(11,s=b.onRearrangeScripts),"onEditScript"in b&&t(2,u=b.onEditScript),"onDeleteScript"in b&&t(3,a=b.onDeleteScript),"isLast"in b&&t(4,l=b.isLast)},i.$$.update=()=>{i.$$.dirty&1024&&y()},[n,o,u,a,l,d,h,c,p,g,r,s,w,v,x,m,_]}class Wl extends J{constructor(e){super(),ee(this,e,Yl,Ql,te,{parentStateSelected:0,states:1,scripts:10,onRearrangeScripts:11,onEditScript:2,onDeleteScript:3,isLast:4})}}function Ul(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M9 4.5v15m6-15v15m-10.875 0h15.75c.621 0 1.125-.504 1.125-1.125V5.625c0-.621-.504-1.125-1.125-1.125H4.125C3.504 4.5 3 5.004 3 5.625v12.75c0 .621.504 1.125 1.125 1.125z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class Gl extends J{constructor(e){super(),ee(this,e,null,Ul,te,{})}}function Xl(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0112 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class jl extends J{constructor(e){super(),ee(this,e,null,Xl,te,{})}}function zi(i,e,t){const n=i.slice();return n[16]=e[t],n[18]=t,n}function Qi(i){let e,t,n,o,r,s,u,a,l,d,h,c,p,g;o=new ei({});let y=!i[0].state.animationsCollapsed&&Yi(i),w=!i[0].state.animationsCollapsed&&Wi(i);return{c(){e=C("button"),t=C("div"),n=C("button"),G(o.$$.fragment),s=H(),u=C("div"),a=pe("Animations"),l=H(),y&&y.c(),d=H(),w&&w.c(),h=ct(),this.h()},l(v){e=k(v,"BUTTON",{class:!0});var x=N(e);t=k(x,"DIV",{class:!0});var m=N(t);n=k(m,"BUTTON",{class:!0});var _=N(n);X(o.$$.fragment,_),_.forEach(I),s=K(m),u=k(m,"DIV",{class:!0});var b=N(u);a=fe(b,"Animations"),b.forEach(I),m.forEach(I),l=K(x),y&&y.l(x),x.forEach(I),d=K(v),w&&w.l(v),h=ct(),this.h()},h(){f(n,"class",r=`hover:bg-neutral-500 hover:text-neutral-100 rounded-full grow-0 shrink-0 w-5 h-5 mr-2 transition-all duration-75 ${i[0].state.animationsCollapsed?"":"rotate-90"}`),f(u,"class","w-full grow-1 shrink-1 overflow-hidden text-ellipsis whitespace-nowrap"),f(t,"class","flex flex-row w-full grow-1 shrink-1 p-2 overflow-hidden font-bold"),f(e,"class","pl-8 flex flex-row grow-0 shrink-0 w-full overflow-x-hidden text-left bg-neutral-800")},m(v,x){F(v,e,x),E(e,t),E(t,n),j(o,n,null),E(t,s),E(t,u),E(u,a),E(e,l),y&&y.m(e,null),F(v,d,x),w&&w.m(v,x),F(v,h,x),c=!0,p||(g=B(n,"click",i[10]),p=!0)},p(v,x){(!c||x&1&&r!==(r=`hover:bg-neutral-500 hover:text-neutral-100 rounded-full grow-0 shrink-0 w-5 h-5 mr-2 transition-all duration-75 ${v[0].state.animationsCollapsed?"":"rotate-90"}`))&&f(n,"class",r),v[0].state.animationsCollapsed?y&&(ye(),V(y,1,1,()=>{y=null}),ve()):y?(y.p(v,x),x&1&&P(y,1)):(y=Yi(v),y.c(),P(y,1),y.m(e,null)),v[0].state.animationsCollapsed?w&&(ye(),V(w,1,1,()=>{w=null}),ve()):w?(w.p(v,x),x&1&&P(w,1)):(w=Wi(v),w.c(),P(w,1),w.m(h.parentNode,h))},i(v){c||(P(o.$$.fragment,v),P(y),P(w),c=!0)},o(v){V(o.$$.fragment,v),V(y),V(w),c=!1},d(v){v&&I(e),q(o),y&&y.d(),v&&I(d),w&&w.d(v),v&&I(h),p=!1,g()}}}function Yi(i){let e,t,n,o,r,s,u;const a=[Hl,ql],l=[];function d(h,c){return h[0].state.animationsView==="grid"?0:1}return n=d(i),o=l[n]=a[n](i),{c(){e=C("button"),t=C("div"),o.c(),this.h()},l(h){e=k(h,"BUTTON",{class:!0});var c=N(e);t=k(c,"DIV",{class:!0});var p=N(t);o.l(p),p.forEach(I),c.forEach(I),this.h()},h(){f(t,"class","w-5 h-5"),f(e,"class","grow-0 shrink-0 p-2 h-full hover:bg-neutral-500 hover:text-neutral-100")},m(h,c){F(h,e,c),E(e,t),l[n].m(t,null),r=!0,s||(u=B(e,"click",i[11]),s=!0)},p(h,c){let p=n;n=d(h),n!==p&&(ye(),V(l[p],1,1,()=>{l[p]=null}),ve(),o=l[n],o||(o=l[n]=a[n](h),o.c()),P(o,1),o.m(t,null))},i(h){r||(P(o),r=!0)},o(h){V(o),r=!1},d(h){h&&I(e),l[n].d(),s=!1,u()}}}function ql(i){let e,t;return e=new jl({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Hl(i){let e,t;return e=new Gl({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Wi(i){let e,t,n,o=i[0].state.textures,r=[];for(let u=0;u<o.length;u+=1)r[u]=Ui(zi(i,o,u));const s=u=>V(r[u],1,1,()=>{r[u]=null});return{c(){e=C("div");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=k(u,"DIV",{class:!0});var a=N(e);for(let l=0;l<r.length;l+=1)r[l].l(a);a.forEach(I),this.h()},h(){f(e,"class",t=`grow-0 shrink-0 items-center justify-center content-center justify-items-center grid gap-2 ${i[0].state.animationsView==="grid"?"grid-rows-3 grid-cols-[repeat(3,_64px)] p-4":"grid-rows-1 grid-cols-[repeat(9,_64px)] p-2"} bg-neutral-900 border-b border-solid border-neutral-700`)},m(u,a){F(u,e,a);for(let l=0;l<r.length;l+=1)r[l].m(e,null);n=!0},p(u,a){if(a&1){o=u[0].state.textures;let l;for(l=0;l<o.length;l+=1){const d=zi(u,o,l);r[l]?(r[l].p(d,a),P(r[l],1)):(r[l]=Ui(d),r[l].c(),P(r[l],1),r[l].m(e,null))}for(ye(),l=o.length;l<r.length;l+=1)s(l);ve()}(!n||a&1&&t!==(t=`grow-0 shrink-0 items-center justify-center content-center justify-items-center grid gap-2 ${u[0].state.animationsView==="grid"?"grid-rows-3 grid-cols-[repeat(3,_64px)] p-4":"grid-rows-1 grid-cols-[repeat(9,_64px)] p-2"} bg-neutral-900 border-b border-solid border-neutral-700`))&&f(e,"class",t)},i(u){if(!n){for(let a=0;a<o.length;a+=1)P(r[a]);n=!0}},o(u){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)V(r[a]);n=!1},d(u){u&&I(e),Ue(r,u)}}}function Ui(i){let e,t;function n(...o){return i[12](i[18],...o)}return e=new ul({props:{texture:i[16],textureIdx:i[18],onSetTextureProps:n}}),{c(){G(e.$$.fragment)},l(o){X(e.$$.fragment,o)},m(o,r){j(e,o,r),t=!0},p(o,r){i=o;const s={};r&1&&(s.texture=i[16]),r&1&&(s.onSetTextureProps=n),e.$set(s)},i(o){t||(P(e.$$.fragment,o),t=!0)},o(o){V(e.$$.fragment,o),t=!1},d(o){q(e,o)}}}function Gi(i){let e,t;return e=new Wl({props:{parentStateSelected:i[1],states:i[2],scripts:i[0].state.scripts,onRearrangeScripts:i[13],onEditScript:i[6],onDeleteScript:i[14]}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,o){const r={};o&2&&(r.parentStateSelected=n[1]),o&4&&(r.states=n[2]),o&1&&(r.scripts=n[0].state.scripts),o&1&&(r.onRearrangeScripts=n[13]),o&64&&(r.onEditScript=n[6]),o&1&&(r.onDeleteScript=n[14]),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Kl(i){let e,t,n,o,r,s,u,a,l,d,h,c=i[0].name+"",p,g,y,w,v,x,m,_,b,S,A,T,L,oe,ie;r=new ei({}),v=new Xo({}),b=new jo({});let M=!i[0].state.collapsed&&Qi(i),W=!i[0].state.collapsed&&Gi(i);return{c(){e=C("div"),t=C("button"),n=C("div"),o=C("button"),G(r.$$.fragment),u=H(),a=C("div"),l=pe("State:"),d=H(),h=C("div"),p=pe(c),g=H(),y=C("button"),w=C("div"),G(v.$$.fragment),x=H(),m=C("button"),_=C("div"),G(b.$$.fragment),A=H(),M&&M.c(),T=H(),W&&W.c(),this.h()},l(Q){e=k(Q,"DIV",{class:!0});var re=N(e);t=k(re,"BUTTON",{class:!0});var Y=N(t);n=k(Y,"DIV",{class:!0});var ae=N(n);o=k(ae,"BUTTON",{class:!0});var Ne=N(o);X(r.$$.fragment,Ne),Ne.forEach(I),u=K(ae),a=k(ae,"DIV",{class:!0});var z=N(a);l=fe(z,"State:"),z.forEach(I),d=K(ae),h=k(ae,"DIV",{class:!0});var R=N(h);p=fe(R,c),R.forEach(I),ae.forEach(I),g=K(Y),y=k(Y,"BUTTON",{class:!0});var ne=N(y);w=k(ne,"DIV",{class:!0});var de=N(w);X(v.$$.fragment,de),de.forEach(I),ne.forEach(I),x=K(Y),m=k(Y,"BUTTON",{class:!0});var U=N(m);_=k(U,"DIV",{class:!0});var se=N(_);X(b.$$.fragment,se),se.forEach(I),U.forEach(I),Y.forEach(I),A=K(re),M&&M.l(re),T=K(re),W&&W.l(re),re.forEach(I),this.h()},h(){f(o,"class",s=`hover:bg-neutral-500 hover:text-neutral-100 rounded-full grow-0 shrink-0 w-5 h-5 mr-2 transition-all duration-75 ${i[0].state.collapsed?"":"rotate-90"}`),f(a,"class","grow-0 shrink-0 overflow-hidden font-normal mr-1"),f(h,"class","grow-1 shrink-1 overflow-hidden text-ellipsis whitespace-nowrap"),f(n,"class","flex flex-row w-full grow-1 shrink-1 p-2 overflow-hidden font-bold"),f(w,"class","w-5 h-5"),f(y,"class","grow-0 shrink-0 p-2 hover:bg-neutral-500 hover:text-neutral-100 h-full"),f(_,"class","w-5 h-5"),f(m,"class","grow-0 shrink-0 p-2 hover:bg-neutral-500 hover:text-neutral-100 h-full"),f(t,"class",S=`${i[1]?"bg-neutral-100 text-neutral-900":"bg-neutral-800"} flex flex-row grow-0 shrink-0 w-full overflow-x-hidden text-left sticky z-[99999] top-0`),f(e,"class","grow-0 shrink-0 flex flex-col overflow-x-clip")},m(Q,re){F(Q,e,re),E(e,t),E(t,n),E(n,o),j(r,o,null),E(n,u),E(n,a),E(a,l),E(n,d),E(n,h),E(h,p),E(t,g),E(t,y),E(y,w),j(v,w,null),E(t,x),E(t,m),E(m,_),j(b,_,null),E(e,A),M&&M.m(e,null),E(e,T),W&&W.m(e,null),L=!0,oe||(ie=[B(o,"click",i[7]),B(y,"click",i[8]),B(m,"click",i[9]),B(e,"click",i[15])],oe=!0)},p(Q,[re]){(!L||re&1&&s!==(s=`hover:bg-neutral-500 hover:text-neutral-100 rounded-full grow-0 shrink-0 w-5 h-5 mr-2 transition-all duration-75 ${Q[0].state.collapsed?"":"rotate-90"}`))&&f(o,"class",s),(!L||re&1)&&c!==(c=Q[0].name+"")&&We(p,c),(!L||re&2&&S!==(S=`${Q[1]?"bg-neutral-100 text-neutral-900":"bg-neutral-800"} flex flex-row grow-0 shrink-0 w-full overflow-x-hidden text-left sticky z-[99999] top-0`))&&f(t,"class",S),Q[0].state.collapsed?M&&(ye(),V(M,1,1,()=>{M=null}),ve()):M?(M.p(Q,re),re&1&&P(M,1)):(M=Qi(Q),M.c(),P(M,1),M.m(e,T)),Q[0].state.collapsed?W&&(ye(),V(W,1,1,()=>{W=null}),ve()):W?(W.p(Q,re),re&1&&P(W,1)):(W=Gi(Q),W.c(),P(W,1),W.m(e,null))},i(Q){L||(P(r.$$.fragment,Q),P(v.$$.fragment,Q),P(b.$$.fragment,Q),P(M),P(W),L=!0)},o(Q){V(r.$$.fragment,Q),V(v.$$.fragment,Q),V(b.$$.fragment,Q),V(M),V(W),L=!1},d(Q){Q&&I(e),q(r),q(v),q(b),M&&M.d(),W&&W.d(),oe=!1,Ee(ie)}}}function Zl(i,e,t){let{isSelected:n=!1}=e,{states:o=void 0}=e,{onSelect:r=void 0}=e,{onRename:s=void 0}=e,{onDelete:u=void 0}=e,{onEditScript:a=void 0}=e,{item:l=void 0}=e;const d=()=>t(0,l.state.collapsed=!l.state.collapsed,l),h=m=>{m.stopPropagation(),s(l.name,l.state)},c=m=>{m.stopPropagation(),u(l.name,l.state)},p=()=>t(0,l.state.animationsCollapsed=!l.state.animationsCollapsed,l),g=m=>{m.stopPropagation(),l.state.animationsView==="grid"?t(0,l.state.animationsView="list",l):t(0,l.state.animationsView="grid",l)},y=(m,_)=>{l.state.setTexture(m,_),t(0,l)},w=m=>t(0,l.state.scripts=m,l),v=m=>{const _=[...l.state.scripts],b=_.indexOf(m);b!==-1&&_.splice(b,1),t(0,l.state.scripts=_,l)},x=()=>r(l.name,l.state);return i.$$set=m=>{"isSelected"in m&&t(1,n=m.isSelected),"states"in m&&t(2,o=m.states),"onSelect"in m&&t(3,r=m.onSelect),"onRename"in m&&t(4,s=m.onRename),"onDelete"in m&&t(5,u=m.onDelete),"onEditScript"in m&&t(6,a=m.onEditScript),"item"in m&&t(0,l=m.item)},[l,n,o,r,s,u,a,d,h,c,p,g,y,w,v,x]}class $l extends J{constructor(e){super(),ee(this,e,Zl,Kl,te,{isSelected:1,states:2,onSelect:3,onRename:4,onDelete:5,onEditScript:6,item:0})}}function Xi(i,e,t){const n=i.slice();return n[15]=e[t],n}function ji(i,e,t){const n=i.slice();return n[18]=e[t],n[20]=t,n}function Jl(i){return{c:D,l:D,m:D,p:D,i:D,o:D,d:D}}function ea(i){return{c:D,l:D,m:D,p:D,i:D,o:D,d:D}}function ta(i){let e,t;function n(...r){return i[11](i[18],...r)}function o(){return i[12](i[18])}return e=new Go({props:{currentValue:i[18].get(i[2]),onApply:n,onFocus:o,onBlur:i[13]}}),{c(){G(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){j(e,r,s),t=!0},p(r,s){i=r;const u={};s&4&&(u.currentValue=i[18].get(i[2])),s&4&&(u.onApply=n),s&256&&(u.onFocus=o),s&256&&(u.onBlur=i[13]),e.$set(u)},i(r){t||(P(e.$$.fragment,r),t=!0)},o(r){V(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function na(i){return{c:D,l:D,m:D,p:D,i:D,o:D,d:D}}function qi(i){let e,t,n=i[18].displayName+"",o,r,s,u,a,l,d,h;const c=[na,ta,ea,Jl],p=[];function g(y,w){return y[18].type==="int"?0:y[18].type==="float"?1:y[18].type==="key"?2:y[18].type==="state"?3:-1}return~(a=g(i))&&(l=p[a]=c[a](i)),{c(){e=C("div"),t=C("div"),o=pe(n),s=H(),u=C("div"),l&&l.c(),this.h()},l(y){e=k(y,"DIV",{class:!0,style:!0});var w=N(e);t=k(w,"DIV",{class:!0,style:!0});var v=N(t);o=fe(v,n),v.forEach(I),s=K(w),u=k(w,"DIV",{class:!0});var x=N(u);l&&l.l(x),x.forEach(I),w.forEach(I),this.h()},h(){f(t,"class",r=`grow-0 shrink-0 p-2 text-ellipsis whitespace-nowrap overflow-hidden w-48 transition-all ${i[18]===i[8]?"font-bold":""}`),f(t,"style",`color: ${xe[i[18].type].name}`),f(u,"class","grow-1 shrink-1 w-full overflow-hidden"),f(e,"class",`pl-16 flex flex-row grow-0 shrink-0 ${i[20]!==i[10].length-1?"border-b":"not-last:border-b"} border-solid border-neutral-700 transition-all`),f(e,"style",d=i[18]===i[8]?`background-color: ${xe[i[18].type].editor.background}3F;`:"")},m(y,w){F(y,e,w),E(e,t),E(t,o),E(e,s),E(e,u),~a&&p[a].m(u,null),h=!0},p(y,w){(!h||w&256&&r!==(r=`grow-0 shrink-0 p-2 text-ellipsis whitespace-nowrap overflow-hidden w-48 transition-all ${y[18]===y[8]?"font-bold":""}`))&&f(t,"class",r),l&&l.p(y,w),(!h||w&256&&d!==(d=y[18]===y[8]?`background-color: ${xe[y[18].type].editor.background}3F;`:""))&&f(e,"style",d)},i(y){h||(P(l),h=!0)},o(y){V(l),h=!1},d(y){y&&I(e),~a&&p[a].d()}}}function Hi(i){let e,t;return e=new $l({props:{isSelected:i[1]===i[15].state,states:i[0],onSelect:i[3],onRename:i[4],onDelete:i[5],onEditScript:i[6],item:i[15]}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,o){const r={};o&514&&(r.isSelected=n[1]===n[15].state),o&1&&(r.states=n[0]),o&8&&(r.onSelect=n[3]),o&16&&(r.onRename=n[4]),o&32&&(r.onDelete=n[5]),o&64&&(r.onEditScript=n[6]),o&512&&(r.item=n[15]),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function ia(i){let e,t,n,o,r,s,u,a,l,d,h,c,p=i[10],g=[];for(let m=0;m<p.length;m+=1)g[m]=qi(ji(i,p,m));const y=m=>V(g[m],1,1,()=>{g[m]=null});let w=i[9],v=[];for(let m=0;m<w.length;m+=1)v[m]=Hi(Xi(i,w,m));const x=m=>V(v[m],1,1,()=>{v[m]=null});return s=new Tu({}),{c(){e=C("div");for(let m=0;m<g.length;m+=1)g[m].c();t=H();for(let m=0;m<v.length;m+=1)v[m].c();n=H(),o=C("button"),r=C("div"),G(s.$$.fragment),u=H(),a=C("div"),l=pe("New State"),this.h()},l(m){e=k(m,"DIV",{class:!0});var _=N(e);for(let T=0;T<g.length;T+=1)g[T].l(_);t=K(_);for(let T=0;T<v.length;T+=1)v[T].l(_);n=K(_),o=k(_,"BUTTON",{class:!0});var b=N(o);r=k(b,"DIV",{class:!0});var S=N(r);X(s.$$.fragment,S),S.forEach(I),u=K(b),a=k(b,"DIV",{class:!0});var A=N(a);l=fe(A,"New State"),A.forEach(I),b.forEach(I),_.forEach(I),this.h()},h(){f(r,"class","grow-0 shrink-0 w-6 h-6 mr-2"),f(a,"class","grow-0 shrink-0"),f(o,"class","grow-0 shrink-0 flex flex-row items-center justify-center p-2 sticky z-[99999] bottom-0 bg-neutral-900 hover:bg-neutral-800 border-t border-solid border-neutral-700 transition-all font-bold w-full"),f(e,"class","grow-0 shrink-0 flex flex-col overflow-x-clip")},m(m,_){F(m,e,_);for(let b=0;b<g.length;b+=1)g[b].m(e,null);E(e,t);for(let b=0;b<v.length;b+=1)v[b].m(e,null);E(e,n),E(e,o),E(o,r),j(s,r,null),E(o,u),E(o,a),E(a,l),d=!0,h||(c=B(o,"click",function(){me(i[7])&&i[7].apply(this,arguments)}),h=!0)},p(m,[_]){if(i=m,_&1284){p=i[10];let b;for(b=0;b<p.length;b+=1){const S=ji(i,p,b);g[b]?(g[b].p(S,_),P(g[b],1)):(g[b]=qi(S),g[b].c(),P(g[b],1),g[b].m(e,t))}for(ye(),b=p.length;b<g.length;b+=1)y(b);ve()}if(_&635){w=i[9];let b;for(b=0;b<w.length;b+=1){const S=Xi(i,w,b);v[b]?(v[b].p(S,_),P(v[b],1)):(v[b]=Hi(S),v[b].c(),P(v[b],1),v[b].m(e,n))}for(ye(),b=w.length;b<v.length;b+=1)x(b);ve()}},i(m){if(!d){for(let _=0;_<p.length;_+=1)P(g[_]);for(let _=0;_<w.length;_+=1)P(v[_]);P(s.$$.fragment,m),d=!0}},o(m){g=g.filter(Boolean);for(let _=0;_<g.length;_+=1)V(g[_]);v=v.filter(Boolean);for(let _=0;_<v.length;_+=1)V(v[_]);V(s.$$.fragment,m),d=!1},d(m){m&&I(e),Ue(g,m),Ue(v,m),q(s),h=!1,c()}}}function oa(i,e,t){let{states:n=void 0}=e,{selectedState:o=void 0}=e,{selectedEntity:r=void 0}=e,{onSelectState:s=void 0}=e,{onRenameState:u=void 0}=e,{onDeleteState:a=void 0}=e,{onEditScript:l=void 0}=e,{onAddState:d=void 0}=e;const h=[{displayName:"Default Mass",get:x=>x.physicsProxy.mass,set:(x,m)=>x.setMass(m),type:"float"},{displayName:"Default Friction",get:x=>x.physicsProxy.friction,set:(x,m)=>x.physicsProxy.friction=m,type:"float"}];let c=null,p;function g(){t(9,p=[]);for(const[x,m]of n)p.push({name:x,state:m});O.alphabetSort(p)}const y=(x,m)=>x.set(r,m),w=x=>t(8,c=x),v=()=>t(8,c=void 0);return i.$$set=x=>{"states"in x&&t(0,n=x.states),"selectedState"in x&&t(1,o=x.selectedState),"selectedEntity"in x&&t(2,r=x.selectedEntity),"onSelectState"in x&&t(3,s=x.onSelectState),"onRenameState"in x&&t(4,u=x.onRenameState),"onDeleteState"in x&&t(5,a=x.onDeleteState),"onEditScript"in x&&t(6,l=x.onEditScript),"onAddState"in x&&t(7,d=x.onAddState)},i.$$.update=()=>{i.$$.dirty&1&&g()},[n,o,r,s,u,a,l,d,c,p,h,y,w,v]}class ra extends J{constructor(e){super(),ee(this,e,oa,ia,te,{states:0,selectedState:1,selectedEntity:2,onSelectState:3,onRenameState:4,onDeleteState:5,onEditScript:6,onAddState:7})}}class qo{constructor(e){this.domEvent=e}}class sa extends qo{constructor(e,t,n){super(e),this.x=t,this.y=n}}class Ho extends qo{constructor(e){super(e),this.altPressed=e.altKey,this.ctrlPressed=e.ctrlKey,this.metaPressed=e.metaKey,this.shiftPressed=e.shiftKey}}class ti extends Ho{constructor(e,t,n){super(e),this.x=t,this.y=n}asVec2(){return new he(this.x,this.y)}}class ua extends ti{constructor(e,t,n){super(e,t,n)}}class la extends ti{constructor(e){super(e,e.deltaX,e.deltaY)}}class Ko extends ti{constructor(e,t,n,o){super(e,t,n),this.button=e.button,this.pressed=o}}class aa extends Ko{constructor(e,t,n){super(e,t,n,!1)}}class da extends Ko{constructor(e,t,n){super(e,t,n,!0)}}class Zo extends Ho{constructor(e){super(e),this.key=e.key,this.down=e.type==="keydown",this.repeat=e.repeat}}class ca extends Zo{constructor(e){super(e)}}class ha extends Zo{constructor(e){super(e)}}class pa{constructor(e){this.deltaTime=e}}class fa{constructor(e){this.window=e}}class ga{constructor(e,t){this.w=e,this.h=t}}class ma extends Qt{constructor(e){super(e)}logMessageName(){return`(${this.debugName}@${this.id})`}logMessageNameNoId(){return`(${this.debugName})`}onMouseMove(e){return!1}onMouseScroll(e){return!1}onMouseDown(e){return!1}onMouseUp(e){return!1}onKeyDown(e){return!1}onKeyUp(e){return!1}onAppTick(e){return!1}onRender(e){return!1}onResize(e){return!1}onFocus(){}}class mn extends ma{constructor(e){super(e),this.window=window}onAttach(){}}class ya extends mn{constructor(){super("ScriptInputLayer"),this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.dragStartX=0,this.dragStartY=0,this.dragOffsetX=0,this.dragOffsetY=0,this.dragSpeed=1,this.offsetX=0,this.offsetY=0,this.leftMousePressed=!1,this.rightMousePressed=!1,this.cursor="grab",this.canDrag=!0}onMouseDown(e){(e.button===0||e.button===2)&&(this.dragStartX=this.mouseX,this.dragStartY=this.mouseY,this.leftMousePressed=e.button===0,e.button===2&&(this.rightMousePressed=!0,this.cursor="grabbing"))}onMouseUp(e){(e.button===0||e.button===2)&&(e.button===0&&(this.leftMousePressed=!1,this.offsetX+=this.dragOffsetX,this.offsetY+=this.dragOffsetY,this.cursor="grab"),e.button===2&&(this.rightMousePressed=!1),this.dragOffsetX=0,this.dragOffsetY=0)}onMouseMove(e){this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.mouseX=e.x,this.mouseY=e.y,this.canDrag&&this.leftMousePressed&&(this.dragOffsetX=(this.mouseX-this.dragStartX)*this.dragSpeed,this.dragOffsetY=(this.mouseY-this.dragStartY)*this.dragSpeed),this.cursor=this.leftMousePressed?"grabbing":"grab"}onRender(e){e.window.canvas.style.cursor=this.cursor}}const Je={int:1,float:2,number:3,array:4,object:8,bool:16,string:32,any:255};function va(i){switch(typeof i){case"number":return(Number.isInteger(i)?Je.int:0)|Je.float;case"object":return Array.isArray(i)?Je.array:Je.object;case"boolean":return Je.bool;case"string":return Je.string}}function $o(i,e){if(i.length!=e.length)return!1;for(var t=0;t<e.length;t++)if(!(va(i[t])&e[t]))return!1;return!0}class xa{constructor(e=[]){this.types=e.map(t=>t==="number"?Je.int|Je.float:Je[t]),this.length=this.types.length}}class Jt{constructor(e,t,n){this.name=e,this.typename=t,this.editorTypename=n||t}}class Jo{constructor(e,t,n,o){this.inputPorts=e,this.internalPorts=t,this.outputPorts=n,this.fn=o}}class er extends Qt{constructor(e,t,n,o,r,s,{internalPorts:u=[],internalValues:a=[],isExport:l=!1}={}){super(t),this.category=e,this.graph=n,this.data=new Jo(o,u,r,s),this.inputTypes=new xa(o.map(d=>d.typename)),this.outputs=[],this.active=!1,this.internalValues=a,this.isExport=l,this.isSource=!1}serialize(){return{type:this.debugName,internalValues:this.internalValues}}checkIndex(e,t){return t<-1||t>e.length?(this.logError(`Invalid index ${t}`),!1):!0}checkInputIndex(e){return this.checkIndex(this.inputTypes,e)}checkOutputIndex(e){return this.checkIndex(this.outputTypes,e)}attachBase(e,t){const n=this.graph.hasInputEdgeAt(e,t);n&&this.graph.removeEdge(n.outputNode,n.outputIndex,n.inputNode,n.inputIndex)}attachAsInput(e,t,n){this.attachBase(this,n),this.graph.addEdge(e,t,this,n)}attachAsOutput(e,t,n){this.attachBase(t,n),this.graph.addEdge(this,e,t,n)}run(e,t){if(!$o(e,this.inputTypes.types)){this.graph.pushError(`Invalid input to '${this.debugName}'`);return}const n=this.data.fn(e,{entity:t.entity,scene:t.entity.scene,input:t.inputCache,camera:t.camera,internal:this.internalValues,node:this})||[];this.outputs=n.map(s=>s.value);const o=this.graph.getEdges(this).out;for(var r=0;r<o.length;r++){const s=o[r];if(s.inputIndex===-1&&s.outputIndex===-1)s.inputNode.active=!0;else{const{active:u}=n[s.outputIndex];(u||!this.isSource&&u===void 0)&&(s.inputNode.active=!0),u===!1&&(s.inputNode.active=!1)}}}}class ni extends Jo{constructor(e,t,n,o,r,s=!1){super(n,[],o,r),this.category=e,this.name=t,this.isExport=s}createNode(e){return new er(this.category,this.name,e,this.inputPorts,this.outputPorts,this.fn,{isExport:this.isExport})}}class wa extends ni{constructor(e,t,n){super(e,t,[],n,(o,{node:r})=>r.outputs.map(s=>({value:s,activate:!0})),!1)}}class ii extends ni{constructor(e,t,n,o,r,s,u,a=!1){super(e,t,n,s,u,a),this.internalPorts=o,this.defaultValues=r,this.internalTypes=o.map(l=>Je[l.typename])}createNode(e,t){if(t=t||[...this.defaultValues],!$o(t,this.internalTypes)){console.error("Invalid inputs"),console.log(t,this.internalPorts,this.internalTypes);return}return new er(this.category,this.name,e,this.inputPorts,this.outputPorts,this.fn,{internalPorts:this.internalPorts,internalValues:t,isExport:this.isExport})}}class _a extends ii{constructor(e,t,n,o){super(e,t,[],n,o,n,(r,{internal:s})=>s.map(u=>({value:u,activate:!1})))}}class Ia extends ii{constructor(e,t,n,o,r,s,u,a){super(e,t,[],[new Jt("name","string"),new Jt(n,r,s),...u],["export",o,...a],[new Jt(n,r)],(l,{internal:d})=>[{value:d[1]}],!0)}}const wt={all:{bgColor:"#d4d4d4",borderColor:"#737373"},logic:{bgColor:"#0ea5e9",borderColor:"#0369a1"},event:{bgColor:"#eab308",borderColor:"#a16207"},input:{bgColor:"#eab308",borderColor:"#a16207"},math:{bgColor:"#f59e0b",borderColor:"#b45309"},entity:{bgColor:"#22c55e",borderColor:"#15803d"}};class ba{constructor(){this.bank=new Map,this.init()}getNodeTypeNames(){return[...this.bank.keys()].sort()}get(e){return this.bank.get(e)}mapPorts(e){return e.map(([t,n,o])=>new Jt(t,n,o))}create(e,t,n,o,r){this.bank.set(t,new ni(e,t,this.mapPorts(n),this.mapPorts(o),r))}createEvent(e,t,n){this.bank.set(t,new wa(e,t,this.mapPorts(n)))}createInternal(e,t,n,o,r,s,u){this.bank.set(t,new ii(e,t,this.mapPorts(n),this.mapPorts(o),r,this.mapPorts(s),u))}createConstant(e,t,n,o){this.bank.set(t,new _a(e,t,this.mapPorts(n),o))}createExport(e,t,n,o,r,{additionalPorts:s=[],additionalValues:u=[],valueEditorType:a=r}={}){this.bank.set(t,new Ia(e,t,n,o,r,a,this.mapPorts(s),u))}init(){this.createEntity(),this.createEvents(),this.createInput(),this.createLogic(),this.createMath(),this.createExports(),this.createInternal("logic","__debug",[],[["msg","string"]],["debug"],[],(e,{internal:t,entity:n})=>{n.logInfo(t[0])})}createEvents(){this.createEvent("event","OnTick",[]),this.createEvent("event","OnRender",[]),this.createEvent("event","OnCollide",[["normal","object"],["entity","object"]]),this.createEvent("event","OnSwitch",[])}createInput(){this.createInternal("input","KeyPressed",[],[["key","string","key"]],["A"],[["T","bool"],["F","bool"],["int","int"]],(e,{internal:t,input:n})=>{const o=n.isKeyPressed(t[0]);return[{value:o,active:o},{value:!o,active:!o},{value:~~o}]}),this.create("input","VarKeyPressed",[["key","string"]],[["T","bool"],["F","bool"],["int","int"]],([e],{input:t})=>{const n=t.isKeyPressed(e);return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("input","MouseScroll",[],[["v","object"]],(e,{input:t})=>[{value:t.mouseScroll}])}createMath(){this.createConstant("math","ConstInt",[["int","int"]],[0]),this.createConstant("math","ConstFloat",[["float","float"]],[0]),this.create("math","Subtract",[["a","number"],["b","number"]],[["a-b","number"]],([e,t])=>[{value:e-t}]),this.create("math","Multiply",[["a","number"],["b","number"]],[["a*b","number"]],([e,t])=>[{value:e*t}]),this.create("math","Min",[["a","number"],["b","number"]],[["min","number"]],([e,t])=>[{value:Math.min(e,t)}]),this.create("math","Max",[["a","number"],["b","number"]],[["max","number"]],([e,t])=>[{value:Math.max(e,t)}]),this.create("math","Clamp",[["x","number"],["min","number"],["max","number"]],[["clamped","number"]],([e,t,n])=>[{value:O.clamp(e,t,n)}]),this.create("math","Negative",[["x","number"]],[["-x","number"]],([e])=>[{value:-e}]),this.create("math","Equals",[["a","number"],["b","number"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e==t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.createInternal("math","EqualsConst",[["a","number"]],[["b","number"]],[0],[["T","bool"],["F","bool"],["int","int"]],([e],{internal:t})=>{const n=e==t[0];return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("math","Greater",[["a","number"],["b","number"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e>t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("math","GreaterEquals",[["a","number"],["b","number"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e>=t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("math","Less",[["a","number"],["b","number"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e<t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.createInternal("math","LessConst",[["a","number"]],[["b","number"]],[0],[["T","bool"],["F","bool"],["int","int"]],([e],{internal:t})=>{const n=e<t[0];return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.createInternal("math","Less#",[["a","number"]],[["b","number"]],[0],[["T","bool"],["F","bool"],["int","int"]],([e],{internal:t})=>{const n=e<t[0];return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("math","LessEquals",[["a","number"],["b","number"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e<=t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("math","IsZero",[["a","number"]],[["T","bool"],["F","bool"],["int","int"]],([e])=>{const t=Math.abs(e)<=O.epsilon;return[{value:t,active:t},{value:!t,active:!t},{value:~~t}]}),this.create("math","IsNonZero",[["a","number"]],[["T","bool"],["F","bool"],["int","int"]],([e])=>{const t=Math.abs(e)>O.epsilon;return[{value:t,active:t},{value:!t,active:!t},{value:~~t}]}),this.create("math","PrintVec2",[["v","object"]],[],([e])=>{console.log(e)}),this.create("math","Vec2",[["x","number"],["y","number"]],[["v","object"]],([e,t])=>[{value:new he(e,t)}]),this.create("math","Vec2Components",[["v","object"]],[["x","number"],["y","number"]],([e])=>[{value:e.x},{value:e.y}]),this.create("math","ScaleVec2",[["v","object"],["s","number"]],[["v","object"]],([e,t])=>[{value:e.scale(t)}]),this.create("math","ClampVec2",[["v","object"],["min","number"],["max","number"]],[["v","object"]],([e,t,n])=>{const o=e.lengthSquared();return o<t*t?e.normalize().scaleEqual(t):o>n*n&&e.normalize().scaleEqual(n),[{value:e}]}),this.create("math","Normalize",[["v","object"]],[["n","object"]],([e])=>[{value:e.norm()}]),this.create("math","Vec2Equals",[["v1","object"],["v2","object"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e.equals(t);return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.createInternal("math","ConstVec2",[],[["x","number"],["y","number"]],[0,0],[["v","object"]],(e,{internal:t})=>[{value:new he(t[0],t[1])}])}createLogic(){this.create("logic","AND",[["a","any"],["b","any"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e&&t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("logic","OR",[["a","any"],["b","any"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e||t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("logic","XOR",[["a","any"],["b","any"]],[["T","bool"],["F","bool"],["int","int"]],([e,t])=>{const n=e^t;return[{value:n,active:n},{value:!n,active:!n},{value:~~n}]}),this.create("logic","NOT",[["a","any"]],[["T","bool"],["F","bool"],["int","int"]],([e])=>{const t=!e;return[{value:t,active:t},{value:!t,active:!t},{value:~~t}]}),this.create("logic","Mux2",[["index","int"],["0","any"],["1","any"]],[["out","any"]],([e,t,n])=>[{value:e?n:t}])}createEntity(){this.create("entity","GetControlledEntity",[],[["entity","object"]],(e,{entity:t})=>[{value:t}]),this.create("entity","SetEntityVelocity",[["entity","object"],["v","object"]],[],([e,t])=>{e.setVelocity&&e.setVelocity(t)}),this.create("entity","SetEntityVelocityX",[["entity","object"],["x","number"]],[],([e,t])=>{e.setVelocity&&e.setVelocityX(t)}),this.create("entity","SetEntityVelocityY",[["entity","object"],["y","number"]],[],([e,t])=>{e.setVelocity&&e.setVelocityY(t)}),this.create("entity","ApplyEntityForce",[["entity","object"],["force","object"]],[],([e,t])=>{e.applyForce(t)}),this.create("entity","GetEntityVelocity",[["entity","object"]],[["v","object"]],([e])=>{const{x:t,y:n}=e.getVelocity();return[{value:new he(t,n)}]}),this.create("entity","GetEntityVelocityX",[["entity","object"]],[["x","number"]],([e])=>[{value:e.physicsProxy.velocity.x}]),this.create("entity","GetControlledEntityVelocityX",[],[["x","number"]],(e,{entity:t})=>[{value:t.physicsProxy.velocity.x}]),this.create("entity","ControlledVelX",[],[["x","number"]],(e,{entity:t})=>[{value:t.physicsProxy.velocity.x}]),this.create("entity","GetEntityVelocityY",[["entity","object"]],[["y","number"]],([e])=>[{value:e.physicsProxy.velocity.y}]),this.create("entity","GetEntityVelocityXY",[["entity","object"]],[["x","number"],["y","number"]],([e])=>{const{x:t,y:n}=e.getVelocity();return console.log(t,n),[{value:t},{value:n}]}),this.create("entity","SetEntityScale",[["entity","object"],["scale","number"]],[],([e,t])=>{e.setScale(t)}),this.create("entity","SetEntityState",[["entity","object"],["state","string"]],[],([e,t])=>{e.setState(t)}),this.create("entity","DestroyEntity",[["entity","object"]],[],([e],{scene:t})=>{t.removeControlledEntity(e)}),this.create("entity","GetEntityPosition",[["entity","object"]],[["pos","object"]],([e])=>[{value:e.pos}]),this.create("entity","SetCameraPosition",[["pos","object"]],[],([e],{camera:t})=>{t.setPosition(e)}),this.create("entity","SetCameraZoom",[["zoom","number"]],[],([e],{camera:t})=>{t.setZoom(e)}),this.create("entity","SetEntityAnimation",[["entity","object"],["index","int"]],[],([e,t])=>{e.setAnimationIndex&&e.setAnimationIndex(t)}),this.createInternal("entity","SetEntityAnimationConst",[["entity","object"]],[["index","int"]],[4],[],([e],{internal:t})=>{e.setAnimationIndex&&e.setAnimationIndex(t[0])}),this.create("entity","SetControlledEntityAnimation",[["index","int"]],[],([e],{entity:t})=>{t.setAnimationIndex&&t.setAnimationIndex(e)}),this.createInternal("entity","SetControlledEntityAnimationConst",[],[["index","int"]],[4],[],(e,{entity:t,internal:n})=>{t.setAnimationIndex&&t.setAnimationIndex(n[0])}),this.createInternal("entity","SetControlledAnimation#",[],[["index","int"]],[4],[],(e,{entity:t,internal:n})=>{t.setAnimationIndex&&t.setAnimationIndex(n[0])})}createExports(){this.createExport("math","ExportInt","value",0,"int"),this.createExport("math","ExportIntRange","value",0,"int",{additionalPorts:[["min","int"],["max","int"]],additionalValues:[0,10]}),this.createExport("math","ExportFloat","value",0,"float"),this.createExport("input","ExportKey","key","A","string",{valueEditorType:"key"}),this.createExport("entity","ExportState","state","---","string",{valueEditorType:"state"})}}const Rn=new ba,{window:Ea}=lr;function Na(i){let e,t,n,o,r,s;const u=i[9].default,a=fo(u,i,i[8],null);return{c(){e=C("div"),t=C("div"),a&&a.c(),this.h()},l(l){e=k(l,"DIV",{class:!0});var d=N(e);t=k(d,"DIV",{class:!0,style:!0});var h=N(t);a&&a.l(h),h.forEach(I),d.forEach(I),this.h()},h(){f(t,"class","bg-neutral-800 text-neutral-100 drop-shadow-xl absolute"),f(t,"style",n=`border: 2px solid rgba(212, 212, 212, ${i[6]}); left: ${i[0]}px; top: ${i[1]}px; width: ${i[2]}; height: ${i[3]};`),f(e,"class","fixed left-0 top-0 w-full h-full overflow-hidden")},m(l,d){F(l,e,d),E(e,t),a&&a.m(t,null),o=!0,r||(s=[B(Ea,"resize",function(){me(i[5])&&i[5].apply(this,arguments)}),B(t,"pointerdown",Sa),B(e,"pointerdown",i[10])],r=!0)},p(l,[d]){i=l,a&&a.p&&(!o||d&256)&&go(a,u,i,i[8],o?yo(u,i[8],d,null):mo(i[8]),null),(!o||d&79&&n!==(n=`border: 2px solid rgba(212, 212, 212, ${i[6]}); left: ${i[0]}px; top: ${i[1]}px; width: ${i[2]}; height: ${i[3]};`))&&f(t,"style",n)},i(l){o||(P(a,l),o=!0)},o(l){V(a,l),o=!1},d(l){l&&I(e),a&&a.d(l),r=!1,Ee(s)}}}const Sa=i=>{i.stopPropagation()};function Ca(i,e,t){let{$$slots:n={},$$scope:o}=e,{x:r=null,y:s=null}=e,{width:u=null,height:a=null}=e,{computeReposition:l=null}=e,{onDestroyPopup:d=null}=e,{borderAlphaVarying:h=null}=e,c=null,p=null;function g(){p=window.requestAnimationFrame(g),t(6,c=h.getValue())}qe(()=>{p=window.requestAnimationFrame(g)}),Qn(()=>{window.cancelAnimationFrame(p),p=null});const y=w=>{if(w.preventDefault(),w.stopPropagation(),w.button===2){const v=l(w.clientX,w.clientY);v&&(t(0,r=v.x),t(1,s=v.y))}else d()};return i.$$set=w=>{"x"in w&&t(0,r=w.x),"y"in w&&t(1,s=w.y),"width"in w&&t(2,u=w.width),"height"in w&&t(3,a=w.height),"computeReposition"in w&&t(4,l=w.computeReposition),"onDestroyPopup"in w&&t(5,d=w.onDestroyPopup),"borderAlphaVarying"in w&&t(7,h=w.borderAlphaVarying),"$$scope"in w&&t(8,o=w.$$scope)},[r,s,u,a,l,d,c,h,o,n,y]}class ka extends J{constructor(e){super(),ee(this,e,Ca,Na,te,{x:0,y:1,width:2,height:3,computeReposition:4,onDestroyPopup:5,borderAlphaVarying:7})}}function Ki(i,e,t){const n=i.slice();return n[17]=e[t],n}function Zi(i,e,t){const n=i.slice();return n[20]=e[t],n}function $i(i,e,t){const n=i.slice();return n[17]=e[t],n}function Ji(i){let e,t=`${i[17].name[0].toUpperCase()}${i[17].name.slice(1)}`,n,o,r,s,u;function a(){return i[15](i[17])}return{c(){e=C("button"),n=pe(t),o=H(),this.h()},l(l){e=k(l,"BUTTON",{class:!0,style:!0});var d=N(e);n=fe(d,t),o=K(d),d.forEach(I),this.h()},h(){f(e,"class","p-2 cursor-pointer hover:bg-neutral-700 focus:bg-neutral-700 outline-0 border-l-4 border-solid text-left transition-all"),f(e,"style",r=`border-color: ${i[17].borderColor}; color: ${i[17].bgColor}; ${i[9]===i[17].name?`background-color: ${i[17].bgColor}; color: #171717; font-weight: 700;`:""}`)},m(l,d){F(l,e,d),E(e,n),E(e,o),s||(u=B(e,"click",a),s=!0)},p(l,d){i=l,d&1024&&t!==(t=`${i[17].name[0].toUpperCase()}${i[17].name.slice(1)}`)&&We(n,t),d&1536&&r!==(r=`border-color: ${i[17].borderColor}; color: ${i[17].bgColor}; ${i[9]===i[17].name?`background-color: ${i[17].bgColor}; color: #171717; font-weight: 700;`:""}`)&&f(e,"style",r)},d(l){l&&I(e),s=!1,u()}}}function eo(i){let e,t=i[17].nodeNames,n=[];for(let o=0;o<t.length;o+=1)n[o]=to(Zi(i,t,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=ct()},l(o){for(let r=0;r<n.length;r+=1)n[r].l(o);e=ct()},m(o,r){for(let s=0;s<n.length;s+=1)n[s].m(o,r);F(o,e,r)},p(o,r){if(r&1120){t=o[17].nodeNames;let s;for(s=0;s<t.length;s+=1){const u=Zi(o,t,s);n[s]?n[s].p(u,r):(n[s]=to(u),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(o){Ue(n,o),o&&I(e)}}}function to(i){let e,t,n,o,r,s=i[20].name+"",u,a,l,d;function h(){return i[16](i[20])}return{c(){e=C("button"),t=C("div"),o=H(),r=C("div"),u=pe(s),a=H(),this.h()},l(c){e=k(c,"BUTTON",{class:!0});var p=N(e);t=k(p,"DIV",{class:!0,style:!0}),N(t).forEach(I),o=K(p),r=k(p,"DIV",{class:!0});var g=N(r);u=fe(g,s),g.forEach(I),a=K(p),p.forEach(I),this.h()},h(){f(t,"class","grow-0 shrink-0 mr-2 w-[8px] h-[8px] rounded-full"),f(t,"style",n=`background-color: ${i[20].dotColor}`),f(r,"class","grow-1 shrink-1 overflow-hidden whitespace-nowrap text-ellipsis"),f(e,"class","flex flex-row items-center p-2 cursor-pointer hover:bg-neutral-700 focus:bg-neutral-700 outline-0 text-left")},m(c,p){F(c,e,p),E(e,t),E(e,o),E(e,r),E(r,u),E(e,a),l||(d=B(e,"click",h),l=!0)},p(c,p){i=c,p&1024&&n!==(n=`background-color: ${i[20].dotColor}`)&&f(t,"style",n),p&1024&&s!==(s=i[20].name+"")&&We(u,s)},d(c){c&&I(e),l=!1,d()}}}function no(i){let e,t=i[17].name===i[9]&&eo(i);return{c(){t&&t.c(),e=ct()},l(n){t&&t.l(n),e=ct()},m(n,o){t&&t.m(n,o),F(n,e,o)},p(n,o){n[17].name===n[9]?t?t.p(n,o):(t=eo(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){t&&t.d(n),n&&I(e)}}}function Da(i){let e,t,n,o,r,s,u,a,l,d,h,c,p,g,y;u=new Jn({});let w=i[10],v=[];for(let _=0;_<w.length;_+=1)v[_]=Ji($i(i,w,_));let x=i[10],m=[];for(let _=0;_<x.length;_+=1)m[_]=no(Ki(i,x,_));return{c(){e=C("div"),t=C("div"),n=C("input"),o=H(),r=C("div"),s=C("div"),G(u.$$.fragment),a=H(),l=C("div"),d=C("div");for(let _=0;_<v.length;_+=1)v[_].c();h=H(),c=C("div");for(let _=0;_<m.length;_+=1)m[_].c();this.h()},l(_){e=k(_,"DIV",{class:!0,tabindex:!0});var b=N(e);t=k(b,"DIV",{class:!0});var S=N(t);n=k(S,"INPUT",{placeholder:!0,class:!0}),o=K(S),r=k(S,"DIV",{class:!0});var A=N(r);s=k(A,"DIV",{class:!0});var T=N(s);X(u.$$.fragment,T),T.forEach(I),A.forEach(I),S.forEach(I),a=K(b),l=k(b,"DIV",{class:!0});var L=N(l);d=k(L,"DIV",{class:!0});var oe=N(d);for(let M=0;M<v.length;M+=1)v[M].l(oe);oe.forEach(I),h=K(L),c=k(L,"DIV",{class:!0});var ie=N(c);for(let M=0;M<m.length;M+=1)m[M].l(ie);ie.forEach(I),L.forEach(I),b.forEach(I),this.h()},h(){f(n,"placeholder","Search..."),f(n,"class","grow-1 shrink-1 p-2 pl-8 w-full min-w-0 border-0 outline-none bg-neutral-800"),f(s,"class","w-5 h-5"),f(r,"class","absolute w-8 h-10 flex items-center justify-center text-neutral-500 pointer-events-none"),f(t,"class","grow-0 shrink-0 flex flex-row border-b border-solid border-neutral-700 h-10"),f(d,"class","flex flex-col grow-0 shrink-0 w-[160px] h-full border-r border-solid border-neutral-700 overflow-x-hidden overflow-y-auto"),f(c,"class","flex flex-col grow-1 shrink-1 w-full h-full flex flex-col overflow-x-hidden overflow-y-auto"),f(l,"class","flex flex-row grow-1 shrink-1 w-full h-full overflow-hidden"),f(e,"class","flex flex-col w-full h-full overflow-hidden"),f(e,"tabindex",0)},m(_,b){F(_,e,b),E(e,t),E(t,n),i[13](n),Ae(n,i[8]),E(t,o),E(t,r),E(r,s),j(u,s,null),E(e,a),E(e,l),E(l,d);for(let S=0;S<v.length;S+=1)v[S].m(d,null);E(l,h),E(l,c);for(let S=0;S<m.length;S+=1)m[S].m(c,null);p=!0,g||(y=[B(n,"input",i[14]),B(n,"keydown",Ta),B(e,"keydown",i[12])],g=!0)},p(_,b){if(b&256&&n.value!==_[8]&&Ae(n,_[8]),b&1536){w=_[10];let S;for(S=0;S<w.length;S+=1){const A=$i(_,w,S);v[S]?v[S].p(A,b):(v[S]=Ji(A),v[S].c(),v[S].m(d,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=w.length}if(b&1632){x=_[10];let S;for(S=0;S<x.length;S+=1){const A=Ki(_,x,S);m[S]?m[S].p(A,b):(m[S]=no(A),m[S].c(),m[S].m(c,null))}for(;S<m.length;S+=1)m[S].d(1);m.length=x.length}},i(_){p||(P(u.$$.fragment,_),p=!0)},o(_){V(u.$$.fragment,_),p=!1},d(_){_&&I(e),i[13](null),q(u),Ue(v,_),Ue(m,_),g=!1,Ee(y)}}}function Pa(i){let e,t;return e=new ka({props:{x:i[0],y:i[1],computeReposition:i[4],onDestroyPopup:i[5],borderAlphaVarying:i[7],width:`${i[2]}px`,height:`${i[3]}px`,$$slots:{default:[Da]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&1&&(r.x=n[0]),o&2&&(r.y=n[1]),o&16&&(r.computeReposition=n[4]),o&32&&(r.onDestroyPopup=n[5]),o&128&&(r.borderAlphaVarying=n[7]),o&4&&(r.width=`${n[2]}px`),o&8&&(r.height=`${n[3]}px`),o&33558368&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}const Ta=i=>i.stopPropagation();function Va(i,e,t){let{x:n=void 0,y:o=void 0}=e,{width:r=void 0,height:s=void 0}=e,{computeReposition:u=void 0}=e,{onDestroyPopup:a=void 0}=e,{onAddNode:l=void 0}=e,{borderAlphaVarying:d=void 0}=e,h="",c,p="all",g=[];qe(()=>{c.focus()});function y(_){_.key==="Escape"?a():(t(8,h=""),c.focus())}function w(_){Oe[_?"unshift":"push"](()=>{c=_,t(11,c)})}function v(){h=this.value,t(8,h)}const x=_=>{t(9,p=_.name)},m=_=>{l(_.name),a()};return i.$$set=_=>{"x"in _&&t(0,n=_.x),"y"in _&&t(1,o=_.y),"width"in _&&t(2,r=_.width),"height"in _&&t(3,s=_.height),"computeReposition"in _&&t(4,u=_.computeReposition),"onDestroyPopup"in _&&t(5,a=_.onDestroyPopup),"onAddNode"in _&&t(6,l=_.onAddNode),"borderAlphaVarying"in _&&t(7,d=_.borderAlphaVarying)},i.$$.update=()=>{if(i.$$.dirty&1792){const _=Rn.getNodeTypeNames(),b=h.trim().replace(/\s/g,"").toLowerCase();if(b.length>0)for(let T=0;T<_.length;++T)_[T].toLowerCase().indexOf(b)===-1&&(_.splice(T,1),--T);const S=new Map;S.set("all",{bgColor:wt.all.bgColor,borderColor:wt.all.borderColor,nodeNames:[]});const A=S.get("all");for(const T of _){const L=Rn.get(T);S.has(L.category)||S.set(L.category,{bgColor:wt[L.category].bgColor,borderColor:wt[L.category].borderColor,nodeNames:[]}),S.get(L.category).nodeNames.push({dotColor:wt[L.category].bgColor,name:T}),A.nodeNames.push({dotColor:wt[L.category].bgColor,name:T})}S.has(p)||t(9,p="all"),t(10,g=[]);for(const[T,L]of S)g.push({name:T,...L});O.alphabetSort(g)}},[n,o,r,s,u,a,l,d,h,p,g,c,y,w,v,x,m]}class Aa extends J{constructor(e){super(),ee(this,e,Va,Pa,te,{x:0,y:1,width:2,height:3,computeReposition:4,onDestroyPopup:5,onAddNode:6,borderAlphaVarying:7})}get x(){return this.$$.ctx[0]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[1]}set y(e){this.$$set({y:e}),$()}get width(){return this.$$.ctx[2]}set width(e){this.$$set({width:e}),$()}get height(){return this.$$.ctx[3]}set height(e){this.$$set({height:e}),$()}get computeReposition(){return this.$$.ctx[4]}set computeReposition(e){this.$$set({computeReposition:e}),$()}get onDestroyPopup(){return this.$$.ctx[5]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get onAddNode(){return this.$$.ctx[6]}set onAddNode(e){this.$$set({onAddNode:e}),$()}get borderAlphaVarying(){return this.$$.ctx[7]}set borderAlphaVarying(e){this.$$set({borderAlphaVarying:e}),$()}}function Oa(i){let e,t,n,o,r,s;const u=i[8].default,a=fo(u,i,i[7],null);return{c(){e=C("div"),t=C("div"),a&&a.c(),this.h()},l(l){e=k(l,"DIV",{class:!0});var d=N(e);t=k(d,"DIV",{class:!0,style:!0});var h=N(t);a&&a.l(h),h.forEach(I),d.forEach(I),this.h()},h(){f(t,"class","drop-shadow-xl absolute"),f(t,"style",n=`left: ${i[0]}px; top: ${i[1]}px; width: ${i[2]}; height: ${i[3]}; background-color: ${i[4]}; color: ${i[5]};`),f(e,"class","fixed left-0 top-0 w-full h-full overflow-hidden")},m(l,d){F(l,e,d),E(e,t),a&&a.m(t,null),o=!0,r||(s=[B(window,"resize",function(){me(i[6])&&i[6].apply(this,arguments)}),B(t,"pointerdown",Ra),B(e,"pointerdown",i[9])],r=!0)},p(l,[d]){i=l,a&&a.p&&(!o||d&128)&&go(a,u,i,i[7],o?yo(u,i[7],d,null):mo(i[7]),null),(!o||d&63&&n!==(n=`left: ${i[0]}px; top: ${i[1]}px; width: ${i[2]}; height: ${i[3]}; background-color: ${i[4]}; color: ${i[5]};`))&&f(t,"style",n)},i(l){o||(P(a,l),o=!0)},o(l){V(a,l),o=!1},d(l){l&&I(e),a&&a.d(l),r=!1,Ee(s)}}}const Ra=i=>{i.stopPropagation()};function La(i,e,t){let{$$slots:n={},$$scope:o}=e,{x:r=null,y:s=null}=e,{width:u=null,height:a=null}=e,{bgColor:l=null}=e,{fgColor:d=null}=e,{onDestroyPopup:h=null}=e;const c=p=>{p.preventDefault(),p.stopPropagation(),h()};return i.$$set=p=>{"x"in p&&t(0,r=p.x),"y"in p&&t(1,s=p.y),"width"in p&&t(2,u=p.width),"height"in p&&t(3,a=p.height),"bgColor"in p&&t(4,l=p.bgColor),"fgColor"in p&&t(5,d=p.fgColor),"onDestroyPopup"in p&&t(6,h=p.onDestroyPopup),"$$scope"in p&&t(7,o=p.$$scope)},[r,s,u,a,l,d,h,o,n,c]}class kt extends J{constructor(e){super(),ee(this,e,La,Oa,te,{x:0,y:1,width:2,height:3,bgColor:4,fgColor:5,onDestroyPopup:6})}}function Ma(i){let e,t,n,o,r;return{c(){e=C("input"),this.h()},l(s){e=k(s,"INPUT",{placeholder:!0,class:!0,style:!0}),this.h()},h(){e.value="",f(e,"placeholder",t=O.keyToDisplayStr(i[0])),f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1qebqft"),f(e,"style",n=`--placeholder-color: ${i[5]};`)},m(s,u){F(s,e,u),i[10](e),o||(r=B(e,"keydown",i[8]),o=!0)},p(s,u){u&1&&t!==(t=O.keyToDisplayStr(s[0]))&&f(e,"placeholder",t),u&32&&n!==(n=`--placeholder-color: ${s[5]};`)&&f(e,"style",n)},d(s){s&&I(e),i[10](null),o=!1,r()}}}function Fa(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[Ma]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&2209&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Ba(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,d=null;function h(){return l.length>0}function c(g){g.preventDefault(),g.stopPropagation(),t(0,l=g.key.length===1?g.key.toUpperCase():g.key),a()}qe(()=>{d.focus()});function p(g){Oe[g?"unshift":"push"](()=>{d=g,t(7,d)})}return i.$$set=g=>{"x"in g&&t(1,n=g.x),"y"in g&&t(2,o=g.y),"bgColor"in g&&t(3,r=g.bgColor),"fgColor"in g&&t(4,s=g.fgColor),"placeholderColor"in g&&t(5,u=g.placeholderColor),"onDestroyPopup"in g&&t(6,a=g.onDestroyPopup),"currentValue"in g&&t(0,l=g.currentValue)},[l,n,o,r,s,u,a,d,c,h,p]}class za extends J{constructor(e){super(),ee(this,e,Ba,Fa,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0,validate:9})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}get validate(){return this.$$.ctx[9]}}function Qa(i){let e,t,n,o;return{c(){e=C("input"),this.h()},l(r){e=k(r,"INPUT",{placeholder:!0,class:!0,style:!0}),this.h()},h(){f(e,"placeholder",i[0]),f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1qebqft"),f(e,"style",t=`--placeholder-color: ${i[5]};`)},m(r,s){F(r,e,s),i[9](e),Ae(e,i[0]),n||(o=[B(e,"keydown",i[10]),B(e,"input",i[11])],n=!0)},p(r,s){s&1&&f(e,"placeholder",r[0]),s&32&&t!==(t=`--placeholder-color: ${r[5]};`)&&f(e,"style",t),s&1&&e.value!==r[0]&&Ae(e,r[0])},d(r){r&&I(e),i[9](null),n=!1,Ee(o)}}}function Ya(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[Qa]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&4321&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Wa(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,d=null;function h(){return!isNaN(parseInt(l))}qe(()=>{d.focus()});function c(y){Oe[y?"unshift":"push"](()=>{d=y,t(7,d)})}const p=y=>{y.key==="Enter"&&a()};function g(){l=this.value,t(0,l)}return i.$$set=y=>{"x"in y&&t(1,n=y.x),"y"in y&&t(2,o=y.y),"bgColor"in y&&t(3,r=y.bgColor),"fgColor"in y&&t(4,s=y.fgColor),"placeholderColor"in y&&t(5,u=y.placeholderColor),"onDestroyPopup"in y&&t(6,a=y.onDestroyPopup),"currentValue"in y&&t(0,l=y.currentValue)},i.$$.update=()=>{if(i.$$.dirty&1&&l!==""){const y=parseInt(l);isNaN(y)||t(0,l=y)}},[l,n,o,r,s,u,a,d,h,c,p,g]}class io extends J{constructor(e){super(),ee(this,e,Wa,Ya,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0,validate:8})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}get validate(){return this.$$.ctx[8]}}function Ua(i){let e,t,n,o,r,s,u,a,l;return{c(){e=C("select"),t=C("option"),n=pe("True"),o=C("option"),r=pe("False"),this.h()},l(d){e=k(d,"SELECT",{class:!0,style:!0});var h=N(e);t=k(h,"OPTION",{class:!0});var c=N(t);n=fe(c,"True"),c.forEach(I),o=k(h,"OPTION",{class:!0});var p=N(o);r=fe(p,"False"),p.forEach(I),h.forEach(I),this.h()},h(){t.__value="true",t.value=t.__value,f(t,"class","svelte-1qebqft"),o.__value="false",o.value=o.__value,f(o,"class","svelte-1qebqft"),f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-0 bg-inherit text-inherit svelte-1qebqft"),f(e,"style",u=`--placeholder-color: ${i[5]};`)},m(d,h){F(d,e,h),E(e,t),E(t,n),E(e,o),E(o,r),dt(e,i[0]?"true":"false"),i[8](e),a||(l=B(e,"change",i[9]),a=!0)},p(d,h){h&1&&s!==(s=d[0]?"true":"false")&&dt(e,d[0]?"true":"false"),h&32&&u!==(u=`--placeholder-color: ${d[5]};`)&&f(e,"style",u)},d(d){d&&I(e),i[8](null),a=!1,l()}}}function Ga(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[Ua]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&1249&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Xa(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,d=null;qe(()=>{d.focus()});function h(p){Oe[p?"unshift":"push"](()=>{d=p,t(7,d)})}const c=p=>{t(0,l=p.target.value==="true"),a()};return i.$$set=p=>{"x"in p&&t(1,n=p.x),"y"in p&&t(2,o=p.y),"bgColor"in p&&t(3,r=p.bgColor),"fgColor"in p&&t(4,s=p.fgColor),"placeholderColor"in p&&t(5,u=p.placeholderColor),"onDestroyPopup"in p&&t(6,a=p.onDestroyPopup),"currentValue"in p&&t(0,l=p.currentValue)},[l,n,o,r,s,u,a,d,h,c]}class ja extends J{constructor(e){super(),ee(this,e,Xa,Ga,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}}function qa(i){let e,t,n,o;return{c(){e=C("input"),this.h()},l(r){e=k(r,"INPUT",{placeholder:!0,class:!0,style:!0}),this.h()},h(){f(e,"placeholder",i[0]),f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1qebqft"),f(e,"style",t=`--placeholder-color: ${i[5]};`)},m(r,s){F(r,e,s),i[9](e),Ae(e,i[0]),n||(o=[B(e,"keydown",i[10]),B(e,"input",i[11])],n=!0)},p(r,s){s&1&&f(e,"placeholder",r[0]),s&32&&t!==(t=`--placeholder-color: ${r[5]};`)&&f(e,"style",t),s&1&&e.value!==r[0]&&Ae(e,r[0])},d(r){r&&I(e),i[9](null),n=!1,Ee(o)}}}function Ha(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[qa]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&4321&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Ka(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,d=null;function h(){return!isNaN(parseFloat(l))}qe(()=>{d.focus()});function c(y){Oe[y?"unshift":"push"](()=>{d=y,t(7,d)})}const p=y=>{y.key==="Enter"&&a()};function g(){l=this.value,t(0,l)}return i.$$set=y=>{"x"in y&&t(1,n=y.x),"y"in y&&t(2,o=y.y),"bgColor"in y&&t(3,r=y.bgColor),"fgColor"in y&&t(4,s=y.fgColor),"placeholderColor"in y&&t(5,u=y.placeholderColor),"onDestroyPopup"in y&&t(6,a=y.onDestroyPopup),"currentValue"in y&&t(0,l=y.currentValue)},i.$$.update=()=>{if(i.$$.dirty&1&&l!==""){const y=parseFloat(l);isNaN(y)||t(0,l=y)}},[l,n,o,r,s,u,a,d,h,c,p,g]}class In extends J{constructor(e){super(),ee(this,e,Ka,Ha,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0,validate:8})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}get validate(){return this.$$.ctx[8]}}function oo(i,e,t){const n=i.slice();return n[15]=e[t],n}function ro(i){let e,t=i[15].name+"",n,o;return{c(){e=C("option"),n=pe(t),this.h()},l(r){e=k(r,"OPTION",{class:!0});var s=N(e);n=fe(s,t),s.forEach(I),this.h()},h(){e.__value=o=i[15].name,e.value=e.__value,f(e,"class","svelte-1qebqft")},m(r,s){F(r,e,s),E(e,n)},p(r,s){s&128&&t!==(t=r[15].name+"")&&We(n,t),s&128&&o!==(o=r[15].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&I(e)}}}function Za(i){let e,t,n,o,r=i[7],s=[];for(let u=0;u<r.length;u+=1)s[u]=ro(oo(i,r,u));return{c(){e=C("select");for(let u=0;u<s.length;u+=1)s[u].c();this.h()},l(u){e=k(u,"SELECT",{class:!0,style:!0});var a=N(e);for(let l=0;l<s.length;l+=1)s[l].l(a);a.forEach(I),this.h()},h(){f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-0 bg-inherit text-inherit svelte-1qebqft"),f(e,"style",t=`--placeholder-color: ${i[5]};`)},m(u,a){F(u,e,a);for(let l=0;l<s.length;l+=1)s[l].m(e,null);dt(e,i[0]),i[11](e),n||(o=B(e,"change",i[12]),n=!0)},p(u,a){if(a&128){r=u[7];let l;for(l=0;l<r.length;l+=1){const d=oo(u,r,l);s[l]?s[l].p(d,a):(s[l]=ro(d),s[l].c(),s[l].m(e,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=r.length}a&1&&dt(e,u[0]),a&32&&t!==(t=`--placeholder-color: ${u[5]};`)&&f(e,"style",t)},d(u){u&&I(e),Ue(s,u),i[11](null),n=!1,o()}}}function $a(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[Za]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&262625&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Ja(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,{states:d=null}=e,h=null,c=[];function p(){t(7,c=[]);for(const[x,m]of d)c.push({name:x,state:m});O.alphabetSort(c)}function g(x){return d.has(x)}function y(){return g(l)}qe(()=>{h.focus()});function w(x){Oe[x?"unshift":"push"](()=>{h=x,t(8,h),t(7,c)})}const v=x=>{t(0,l=x.target.value),a()};return i.$$set=x=>{"x"in x&&t(1,n=x.x),"y"in x&&t(2,o=x.y),"bgColor"in x&&t(3,r=x.bgColor),"fgColor"in x&&t(4,s=x.fgColor),"placeholderColor"in x&&t(5,u=x.placeholderColor),"onDestroyPopup"in x&&t(6,a=x.onDestroyPopup),"currentValue"in x&&t(0,l=x.currentValue),"states"in x&&t(9,d=x.states)},i.$$.update=()=>{i.$$.dirty&640&&(p(),y()||(c.length>0?t(0,l=c[0].name):t(0,l="")))},[l,n,o,r,s,u,a,c,h,d,y,w,v]}class so extends J{constructor(e){super(),ee(this,e,Ja,$a,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0,states:9,validate:10})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}get states(){return this.$$.ctx[9]}set states(e){this.$$set({states:e}),$()}get validate(){return this.$$.ctx[10]}}function ed(i){let e,t,n,o;return{c(){e=C("input"),this.h()},l(r){e=k(r,"INPUT",{class:!0,style:!0}),this.h()},h(){f(e,"class","grow-1 shrink-1 p-2 w-full min-w-0 border-0 outline-none bg-inherit text-inherit svelte-1qebqft"),f(e,"style",t=`--placeholder-color: ${i[5]};`)},m(r,s){F(r,e,s),i[8](e),Ae(e,i[0]),n||(o=[B(e,"input",i[9]),B(e,"change",function(){me(i[6])&&i[6].apply(this,arguments)})],n=!0)},p(r,s){i=r,s&32&&t!==(t=`--placeholder-color: ${i[5]};`)&&f(e,"style",t),s&1&&e.value!==i[0]&&Ae(e,i[0])},d(r){r&&I(e),i[8](null),n=!1,Ee(o)}}}function td(i){let e,t;return e=new kt({props:{x:i[1],y:i[2],bgColor:i[3],fgColor:i[4],onDestroyPopup:i[6],width:"96px",height:"auto",$$slots:{default:[ed]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,[o]){const r={};o&2&&(r.x=n[1]),o&4&&(r.y=n[2]),o&8&&(r.bgColor=n[3]),o&16&&(r.fgColor=n[4]),o&64&&(r.onDestroyPopup=n[6]),o&1249&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function nd(i,e,t){let{x:n=null,y:o=null,bgColor:r=null,fgColor:s=null,placeholderColor:u=null}=e,{onDestroyPopup:a=null}=e,{currentValue:l=null}=e,d=null;qe(()=>{d.focus()});function h(p){Oe[p?"unshift":"push"](()=>{d=p,t(7,d)})}function c(){l=this.value,t(0,l)}return i.$$set=p=>{"x"in p&&t(1,n=p.x),"y"in p&&t(2,o=p.y),"bgColor"in p&&t(3,r=p.bgColor),"fgColor"in p&&t(4,s=p.fgColor),"placeholderColor"in p&&t(5,u=p.placeholderColor),"onDestroyPopup"in p&&t(6,a=p.onDestroyPopup),"currentValue"in p&&t(0,l=p.currentValue)},[l,n,o,r,s,u,a,d,h,c]}class id extends J{constructor(e){super(),ee(this,e,nd,td,te,{x:1,y:2,bgColor:3,fgColor:4,placeholderColor:5,onDestroyPopup:6,currentValue:0})}get x(){return this.$$.ctx[1]}set x(e){this.$$set({x:e}),$()}get y(){return this.$$.ctx[2]}set y(e){this.$$set({y:e}),$()}get bgColor(){return this.$$.ctx[3]}set bgColor(e){this.$$set({bgColor:e}),$()}get fgColor(){return this.$$.ctx[4]}set fgColor(e){this.$$set({fgColor:e}),$()}get placeholderColor(){return this.$$.ctx[5]}set placeholderColor(e){this.$$set({placeholderColor:e}),$()}get onDestroyPopup(){return this.$$.ctx[6]}set onDestroyPopup(e){this.$$set({onDestroyPopup:e}),$()}get currentValue(){return this.$$.ctx[0]}set currentValue(e){this.$$set({currentValue:e}),$()}}class od extends mn{constructor(e,t,n,o){super("ScriptLayer"),this.input=e,this.controls=t,this.script=n,this.selectedEntityStates=o,this.capturedLeftClick=!1,this.graphvis=void 0,this.selected=void 0,this.selectedX=0,this.selectedY=0,this.hovered=void 0}setScript(e){this.script=e,this.graphvis&&(this.graphvis.graph=this.script)}onAttach(){this.graphvis=new Du(this.window,this.script),this.graphvis.arrange()}onMouseScroll(){this.checkIntersection()&&(this.input.cursor="default")}handleMouseDown(e){const t=this.checkIntersection(),{edge:n}=this.checkEdgeIntersection();if(t&&(this.input.cursor="default"),this.input.leftMousePressed){if(this.selected&&(this.selected.selected=!1),this.setSelected(t||n),this.selected?(this.selectedX=this.selected.x,this.selectedY=this.selected.y):this.selectedPort=void 0,t){this.input.canDrag=!1,this.capturedLeftClick=!0;const o=t.checkPortIntersection(this.window,...this.inverseTransformCoords(this.input.mouseX,this.input.mouseY));o&&(o.internal?(e.domEvent.preventDefault(),e.domEvent.stopPropagation(),this.createEditorPopup(t,o),this.selectedPort=void 0,t.hoveredPort=-1):this.selectedPort=o)}}else(e.button===2||e.button===0&&this.window.inputCache.isKeyPressed("Control"))&&!t?(e.domEvent.preventDefault(),e.domEvent.stopPropagation(),this.createAddNodeMenuPopup()):e.button===1&&(t||n)&&this.deleteProxy(t||n);return t||n}onFocus(e){return this.input.mouseX=e.x,this.input.mouseY=e.y,this.handleMouseDown(e)}onMouseDown(e){return this.handleMouseDown(e)}onMouseUp(e){if(this.input.canDrag=!0,e.button===0){if(this.capturedLeftClick){const t=this.checkIntersection();if(t){this.input.cursor="default";const n=t.checkPortIntersection(this.window,...this.inverseTransformCoords(this.input.mouseX,this.input.mouseY));n&&!n.internal&&(this.selectedPort&&this.selectedPort.in^n.in?(this.selectedPort.in&&!this.graphvis.graph.hasInputEdgeAt(this.selectedPort.node,n.index)?this.selectedPort.node.attachAsInput(n.node,n.index,this.selectedPort.index):this.graphvis.graph.hasOutputEdgeAt(this.selectedPort.node,n.index)||this.selectedPort.node.attachAsOutput(this.selectedPort.index,n.node,n.index),this.graphvis.recompile(),this.selectedPort=void 0):!n.port&&n.node!==this.selectedPort.node?(this.selectedPort.node.attachAsOutput(this.selectedPort.index,n.node,n.index),this.graphvis.recompile(),this.selectedPort=void 0):this.selectedPort=n,this.selectedPort=void 0)}}this.capturedLeftClick=!1,this.selectedPort=void 0}}onMouseMove(){if(this.capturedLeftClick&&!this.selectedPort&&this.selected&&this.input.leftMousePressed){this.controls.setTransform(this.window.ctx);const[o,r]=this.inverseTransformCoords(this.input.mouseX,this.input.mouseY),[s,u]=this.inverseTransformCoords(this.input.lastMouseX,this.input.lastMouseY);this.selected.x+=o-s,this.selected.y+=r-u}const{index:e,edge:t}=this.checkEdgeIntersection(),n=this.checkIntersection();if(e>-1)this.input.cursor="default",this.hovered=t;else if(n){this.input.cursor="default",this.hovered=n;const o=n.checkPortIntersection(this.window,...this.inverseTransformCoords(this.input.mouseX,this.input.mouseY));o&&o.internal?(n.hoveredPort=o.index,this.input.cursor="pointer"):n.hoveredPort=-1}else this.hovered=void 0;return this.capturedLeftClick&&n}async onKeyDown(e){if(!e.repeat&&e.ctrlPressed&&e.shiftPressed&&e.key.toLowerCase()==="o"){e.domEvent.preventDefault();let t=null;try{[t]=await window.showOpenFilePicker({types:[{description:"JS file",accept:{"text/javascript":[".js"]}}]})}catch{return}const o=await(await t.getFile()).text(),r=JSON.parse(o.replace("export default ",""));this.graphvis.graph.deserialize(r),this.graphvis.arrange()}if(!e.repeat&&e.ctrlPressed&&e.key.toLowerCase()==="s"&&(e.domEvent.preventDefault(),this.graphvis.arrange(),e.shiftPressed)){let t=null;try{t=await window.showSaveFilePicker({types:[{description:"JS file",accept:{"text/javascript":[".js"]}}]})}catch{return}this.graphvis.graph.debugName=t.name.split(".")[0];const n=await t.createWritable(),o="export default "+JSON.stringify(this.graphvis.graph.serialize(),null,2);await n.write(o),await n.close()}this.selected&&(e.key==="Backspace"||e.key==="Delete")&&this.deleteProxy(this.selected)}onRender(e){if(e.window.ctx.resetTransform(),e.window.clear(),this.controls.setTransform(e.window.ctx),this.graphvis.draw(e.window,this.controls.zoom),this.selectedPort){const{x:t,y:n}=this.selectedPort.in?this.selectedPort.proxy.getInPortCoords(this.selectedPort.index):this.selectedPort.proxy.getOutPortCoords(this.selectedPort.index);this.window.drawLine(t,n,...this.inverseTransformCoords(this.input.mouseX,this.input.mouseY),this.selectedPort.color,2)}}checkIntersection(){let e;return this.graphvis.proxies.forEach(t=>{if(e)return;const[n,o]=this.transformCoords(t.x,t.y),[r,s]=this.transformDims(t.w,t.h);O.rectIntersect(this.input.mouseX,this.input.mouseY,n,o,r,s)?(e=t,t.hovered=!0):t.hovered=!1}),e}checkEdgeIntersection(){let e=-1,t;return this.graphvis.edgeProxies.forEach((n,o)=>{const{x:r,y:s}=n.getStartCoords(),{x:u,y:a}=n.getEndCoords(),[l,d]=this.transformCoords(r,s),[h,c]=this.transformCoords(u,a),p=new he(l,d),y=new he(l-h,d-c).perpendicular().norm(),w=y.dot(p),v=new he(this.input.mouseX,this.input.mouseY),x=y.dot(v)-w;e===-1&&Math.abs(x)<=10&&v.x>=Math.min(h,l)&&v.x<=Math.max(h,l)?(e=o,t=n,n.hovered=!0):n.hovered=!1}),{index:e,edge:t}}transformCoords(e,t){const n=this.controls.setTransform(this.window.ctx);let[o,r]=this.window.scaleCoords(e,t);return o=n.a*o+n.e,r=n.d*r+n.f,[o,r]}inverseTransformCoords(e,t){const n=this.controls.setTransform(this.window.ctx),o=(e-n.e)/n.a,r=(t-n.f)/n.d,s=this.window.getScalingFactor();return[Math.floor(o/s),Math.floor(r/s)]}transformDims(e,t){const n=this.controls.setTransform(this.window.ctx);let[o,r]=this.window.scaleDims(e,t);return o*=n.a,r*=n.d,[o,r]}createPopup(e,t){this.capturedLeftClick=!1;const n=this,o=this.window.canvas,{beforeDestroyPopup:r,...s}=t({mouseX:n.input.mouseX,mouseY:n.input.mouseY,canvas:o});let u=!1;const a=new e({target:document.body,props:{...s,onDestroyPopup:()=>{u||(u=!0,r&&r(a),a.$destroy(),o.focus())}}});return a}createAddNodeMenuPopup(){this.selected&&(this.selected.deselect(),this.selected=void 0);const e=this;return this.createPopup(Aa,({mouseX:t,mouseY:n,canvas:o})=>{const r=o.getBoundingClientRect(),s=400,u=320,a=O.clamp(r.left+t/window.devicePixelRatio,r.left,r.right-s),l=O.clamp(r.top+n/window.devicePixelRatio,r.top,r.bottom-u);return{x:a,y:l,width:s/window.devicePixelRatio,height:u/window.devicePixelRatio,borderAlphaVarying:e.graphvis.outlineAlpha,computeReposition:(d,h)=>{if(d>r.left&&d<r.right&&h>r.top&&h<r.bottom){const c=O.clamp(d,r.left,r.right-s),p=O.clamp(h,r.top,r.bottom-u);return e.input.mouseX=(d-r.left)*window.devicePixelRatio,e.input.mouseY=(h-r.top)*window.devicePixelRatio,{x:c,y:p}}else return null},onAddNode:d=>{const h=e.graphvis.graph.createNode(d);e.graphvis.recompile();const c=e.graphvis.proxies.get(h.id),[p,g]=e.inverseTransformCoords(e.input.mouseX,e.input.mouseY);c.x=p,c.y=g,e.setSelected(c)}}})}createEditorPopup(e,t){const[n,o]=this.getCreateEditorPopupInfo(e,t);return this.createPopup(n,o)}getCreateEditorPopupInfo(e,t){const o={key:za,int:io,string:id,bool:ja,float:In,number:In,state:so}[t.port.editorTypename],r={proxy:e,port:t};return[o,s=>this.getPortEditorProps(o,{...s,...r})]}getPortEditorProps(e,t){const{x:n,y:o}=t.proxy.getInternalPortCoords(t.port.index,this.window),[r,s]=this.transformCoords(n,o),u=t.canvas.getBoundingClientRect(),a=this;let l={};return e===so&&(l={states:this.selectedEntityStates}),{...l,x:u.left+r/window.devicePixelRatio,y:u.top+s/window.devicePixelRatio,bgColor:xe[t.port.port.typename].editor.background,fgColor:xe[t.port.port.typename].editor.foreground,placeholderColor:xe[t.port.port.typename].editor.placeholder,currentValue:e===io||e===In?null:t.proxy.node.internalValues[t.port.index],beforeDestroyPopup:d=>{(!d.validate||d.validate())&&(t.proxy.node.internalValues[t.port.index]=d.currentValue,t.proxy.computeNodeWidth(a.window),a.graphvis.recompile()),t.proxy.deselect()}}}setSelected(e){this.selected=e,this.selected&&this.selected.select()}deleteProxy(e){if(e instanceof Uo){const t=e.endProxy.node,n=e.endPort,o=e.startProxy.node,r=e.startPort;this.graphvis.graph.removeEdge(o,r,t,n),this.graphvis.graph.removeEdge(t,n,o,r),this.graphvis.recompile()}else this.graphvis.graph.removeNode(e.node),this.graphvis.recompile();this.selected=void 0}}function rd(){let i=new xt(9);return xt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}class sd extends mn{constructor(e){super("ScriptLayerControls"),this.input=e,this.zoom=1,this.maxZoom=2,this.minZoom=.5,this.zoomSpeed=.0025,this.viewProj=rd()}onMouseScroll(e){this.zoom-=e.y*this.zoomSpeed*(this.zoom/this.maxZoom),this.zoom=O.clamp(this.zoom,this.minZoom,this.maxZoom),this.input.dragSpeed=1/this.zoom}setTransform(e){const t=this.zoom,n=e.canvas.width,o=e.canvas.height,r=this.input.offsetX+this.input.dragOffsetX,s=this.input.offsetY+this.input.dragOffsetY;return e.setTransform(t,0,0,t,(1-t)*(n/2)+t*r,(1-t)*(o/2)+t*s),e.getTransform()}}class ud{constructor(e){this.element=e,this.keys=new Map,this.mouseButton=-1,this.mousePos=new he(0,0),this.mouseScroll=new he(0,0),this.element.addEventListener("keydown",t=>{this.keys.set(t.key.toLowerCase(),!0)}),this.element.addEventListener("keyup",t=>{this.keys.set(t.key.toLowerCase(),!1)}),this.element.addEventListener("pointermove",t=>{const n=this.element.getBoundingClientRect();this.mousePos=new he((t.clientX-n.x)*(t.target.width/n.width),(t.clientY-n.y)*(t.target.height/n.height))}),this.element.addEventListener("pointerdown",t=>{this.element.setPointerCapture(t.pointerId),this.mouseButton=t.button}),this.element.addEventListener("pointerup",t=>{this.element.releasePointerCapture(t.pointerId),this.mouseButton=-1}),this.element.addEventListener("wheel",t=>{this.mouseScroll=new he(Math.sign(t.deltaX),Math.sign(t.deltaY))})}isKeyPressed(e){const t=e.toLowerCase();return this.keys.has(t)&&this.keys.get(t)}isMouseLeft(){return this.mouseButton===0}isMouseRight(){return this.mouseButton===2}}class tr{constructor(e,t){this.layers=[],this.inputCache=void 0,this.clearColor=t||void 0,this.canvas=void 0,this.setCanvas(e)}clear(){}setCanvas(e){this.canvas!==e&&(this.canvas=e,this.inputCache=new ud(this.canvas),this.canvas.addEventListener("focus",t=>{const n=this.canvas.getBoundingClientRect(),o=(O.mouseX-n.x)*(t.target.width/n.width),r=(O.mouseY-n.y)*(t.target.height/n.height);this.propagateEvent("onFocus",new sa(t,o,r))}),this.canvas.addEventListener("keydown",t=>{this.propagateEvent("onKeyDown",new ca(t))}),this.canvas.addEventListener("keyup",t=>{this.propagateEvent("onKeyUp",new ha(t))}),this.canvas.addEventListener("pointermove",t=>{const n=this.canvas.getBoundingClientRect(),o=(t.clientX-n.x)*(t.target.width/n.width),r=(t.clientY-n.y)*(t.target.height/n.height);this.propagateEvent("onMouseMove",new ua(t,o,r))}),this.canvas.addEventListener("pointerdown",t=>{this.canvas.focus({focusVisible:!0}),this.canvas.setPointerCapture(t.pointerId),this.propagateEvent("onMouseDown",new da(t,this.inputCache.mousePos.x,this.inputCache.mousePos.y))}),this.canvas.addEventListener("pointerup",t=>{this.canvas.releasePointerCapture(t.pointerId),this.propagateEvent("onMouseUp",new aa(t,this.inputCache.mousePos.x,this.inputCache.mousePos.y))}),this.canvas.addEventListener("wheel",t=>{this.propagateEvent("onMouseScroll",new la(t))}),this.canvas.addEventListener("contextmenu",t=>{t.preventDefault(),t.stopPropagation()}))}pushLayer(e){this.layers.push(e),e.window=this,e.onAttach()}removeLayer(e){this.layers=this.layers.filter(t=>t.debugName!==e.debugName)}propagateEvent(e,t){for(var n=this.layers.length-1;n>=0&&!this.layers[n][e](t);n--);}propagateResizeEvent(){this.propagateEvent("onResize",new ga(this.canvas.width,this.canvas.height))}update(e){this.propagateEvent("onAppTick",new pa(e)),this.propagateEvent("onRender",new fa(this)),this.inputCache.mouseScroll.x=this.inputCache.mouseScroll.y=0}}function uo(i,e,t,n,o,r,s,u){i.beginPath(),i.moveTo(e+r,t),i.lineTo(e+n-r,t),i.quadraticCurveTo(e+n,t,e+n,t+r),i.lineTo(e+n,t+o-r),i.quadraticCurveTo(e+n,t+o,e+n-r,t+o),i.lineTo(e+r,t+o),i.quadraticCurveTo(e,t+o,e,t+o-r),i.lineTo(e,t+r),i.quadraticCurveTo(e,t,e+r,t),s&&i.fill(),u&&i.stroke(),i.closePath()}class Ln extends tr{constructor(e,t,{doScaling:n=!0}={}){super(e,t),this.doScaling=n}setCanvas(e){super.setCanvas(e),!this.ctx&&(this.ctx=e.getContext("2d"))}clear(){const e=this.canvas.width,t=this.canvas.height;this.clearColor?(this.ctx.fillStyle=this.clearColor,this.ctx.fillRect(0,0,e,t)):this.ctx.clearRect(0,0,e,t)}setCompositeOperation(e){this.ctx.globalCompositeOperation=e}resetCompositeOperation(){this.ctx.globalCompositeOperation="source-over"}drawLine(e,t,n,o,r,s){const u=this.ctx.lineWidth;this.ctx.lineWidth=s;const[a,l]=this.scaleCoords(e,t),[d,h]=this.scaleCoords(n,o);this.ctx.strokeStyle=r,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(a,l),this.ctx.lineTo(d,h),this.ctx.stroke(),this.ctx.closePath(),this.ctx.lineWidth=u}drawTransparentLine(e,t,n,o,r,s,u){const a=this.ctx.lineWidth;this.ctx.lineWidth=s;const l=this.ctx.globalAlpha;this.ctx.globalAlpha=u,this.drawLine(e,t,n,o,r,s),this.ctx.globalAlpha=l,this.ctx.lineWidth=a}drawRect(e,t,n,o,r){const[s,u]=this.scaleCoords(e,t),[a,l]=this.scaleDims(n,o);this.ctx.fillStyle=r,this.ctx.fillRect(s,u,a,l)}strokeRect(e,t,n,o,r,s){const u=this.ctx.lineWidth;this.ctx.lineWidth=s;const[a,l]=this.scaleCoords(e,t),[d,h]=this.scaleDims(n,o);this.ctx.strokeStyle=r,this.ctx.strokeRect(a,l,d,h),this.ctx.lineWidth=u}drawTransparentRect(e,t,n,o,r,s){const u=this.ctx.globalAlpha;this.ctx.globalAlpha=s,this.drawRect(e,t,n,o,r),this.ctx.globalAlpha=u}strokeTransparentRect(e,t,n,o,r,s,u){const a=this.ctx.lineWidth;this.ctx.lineWidth=s;const l=this.ctx.globalAlpha;this.ctx.globalAlpha=u;const[d,h]=this.scaleCoords(e,t),[c,p]=this.scaleDims(n,o);this.ctx.strokeStyle=r,this.ctx.strokeRect(d,h,c,p),this.ctx.lineWidth=a,this.ctx.globalAlpha=l}drawImage(e,t,n,o,r){this.ctx.drawImage(e,t,n,o,r)}strokeRoundRect(e,t,n,o,r,s,u,a){const l=this.ctx.globalAlpha,[d,h]=this.scaleCoords(e,t),[c,p]=this.scaleDims(n,o),[g]=this.scaleDims(r);this.ctx.strokeStyle=s,this.ctx.lineWidth=u,this.ctx.globalAlpha=a,uo(this.ctx,d,h,c,p,g,!1,!0),this.ctx.globalAlpha=l}drawRoundRect(e,t,n,o,r,s){const[u,a]=this.scaleCoords(e,t),[l,d]=this.scaleDims(n,o),[h]=this.scaleDims(r);this.ctx.fillStyle=s,uo(this.ctx,u,a,l,d,h,!0,!1)}drawRoundRectShadow(e,t,n,o,r,s,u,a){const[l,d]=this.scaleDims(u,a);this.ctx.shadowBlur=l,this.ctx.shadowOffsetY=d,this.ctx.shadowColor=s,this.drawRoundRect(e,t,n,o,r,s),this.ctx.shadowBlur=0,this.ctx.shadowOffsetY=0,this.ctx.shadowColor="transparent"}strokeArc(e,t,n,o,r,s){const[u,a]=this.scaleCoords(e,t),[l]=this.scaleDims(n);this.ctx.strokeStyle=s,this.ctx.beginPath(),this.ctx.arc(u,a,l,o,r),this.ctx.stroke(),this.ctx.closePath()}drawArc(e,t,n,o,r,s){const[u,a]=this.scaleCoords(e,t),[l]=this.scaleDims(n);this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(u,a,l,o,r),this.ctx.fill(),this.ctx.closePath()}drawTransparentArc(e,t,n,o,r,s,u){const a=this.ctx.globalAlpha;this.ctx.globalAlpha=u;const[l,d]=this.scaleCoords(e,t),[h]=this.scaleDims(n);this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(l,d,h,o,r),this.ctx.fill(),this.ctx.closePath(),this.ctx.globalAlpha=a}drawText(e,t,n,o,r,s){this.ctx.font=`${this.scaleFontSize(r)}px ${o}`,this.ctx.fillStyle=s,this.ctx.textBaseline="top";const[u,a]=this.scaleCoords(t,n);this.ctx.fillText(e,u,a)}rotate(e,t,n){this.ctx.translate(e,t),this.ctx.rotate(n),this.ctx.translate(-e,-t)}drawVerticalCenteredText(e,t,n,o,r,s,u={}){this.ctx.font=`${this.scaleFontSize(r)}px ${o}`,this.ctx.fillStyle=s,this.ctx.textBaseline="middle";const[a,l]=this.scaleCoords(t,n);u.theta&&this.rotate(a,l,u.theta),this.ctx.fillText(e,a,l),u.theta&&this.rotate(a,l,-u.theta)}drawCenteredText(e,t,n,o,r,s,u={}){this.ctx.font=`${this.scaleFontSize(r)}px ${o}`,this.ctx.fillStyle=s,this.ctx.textBaseline="middle";const[a,l]=this.scaleCoords(t,n);u.theta&&this.rotate(a,l,u.theta),this.ctx.fillText(e,a-this.ctx.measureText(e).width/2,l),u.theta&&this.rotate(a,l,-u.theta)}textMetrics(e,t,n){return this.ctx.font=`${n}px ${t}`,this.ctx.measureText(e)}getScalingFactor(){if(!this.doScaling)return 1;const e=this.canvas.width/O.canvas.targetWidth,t=this.canvas.height/O.canvas.targetHeight;return Math.min(e,t)}scaleCoords(e,t){const n=this.getScalingFactor();return[e*n,t*n]}scaleDims(e,t){const n=this.getScalingFactor();return[e*n,t*n]}scaleFontSize(e){return this.getScalingFactor()*e}}function ld(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 24 24"),f(e,"fill","currentColor"),f(e,"class","w-6 h-6")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class ad extends J{constructor(e){super(),ee(this,e,null,ld,te,{})}}function dd(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 24 24"),f(e,"fill","currentColor"),f(e,"class","w-6 h-6")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class cd extends J{constructor(e){super(),ee(this,e,null,dd,te,{})}}function hd(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=N(e);t=le(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"fill-rule","evenodd"),f(t,"d","M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z"),f(t,"clip-rule","evenodd"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 24 24"),f(e,"fill","currentColor"),f(e,"class","w-6 h-6")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class pd extends J{constructor(e){super(),ee(this,e,null,hd,te,{})}}function lo(i,e,t){const n=i.slice();return n[5]=e[t],n}function fd(i){let e,t;return e=new cd({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function gd(i){let e,t;return e=new ad({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function ao(i){let e,t,n,o,r,s,u=i[5].message+"",a,l,d,h;const c=[gd,fd],p=[];function g(y,w){return y[5].level==="error"?0:y[5].level==="warning"?1:-1}return~(n=g(i))&&(o=p[n]=c[n](i)),{c(){e=C("div"),t=C("div"),o&&o.c(),r=H(),s=C("span"),a=pe(u),this.h()},l(y){e=k(y,"DIV",{class:!0,style:!0});var w=N(e);t=k(w,"DIV",{class:!0});var v=N(t);o&&o.l(v),v.forEach(I),r=K(w),s=k(w,"SPAN",{class:!0});var x=N(s);a=fe(x,u),x.forEach(I),w.forEach(I),this.h()},h(){f(t,"class","inline-block w-6 h-6 mr-2"),f(s,"class","overflow-hidden text-ellipsis"),f(e,"class",l=`${Mn} ${i[3][i[5].level]}`),f(e,"style",d=i[4][i[5].level])},m(y,w){F(y,e,w),E(e,t),~n&&p[n].m(t,null),E(e,r),E(e,s),E(s,a),h=!0},p(y,w){let v=n;n=g(y),n!==v&&(o&&(ye(),V(p[v],1,1,()=>{p[v]=null}),ve()),~n?(o=p[n],o||(o=p[n]=c[n](y),o.c()),P(o,1),o.m(t,null)):o=null),(!h||w&1)&&u!==(u=y[5].message+"")&&We(a,u),(!h||w&1&&l!==(l=`${Mn} ${y[3][y[5].level]}`))&&f(e,"class",l),(!h||w&1&&d!==(d=y[4][y[5].level]))&&f(e,"style",d)},i(y){h||(P(o),h=!0)},o(y){V(o),h=!1},d(y){y&&I(e),~n&&p[n].d()}}}function co(i){let e,t,n,o,r,s,u,a;return n=new pd({}),{c(){e=C("div"),t=C("div"),G(n.$$.fragment),o=H(),r=C("span"),s=pe("Compiled successfully!"),this.h()},l(l){e=k(l,"DIV",{class:!0,style:!0});var d=N(e);t=k(d,"DIV",{class:!0});var h=N(t);X(n.$$.fragment,h),h.forEach(I),o=K(d),r=k(d,"SPAN",{class:!0});var c=N(r);s=fe(c,"Compiled successfully!"),c.forEach(I),d.forEach(I),this.h()},h(){f(t,"class","inline-block w-6 h-6 mr-2"),f(r,"class","overflow-hidden text-ellipsis"),f(e,"class",`${Mn} bg-green-600 text-green-100`),f(e,"style",u=`opacity: 0; animation: fade-out-toggle${i[2]} 2.5s;`)},m(l,d){F(l,e,d),E(e,t),j(n,t,null),E(e,o),E(e,r),E(r,s),a=!0},p(l,d){(!a||d&4&&u!==(u=`opacity: 0; animation: fade-out-toggle${l[2]} 2.5s;`))&&f(e,"style",u)},i(l){a||(P(n.$$.fragment,l),a=!0)},o(l){V(n.$$.fragment,l),a=!1},d(l){l&&I(e),q(n)}}}function md(i){let e,t,n,o,r,s=i[0],u=[];for(let d=0;d<s.length;d+=1)u[d]=ao(lo(i,s,d));const a=d=>V(u[d],1,1,()=>{u[d]=null});let l=!i[1]&&i[0].length===0&&co(i);return{c(){e=C("div"),t=C("div");for(let d=0;d<u.length;d+=1)u[d].c();n=H(),l&&l.c(),this.h()},l(d){e=k(d,"DIV",{class:!0});var h=N(e);t=k(h,"DIV",{class:!0});var c=N(t);for(let p=0;p<u.length;p+=1)u[p].l(c);n=K(c),l&&l.l(c),c.forEach(I),h.forEach(I),this.h()},h(){f(t,"class","flex flex-col w-full overflow-x-hidden p-4 space-y-2"),f(e,"class",o=`absolute bottom-0 right-0 w-[39%] max-h-full overflow-x-hidden overflow-y-auto ${i[0].length===0?"pointer-events-none":""}`)},m(d,h){F(d,e,h),E(e,t);for(let c=0;c<u.length;c+=1)u[c].m(t,null);E(t,n),l&&l.m(t,null),r=!0},p(d,[h]){if(h&25){s=d[0];let c;for(c=0;c<s.length;c+=1){const p=lo(d,s,c);u[c]?(u[c].p(p,h),P(u[c],1)):(u[c]=ao(p),u[c].c(),P(u[c],1),u[c].m(t,n))}for(ye(),c=s.length;c<u.length;c+=1)a(c);ve()}!d[1]&&d[0].length===0?l?(l.p(d,h),h&3&&P(l,1)):(l=co(d),l.c(),P(l,1),l.m(t,null)):l&&(ye(),V(l,1,1,()=>{l=null}),ve()),(!r||h&1&&o!==(o=`absolute bottom-0 right-0 w-[39%] max-h-full overflow-x-hidden overflow-y-auto ${d[0].length===0?"pointer-events-none":""}`))&&f(e,"class",o)},i(d){if(!r){for(let h=0;h<s.length;h+=1)P(u[h]);P(l),r=!0}},o(d){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)V(u[h]);V(l),r=!1},d(d){d&&I(e),Ue(u,d),l&&l.d()}}}const Mn="w-full flex flex-row items-center p-2 rounded-md drop-shadow-md";function yd(i,e,t){let{errors:n=void 0}=e,{graphIsEmpty:o=void 0}=e;const r={error:"bg-rose-700 text-rose-100",warning:"bg-yellow-500"},s={error:"",warning:"color: #522A07"};let u=0;return i.$$set=a=>{"errors"in a&&t(0,n=a.errors),"graphIsEmpty"in a&&t(1,o=a.graphIsEmpty)},i.$$.update=()=>{i.$$.dirty&5&&n.length===0&&t(2,u^=1)},[n,o,u,r,s]}class vd extends J{constructor(e){super(),ee(this,e,yd,md,te,{errors:0,graphIsEmpty:1})}}function xd(i){let e,t;return{c(){e=ue("svg"),t=ue("path"),this.h()},l(n){e=le(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=N(e);t=le(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),N(t).forEach(I),o.forEach(I),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"d","M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke-width","1.5"),f(e,"stroke","currentColor")},m(n,o){F(n,e,o),E(e,t)},p:D,i:D,o:D,d(n){n&&I(e)}}}class wd extends J{constructor(e){super(),ee(this,e,null,xd,te,{})}}function _d(i){let e,t,n,o,r,s,u,a,l,d,h,c,p,g;function y(v){i[9](v)}let w={focusable:!0,onResize:i[8]};return i[4]!==void 0&&(w.canvas=i[4]),e=new Nn({props:w}),Oe.push(()=>_t(e,"canvas",y)),o=new vd({props:{errors:i[1],graphIsEmpty:i[2]}}),a=new wd({}),{c(){G(e.$$.fragment),n=H(),G(o.$$.fragment),r=H(),s=C("button"),u=C("div"),G(a.$$.fragment),l=H(),d=C("div"),h=pe("Back"),this.h()},l(v){X(e.$$.fragment,v),n=K(v),X(o.$$.fragment,v),r=K(v),s=k(v,"BUTTON",{class:!0});var x=N(s);u=k(x,"DIV",{class:!0});var m=N(u);X(a.$$.fragment,m),m.forEach(I),l=K(x),d=k(x,"DIV",{});var _=N(d);h=fe(_,"Back"),_.forEach(I),x.forEach(I),this.h()},h(){f(u,"class","w-6 h-6 mr-2"),f(s,"class","flex flex-row items-center justify-center absolute top-[16px] left-[16px] bg-neutral-300 hover:bg-neutral-400 transition-all text-neutral-900 font-bold px-4 py-2 rounded-full")},m(v,x){j(e,v,x),F(v,n,x),j(o,v,x),F(v,r,x),F(v,s,x),E(s,u),j(a,u,null),E(s,l),E(s,d),E(d,h),c=!0,p||(g=B(s,"click",function(){me(i[3])&&i[3].apply(this,arguments)}),p=!0)},p(v,[x]){i=v;const m={};x&1&&(m.onResize=i[8]),!t&&x&16&&(t=!0,m.canvas=i[4],It(()=>t=!1)),e.$set(m);const _={};x&2&&(_.errors=i[1]),x&4&&(_.graphIsEmpty=i[2]),o.$set(_)},i(v){c||(P(e.$$.fragment,v),P(o.$$.fragment,v),P(a.$$.fragment,v),c=!0)},o(v){V(e.$$.fragment,v),V(o.$$.fragment,v),V(a.$$.fragment,v),c=!1},d(v){q(e,v),v&&I(n),q(o,v),v&&I(r),v&&I(s),q(a),p=!1,g()}}}function Id(i,e,t){let{context:n=void 0}=e,{script:o=void 0}=e,{errorsList:r=void 0}=e,{graphIsEmpty:s=!1}=e,{onBackClicked:u=void 0}=e,{states:a=void 0}=e,l,d,h;qe(()=>{l=new Ln(d);let g=new ya,y=new sd(g,l);t(7,h=new od(g,y,void 0,a)),l.pushLayer(y),l.pushLayer(h),l.pushLayer(g),n.windows.push(l)}),Qn(()=>{n.removeWindow(l)});const c=()=>n.propagateResizeEvent();function p(g){d=g,t(4,d)}return i.$$set=g=>{"context"in g&&t(0,n=g.context),"script"in g&&t(5,o=g.script),"errorsList"in g&&t(1,r=g.errorsList),"graphIsEmpty"in g&&t(2,s=g.graphIsEmpty),"onBackClicked"in g&&t(3,u=g.onBackClicked),"states"in g&&t(6,a=g.states)},i.$$.update=()=>{i.$$.dirty&160&&h&&(h.setScript(o),h.graphvis.arrange())},[n,r,s,u,d,o,a,h,c,p]}class bd extends J{constructor(e){super(),ee(this,e,Id,_d,te,{context:0,script:5,errorsList:1,graphIsEmpty:2,onBackClicked:3,states:6})}}class Ed{constructor(){this.static=new Map,this.dynamic=new Map}draw(e,t){this.static.forEach(n=>e.draw(n,t)),this.dynamic.forEach(n=>{n.states&&n.runScripts("OnRender"),e.draw(n,t)})}update(e){this.dynamic.forEach(t=>t.move(e))}}class nr{constructor(e,t,n,o,r,{near:s=.01,far:u=1e3}={}){this.left=t,this.right=n,this.bottom=o,this.top=r,this.near=s,this.far=u,this.pos=e,this.init()}init(e=1){let t=bt();ks(t,this.left/e,this.right/e,this.bottom/e,this.top/e,this.near,this.far);let n=bt();Ns(n,n,this.pos),this.matrix=bt(),zo(this.matrix,t,n)}inverse(){let e=bt();return bs(e,this.matrix),e}setPosition(e){this.pos=[-e.x,-e.y,0],this.init()}setZoom(e){this.init(e)}}class Nd extends Qt{constructor(){super("Scene"),this.layers=[],this.controlledComponents=new Map,this.camera=new nr([0,0,0],-O.canvas.targetWidth/2,O.canvas.targetWidth/2,-O.canvas.targetHeight/2,O.canvas.targetHeight/2)}addComponent(){this.logError("Use addStaticComponent() and addDynamicComponent() instead")}addBase(e,t,n){if(n==null){this.logError(`Must provide z-index for adding component ${t.getLogName()} to scene ${this.getLogName()}`);return}this.layers[n]||(this.layers[n]=new Ed),this.layers[n][e].set(t.id,t)}addStaticEntity(e,t){e.bindToScene(this,t),this.addBase("static",e,t)}addDynamicEntity(e,t){e.bindToScene(this,t),this.addBase("dynamic",e,t)}addControlledEntity(e,t){e.bindToScene(this,t),this.addDynamicEntity(e,t),this.controlledComponents.set(e.id,e)}removeComponent(){this.logError("Use removeStaticComponent() and removeDynamicComponent() instead")}removeBase(e,t){for(var n=0;n<this.layers.length;n++)if(this.layers[n][e].has(t.id)){this.layers[n][e].delete(t.id);return}this.logError(`Attempted to remove non-existent component ${t.logMessageName()}`)}removeStaticEntity(e){this.removeBase("static",e)}removeDynamicEntity(e){this.removeBase("dynamic",e)}removeControlledEntity(e){e.states&&(this.removeDynamicEntity(e),this.controlledComponents.delete(e.id),e.destroy())}}class Sd{constructor(e,t){this.clearColor=t,this.gl=e,this.gl.enable(e.BLEND),this.gl.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.gl.enable(e.DEPTH_TEST),this.gl.depthFunc(e.LEQUAL)}clear(){let e=this.gl;e.clearColor(...this.clearColor),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}draw(e,t,n){if(!t)return;let o=this.gl,r=bt();zo(r,t.matrix,e.renderable.transform),o.useProgram(n.program),n.uniformMatrix4fv(o,"u_mvp",r),e.renderable.draw(o,n,e.getCurrentTexture())}}class Cd{constructor(e,t,n){this.attribs=new Map,this.uniforms=new Map,this.program=this.initProgram(e,t,n)}initProgram(e,t,n){const o=this.createShader(e,e.VERTEX_SHADER,t),r=this.createShader(e,e.FRAGMENT_SHADER,n),s=e.createProgram();e.attachShader(s,o),e.attachShader(s,r),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||console.error(e.getProgramInfoLog(s)),e.deleteShader(o),e.deleteShader(r);const u=e.getProgramParameter(s,e.ACTIVE_ATTRIBUTES);for(let l=0;l<u;++l){const d=e.getActiveAttrib(s,l);this.attribs.set(d.name,e.getAttribLocation(s,d.name))}const a=e.getProgramParameter(s,e.ACTIVE_UNIFORMS);for(let l=0;l<a;++l){const d=e.getActiveUniform(s,l);this.uniforms.set(d.name,e.getUniformLocation(s,d.name))}return s}createShader(e,t,n){const o=e.createShader(t);if(e.shaderSource(o,n),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){console.error(e.getShaderInfoLog(o)),e.deleteShader(o);return}return o}getAttribLocation(e){return this.attribs.get(e)}getUniformLocation(e){return this.uniforms.get(e)}uniform1i(e,t,n){e.uniform1i(this.getUniformLocation(t),n)}uniformMatrix4fv(e,t,n,{transpose:o=!1}={}){e.uniformMatrix4fv(this.getUniformLocation(t),o,n)}}function ir(){let i=new xt(4);return xt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function ho(i,e,t,n){let o=new xt(4);return o[0]=i,o[1]=e,o[2]=t,o[3]=n,o}function Fn(i,e,t){let n=e[0],o=e[1],r=e[2],s=e[3];return i[0]=t[0]*n+t[4]*o+t[8]*r+t[12]*s,i[1]=t[1]*n+t[5]*o+t[9]*r+t[13]*s,i[2]=t[2]*n+t[6]*o+t[10]*r+t[14]*s,i[3]=t[3]*n+t[7]*o+t[11]*r+t[15]*s,i}(function(){let i=ir();return function(e,t,n,o,r,s){let u,a;for(t||(t=4),n||(n=0),o?a=Math.min(o*t+n,e.length):a=e.length,u=n;u<a;u+=t)i[0]=e[u],i[1]=e[u+1],i[2]=e[u+2],i[3]=e[u+3],r(i,i,s),e[u]=i[0],e[u+1]=i[1],e[u+2]=i[2],e[u+3]=i[3];return e}})();const kd=`#version 300 es 
  precision highp float;
  precision highp int;
  
  layout(location = 0) in vec2 i_pos;
  layout(location = 1) in vec2 i_tex;

  uniform mat4 u_mvp;

  out vec2 v_tex;

  void main() {
    gl_Position = u_mvp * vec4(i_pos, -1, 1);
    v_tex = i_tex;
  }
`,Dd=`#version 300 es
  precision highp float;
  precision highp int;
  precision highp sampler2DArray;

  uniform sampler2DArray u_texture;
  uniform int u_frame;

  in vec2 v_tex;

  out vec4 o_color;

  void main() {
    o_color = texture(u_texture, vec3(v_tex, u_frame));
  }
`;class Pd extends tr{constructor(e,t,n){super(e,n),this.shaderProgram=new Cd(this.gl,kd,Dd),this.fpsElement=document.getElementById("fps"),this.fpsSamples=new Array(100).fill(0),this.uiCanvas=new Ln(t,void 0,{doScaling:!1})}setCanvas(e){super.setCanvas(e),!this.gl&&(this.gl=e.getContext("webgl2"),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.renderer=new Sd(this.gl,this.clearColor))}setUICanvas(e){this.uiCanvas=new Ln(e)}clear(){this.renderer.clear(),this.uiCanvas.clear()}propagateResizeEvent(){this.gl.viewport(0,0,this.canvas.width,this.canvas.height),super.propagateResizeEvent()}draw(e,t){this.renderer.draw(e,t,this.shaderProgram)}update(e){super.update(e),this.fpsSamples.shift(),this.fpsSamples.push(1e3/e);let t=this.fpsSamples.reduce((n,o)=>n+=o)/this.fpsSamples.length;this.fpsElement.innerText=`${t.toLocaleString(void 0,{maximumFractionDigits:0,minimumIntegerDigits:3})} fps`}strokeRect(e,t,n,o,r,s,u){let a=e.matrix,l=ho(t,n,-1,1);Fn(l,l,a);const d=(l[0]+1)/2*this.canvas.width,h=(1-l[1])/2*this.canvas.height;let c=ho(o,r,-1,0);Fn(c,c,a);const p=c[0]*this.canvas.width/2,g=c[1]*this.canvas.height/2;this.uiCanvas.strokeRect(d,h,p,g,s,u)}}class Td extends mn{constructor(e,t){super("EditorLayer"),this.game=e,this.textSize=new an(75,100,-1,{step:.5}),this.textTheta=new an(-Math.PI/16,Math.PI/16,-1,{step:.33}),this.showDebug=!0,this.fps=0,this.setSelectedEntity=t,this.camera=new nr([0,0,0],-O.canvas.targetWidth/2,O.canvas.targetWidth/2,-O.canvas.targetHeight/2,O.canvas.targetHeight/2)}onAppTick(e){return O.context.paused||(this.fps=1e3/e.deltaTime),!1}onKeyDown(e){if(!e.repeat)switch(e.key){case"Escape":O.context.paused^=1;break;case"`":this.showDebug^=1;break}}onRender(e){e.window.clear(),this.game.draw(e.window),this.game.currentScene.controlledComponents.forEach(t=>{e.window.strokeRect(this.camera,t.pos.x-t.dim.x/2,t.pos.y+t.dim.y/2,t.dim.x,t.dim.y,"#f0f",5)}),O.context.paused&&(e.window.uiCanvas.drawTransparentRect(0,0,e.window.canvas.width,e.window.canvas.height,"#000",.5),e.window.uiCanvas.drawCenteredText("PAUSED",e.window.canvas.width/2,e.window.canvas.height/2,"courier new",this.textSize.getValue(),"#0f0",{theta:this.textTheta.getValue()}))}onMouseDown(e){const t=2*e.x/this.window.canvas.width-1,n=1-2*e.y/this.window.canvas.height;let o=ir();Fn(o,[t,n,0,1],this.camera.inverse());const r=o[0],s=o[1];let u;this.game.currentScene.controlledComponents.forEach(a=>{u||O.rectIntersect(r,s,a.pos.x-a.dim.x/2,a.pos.y-a.dim.y/2,a.dim.x,a.dim.y)&&(u=a)}),this.setSelectedEntity(u)}}class bn{constructor(e,t,n,o){this.id=Mt(),this.outputNode=e,this.outputIndex=t,this.inputNode=n,this.inputIndex=o}serialize(e){return{outputIndex:this.outputIndex,inputIndex:this.inputIndex,outputNode:e.get(this.outputNode.id),inputNode:e.get(this.inputNode.id)}}}class Vd{constructor(){this.in=[],this.out=[]}serialize(e){let t=this.in.map(o=>o.serialize(e)),n=this.out.map(o=>o.serialize(e));return{in:t,out:n}}}const Dt=new Set;Dt.add("OnTick");Dt.add("OnPostTick");Dt.add("OnCollide");Dt.add("OnSwitch");Dt.add("OnRender");class Ad{constructor(e){this.node=e,this.name=e.internalValues[0],this.value=e.internalValues[1],this.valueType=e.data.internalPorts[1].typename,this.editorType=e.data.internalPorts[1].editorTypename}setName(e){this.name=e,this.node.internalValues[0]=e}setValue(e){this.value=e,this.node.internalValues[1]=e}}class Od extends Qt{constructor(e,t,n,o){super(e),this.inputCache=t,this.pushErrorCallback=n,this.clearErrorsCallback=o,this.collapsed=!1,this.firstRun=!0,this.reset()}isEmpty(){return!this.nodes.size}reset(){this.nodes=new Map,this.eventNodes=new Map,this.sourceNodes=[],this.exportNodes=[],this.edges=new Map,this.cachedCompile=void 0,this.canErr=!0,this.firstRun=!0}serialize(){let e=[],t=new Map;this.nodes.forEach(r=>{t.set(r.id,e.length),e.push(r.serialize())});let n=[];return this.edges.forEach(r=>n.push(r.serialize(t))),{name:this.debugName,nodes:e,edges:n}}deserialize(e){e=JSON.parse(JSON.stringify(e)),this.reset(),this.debugName=e.name;let t=new Map;for(const o of e.nodes){const r=this.createNode(o.type,o.internalValues);this.nodes.set(r.id,r),t.set(t.size,r)}for(var n=0;n<e.edges.length;n++){const o=e.edges[n],r=t.get(n);let s=this.edges.get(r.id);for(const u of o.in)s.in.push(new bn(t.get(u.outputNode),u.outputIndex,t.get(u.inputNode),u.inputIndex));for(const u of o.out)s.out.push(new bn(t.get(u.outputNode),u.outputIndex,t.get(u.inputNode),u.inputIndex));this.edges.set(r.id,s)}this.compile()}pushError(e){this.canErr&&this.pushErrorCallback({level:"error",message:e})}pushWarning(e){this.canErr&&this.pushErrorCallback({level:"warning",message:e})}createNode(e,t){this.cachedCompile=void 0;const n=Rn.get(e).createNode(this,t);return this.nodes.set(n.id,n),this.edges.set(n.id,new Vd),n}removeNode(e){this.cachedCompile=void 0,this.getEdges(e).in.forEach(t=>{this.removeEdge(t.outputNode,t.outputIndex,t.inputNode,t.inputIndex)}),this.getEdges(e).out.forEach(t=>{this.removeEdge(t.outputNode,t.outputIndex,t.inputNode,t.inputIndex)}),this.nodes.delete(e.id),this.edges.delete(e.id)}addEdge(e,t,n,o){this.cachedCompile=void 0;const r=new bn(e,t,n,o);this.edges.get(e.id).out.push(r),this.edges.get(n.id).in.push(r)}removeEdge(e,t,n,o){this.getEdges(e).out=this.getEdges(e).out.filter(r=>!(r.inputNode===n&&r.inputIndex===o&&r.outputNode===e&&r.outputIndex===t)),this.getEdges(n).in=this.getEdges(n).in.filter(r=>!(r.inputNode===n&&r.inputIndex===o&&r.outputNode===e&&r.outputIndex===t))}getEdges(e){return this.edges.get(e.id)}hasEdges(e){if(!this.edges.has(e.id))return!1;const t=this.getEdges(e);return t.in.length||t.out.length}hasInputEdgeAt(e,t){const n=this.getEdges(e).in;for(var o=0;o<n.length;o++)if(n[o].inputIndex===t)return n[o];return!1}hasOutputEdgeAt(e,t){const n=this.getEdges(e).out;for(var o=0;o<n.length;o++)if(n[o].outputIndex===t)return n[o];return!1}forceCompile(){return this.cachedCompile=void 0,this.compile()}compile(){if(this.cachedCompile)return this.cachedCompile;this.clearErrorsCallback(this.isEmpty()),this.canErr=!0,this.eventNodes=new Map,this.sourceNodes=[],this.exportNodes=[];let e=[];this.nodes.forEach(o=>{Dt.has(o.debugName)?(this.eventNodes.set(o.debugName,o),e.push(o)):this.getEdges(o).in.length?o.isSource=!1:(o.isSource=!0,this.sourceNodes.push(o),e.push(o)),o.isExport&&this.exportNodes.push(new Ad(o))});let t=new Map,n=[];return e.forEach(o=>this.traverse(o,t,n)),this.cachedCompile=n,n}traverse(e,t,n){if(t.has(e.id)){t.get(e.id)===1&&this.logError("Cycle detected");return}t.set(e.id,1),this.getEdges(e).out.forEach(r=>this.traverse(r.inputNode,t,n)),t.set(e.id,2),n.unshift(e)}run(e,t){this.compile(),this.firstRun&&(this.firstRun=!1,this.run("OnSwitch",t));let n=this.eventNodes.get(e);!n||(this.nodes.forEach(o=>o.active=!1),n.active=!0,n.outputs=t.data||[],this.sourceNodes.forEach(o=>o.active=!0),this.cachedCompile.forEach(o=>{if(!o.active)return;let r=[];this.getEdges(o).in.forEach(a=>{a.inputIndex!=-1&&(r[a.inputIndex]=a.outputNode.outputs[a.outputIndex])}),o.run(r,{...t,inputCache:this.inputCache})}),this.canErr=!1)}}let qt;class En{constructor(e,t,n,o){qt||(qt=new Zt(n,0,["/MissingTexture.svg"])),this.name=e,this.scripts=t||[],this.textures=o.map(r=>r?new Zt(n,r.frameTime,r.urls):qt),this.gl=n,this.collapsed=!1,this.animationsCollapsed=!1,this.animationsView="grid"}run(e,t,...n){this.scripts.forEach(o=>o.run(e,t,...n))}reset(){this.scripts.forEach(e=>e.firstRun=!0)}setTexture(e,t){this.textures[e]=t?new Zt(this.gl,t.frameTime,t.urls):qt}}function Rd(i){let e,t,n;return t=new ra({props:{states:i[8].states,selectedEntity:i[8],selectedState:i[9],onSelectState:i[27],onRenameState:i[28],onDeleteState:i[29],onEditScript:i[30],onAddState:i[31]}}),{c(){e=C("div"),G(t.$$.fragment),this.h()},l(o){e=k(o,"DIV",{class:!0});var r=N(e);X(t.$$.fragment,r),r.forEach(I),this.h()},h(){f(e,"class","flex flex-col w-full h-full overflow-x-hidden overflow-y-auto")},m(o,r){F(o,e,r),j(t,e,null),n=!0},p(o,r){const s={};r[0]&256&&(s.states=o[8].states),r[0]&256&&(s.selectedEntity=o[8]),r[0]&512&&(s.selectedState=o[9]),r[0]&512&&(s.onSelectState=o[27]),r[0]&256&&(s.onRenameState=o[28]),r[0]&256&&(s.onDeleteState=o[29]),r[0]&1024&&(s.onEditScript=o[30]),r[0]&800&&(s.onAddState=o[31]),t.$set(s)},i(o){n||(P(t.$$.fragment,o),n=!0)},o(o){V(t.$$.fragment,o),n=!1},d(o){o&&I(e),q(t)}}}function Ld(i){let e,t;return e=new bd({props:{context:O.context,script:i[10],errorsList:i[6],graphIsEmpty:i[7],onBackClicked:i[26],states:i[8].states}}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p(n,o){const r={};o[0]&1024&&(r.script=n[10]),o[0]&64&&(r.errorsList=n[6]),o[0]&128&&(r.graphIsEmpty=n[7]),o[0]&1024&&(r.onBackClicked=n[26]),o[0]&256&&(r.states=n[8].states),e.$set(r)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}function Md(i){let e,t,n,o,r,s,u,a,l,d,h,c,p,g,y,w,v,x,m,_,b,S,A,T,L,oe,ie,M,W,Q,re,Y,ae,Ne,z,R,ne,de,U,se;o=new qs({});function ze(Z){i[18](Z)}let Le={minSplit:.1,maxSplit:.9};i[0]!==void 0&&(Le.split=i[0]),u=new yn({props:Le}),Oe.push(()=>_t(u,"split",ze));function ce(Z){i[20](Z)}let Ge={focusable:!0,targetAspectRatio:O.canvas.targetWidth/O.canvas.targetHeight,onResize:i[19]};i[3]!==void 0&&(Ge.canvas=i[3]),c=new Nn({props:Ge}),Oe.push(()=>_t(c,"canvas",ce));function ot(Z){i[22](Z)}let pt={targetAspectRatio:O.canvas.targetWidth/O.canvas.targetHeight,onResize:i[21]};i[4]!==void 0&&(pt.canvas=i[4]),w=new Nn({props:pt}),Oe.push(()=>_t(w,"canvas",ot));function He(Z){i[23](Z)}let Yt={isVertical:!0,minSplit:.1,maxSplit:.9};i[1]!==void 0&&(Yt.split=i[1]),T=new yn({props:Yt}),Oe.push(()=>_t(T,"split",He)),W=new wu({props:{onUseScript:i[24]}});function or(Z){i[25](Z)}let oi={minSplit:.1,maxSplit:.9};i[2]!==void 0&&(oi.split=i[2]),Y=new yn({props:oi}),Oe.push(()=>_t(Y,"split",or));const ri=[Ld,Rd],rt=[];function si(Z,ge){return Z[10]?0:Z[8]?1:-1}return~(R=si(i))&&(ne=rt[R]=ri[R](i)),{c(){e=C("div"),t=C("div"),n=C("div"),G(o.$$.fragment),s=H(),G(u.$$.fragment),l=H(),d=C("div"),h=C("div"),G(c.$$.fragment),g=H(),y=C("div"),G(w.$$.fragment),x=H(),m=C("div"),_=C("p"),A=H(),G(T.$$.fragment),oe=H(),ie=C("div"),M=C("div"),G(W.$$.fragment),re=H(),G(Y.$$.fragment),Ne=H(),z=C("div"),ne&&ne.c(),this.h()},l(Z){e=k(Z,"DIV",{class:!0});var ge=N(e);t=k(ge,"DIV",{class:!0,style:!0});var tt=N(t);n=k(tt,"DIV",{class:!0,style:!0});var Pt=N(n);X(o.$$.fragment,Pt),Pt.forEach(I),s=K(tt),X(u.$$.fragment,tt),l=K(tt),d=k(tt,"DIV",{class:!0,style:!0});var nt=N(d);h=k(nt,"DIV",{class:!0});var Tt=N(h);X(c.$$.fragment,Tt),Tt.forEach(I),g=K(nt),y=k(nt,"DIV",{class:!0});var Vt=N(y);X(w.$$.fragment,Vt),Vt.forEach(I),x=K(nt),m=k(nt,"DIV",{class:!0});var At=N(m);_=k(At,"P",{id:!0}),N(_).forEach(I),At.forEach(I),nt.forEach(I),tt.forEach(I),A=K(ge),X(T.$$.fragment,ge),oe=K(ge),ie=k(ge,"DIV",{class:!0,style:!0});var Ke=N(ie);M=k(Ke,"DIV",{class:!0,style:!0});var ui=N(M);X(W.$$.fragment,ui),ui.forEach(I),re=K(Ke),X(Y.$$.fragment,Ke),Ne=K(Ke),z=k(Ke,"DIV",{class:!0,style:!0});var li=N(z);ne&&ne.l(li),li.forEach(I),Ke.forEach(I),ge.forEach(I),this.h()},h(){f(n,"class","grow shrink overflow-auto bg-neutral-900"),f(n,"style",r=`flex-basis: ${i[11]}%;`),f(h,"class","absolute t-0 l-0 w-full h-full p-2"),f(y,"class","absolute t-0 l-0 w-full h-full pointer-events-none p-2"),f(_,"id","fps"),f(m,"class","absolute t-0 l-0 w-full h-full pointer-events-none p-2"),f(d,"class","relative grow shrink overflow-hidden bg-neutral-900"),f(d,"style",b=`flex-basis: ${i[12]}%;`),f(t,"class","grow shrink basis-0 overflow-hidden flex flex-row"),f(t,"style",S=`flex-basis: ${i[13]}%;`),f(M,"class","grow shrink overflow-auto bg-neutral-900"),f(M,"style",Q=`flex-basis: ${i[15]}%;`),f(z,"class","relative grow shrink overflow-hidden bg-neutral-900"),f(z,"style",de=`flex-basis: ${i[16]}%;`),f(ie,"class","grow shrink overflow-hidden flex flex-row"),f(ie,"style",U=`flex-basis: ${i[14]}%;`),f(e,"class","w-full h-full flex flex-col bg-neutral-800 text-neutral-300 overflow-hidden")},m(Z,ge){F(Z,e,ge),E(e,t),E(t,n),j(o,n,null),E(t,s),j(u,t,null),E(t,l),E(t,d),E(d,h),j(c,h,null),E(d,g),E(d,y),j(w,y,null),E(d,x),E(d,m),E(m,_),E(e,A),j(T,e,null),E(e,oe),E(e,ie),E(ie,M),j(W,M,null),E(ie,re),j(Y,ie,null),E(ie,Ne),E(ie,z),~R&&rt[R].m(z,null),se=!0},p(Z,ge){(!se||ge[0]&2048&&r!==(r=`flex-basis: ${Z[11]}%;`))&&f(n,"style",r);const tt={};!a&&ge[0]&1&&(a=!0,tt.split=Z[0],It(()=>a=!1)),u.$set(tt);const Pt={};!p&&ge[0]&8&&(p=!0,Pt.canvas=Z[3],It(()=>p=!1)),c.$set(Pt);const nt={};!v&&ge[0]&16&&(v=!0,nt.canvas=Z[4],It(()=>v=!1)),w.$set(nt),(!se||ge[0]&4096&&b!==(b=`flex-basis: ${Z[12]}%;`))&&f(d,"style",b),(!se||ge[0]&8192&&S!==(S=`flex-basis: ${Z[13]}%;`))&&f(t,"style",S);const Tt={};!L&&ge[0]&2&&(L=!0,Tt.split=Z[1],It(()=>L=!1)),T.$set(Tt);const Vt={};ge[0]&768&&(Vt.onUseScript=Z[24]),W.$set(Vt),(!se||ge[0]&32768&&Q!==(Q=`flex-basis: ${Z[15]}%;`))&&f(M,"style",Q);const At={};!ae&&ge[0]&4&&(ae=!0,At.split=Z[2],It(()=>ae=!1)),Y.$set(At);let Ke=R;R=si(Z),R===Ke?~R&&rt[R].p(Z,ge):(ne&&(ye(),V(rt[Ke],1,1,()=>{rt[Ke]=null}),ve()),~R?(ne=rt[R],ne?ne.p(Z,ge):(ne=rt[R]=ri[R](Z),ne.c()),P(ne,1),ne.m(z,null)):ne=null),(!se||ge[0]&65536&&de!==(de=`flex-basis: ${Z[16]}%;`))&&f(z,"style",de),(!se||ge[0]&16384&&U!==(U=`flex-basis: ${Z[14]}%;`))&&f(ie,"style",U)},i(Z){se||(P(o.$$.fragment,Z),P(u.$$.fragment,Z),P(c.$$.fragment,Z),P(w.$$.fragment,Z),P(T.$$.fragment,Z),P(W.$$.fragment,Z),P(Y.$$.fragment,Z),P(ne),se=!0)},o(Z){V(o.$$.fragment,Z),V(u.$$.fragment,Z),V(c.$$.fragment,Z),V(w.$$.fragment,Z),V(T.$$.fragment,Z),V(W.$$.fragment,Z),V(Y.$$.fragment,Z),V(ne),se=!1},d(Z){Z&&I(e),q(o),q(u),q(c),q(w),q(T),q(W),q(Y),~R&&rt[R].d()}}}function Fd(i,e,t){let n,o,r,s=[],u=!0,a,l,d,h;qe(()=>{O.init();var R=O.context.game;t(5,r=new Pd(n,o,[0,0,1,1]));var ne=new Nd;R.setCurrentScene(ne);const de=10;let U=[],se=[],ze=0;for(var Le=0;Le<50;Le+=de)for(var ce=0;ce<500;ce+=de){const Ge=ce/10,ot=Le/10,pt=1;U.push(Ge,ot,0,0,Ge+pt,ot,1,0,Ge+pt,ot+pt,1,1,Ge,ot+pt,0,1);const He=ze*4;se.push(He,He+1,He+2,He,He+2,He+3),ze++}R.addStaticSceneEntity(0,r,new he(-700,-300),0,["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"],{vertices:U,indices:se,scale:25}),R.addStaticSceneEntity(0,r,new he(-700,-150),0,["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"],{vertices:U,indices:se,scale:1}),R.addStaticSceneEntity(0,r,new he(-500,-150),0,["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"],{vertices:U,indices:se,scale:1}),R.addControlledSceneEntity(1,r,new he(0,0),new Map([["Default",new En("Default",[],r.gl,[null,null,null,null,{frameTime:500,urls:["https://art.pixilart.com/840bcbc293e372f.png","https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNYrGPqKAnwSbc1AwWvieLvCe5gy2LASXWOg&usqp=CAU"]},null,null,null,null])]]),"Default",{scale:25}),R.addControlledSceneEntity(1,r,new he(-600,0),new Map([["Default",new En("Default",[],r.gl,[null,null,null,null,{frameTime:0,urls:["https://art.pixilart.com/840bcbc293e372f.png"]},null,null,null,null])]]),"Default",{scale:25}),a=new Td(R,Ge=>{t(8,l=Ge),l?t(9,d=l.currentState):(t(10,h=void 0),t(9,d=void 0))}),r.pushLayer(a),O.context.windows.push(r),O.context.run()});let c=1/2,p=1/2,g=1/2,y=null,w=null,v=null,x=null,m=null,_=null;function b(R){return new Od(R,r.inputCache,ne=>{t(6,s=[...s,ne]),t(7,u=!1)},ne=>{t(6,s=[]),t(7,u=ne)})}function S(R){c=R,t(0,c)}const A=()=>O.context.propagateResizeEvent();function T(R){n=R,t(3,n)}const L=()=>O.context.propagateResizeEvent();function oe(R){o=R,t(4,o)}function ie(R){p=R,t(1,p)}const M=R=>{let ne=b("default");ne.deserialize(R.script),t(9,d.scripts=[...d.scripts,ne],d),t(8,l)};function W(R){g=R,t(2,g)}const Q=()=>t(10,h=void 0),re=(R,ne)=>{t(9,d=ne)},Y=(R,ne)=>{let de=window.prompt("Enter new state name:");!de||(de=de.trim(),l.states.delete(R),l.states.set(de,ne),l.setState(de),t(8,l))},ae=(R,ne)=>{l.states.delete(R),t(8,l)},Ne=R=>t(10,h=R),z=()=>{let R=window.prompt("Enter new state name:");if(!R||(R=R.trim(),l.states.has(R)&&!window.confirm(`State '${R}' exists. Overwrite?`)))return;const ne=new En(R,[],r.gl,[null,null,null,null,null,null,null,null,null]);l.states.set(R,ne),t(9,d=ne),t(8,l)};return i.$$.update=()=>{i.$$.dirty[0]&7&&(t(11,y=c*100),t(12,w=(1-c)*100),t(13,v=p*100),t(14,x=(1-p)*100),t(15,m=g*100),t(16,_=(1-g)*100))},[c,p,g,n,o,r,s,u,l,d,h,y,w,v,x,m,_,b,S,A,T,L,oe,ie,M,W,Q,re,Y,ae,Ne,z]}class Bd extends J{constructor(e){super(),ee(this,e,Fd,Md,te,{},null,[-1,-1])}}function zd(i){let e,t;return e=new Bd({}),{c(){G(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,o){j(e,n,o),t=!0},p:D,i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){q(e,n)}}}class Gd extends J{constructor(e){super(),ee(this,e,null,zd,te,{})}}export{Gd as default};
